<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Trent Nelson">
<meta name="dcterms.date" content="2025-02-13">
<meta name="description" content="This post examines multi-threaded parallel inference on PyTorch models using the new No-GIL, free-threaded version of Python. Using a simple 124M parameter GPT2 model that we train from scratch, we explore the novel new territory unlocked by free-threaded Python: parallel PyTorch model inference, where multiple threads, unimpeded by the Python GIL, attempt to generate text from a transformer-based model in parallel.">

<title>PyTorch and Python Free-Threading – Trent Nelson</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-fad9f07c6447c7e618f17e3bec6a2d81.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-fad9f07c6447c7e618f17e3bec6a2d81.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6bd36816c32a8a925c16132d3e80094d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-b22f0d1866f817409884001a66935b87.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": true,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-8RPR4XKPEW"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-8RPR4XKPEW', { 'anonymize_ip': false});
</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="PyTorch and Python Free-Threading – Trent Nelson">
<meta property="og:description" content="This post examines multi-threaded parallel inference on PyTorch models using the new No-GIL, free-threaded version of Python. Using a simple 124M parameter GPT2 model that we train from scratch, we explore the novel new territory unlocked by free-threaded Python: parallel PyTorch model inference, where multiple threads, unimpeded by the Python GIL, attempt to generate text from a transformer-based model in parallel.">
<meta property="og:image" content="https://trent.me/articles/pytorch-and-python-free-threading/images/pytorch-and-python-free-threading.png">
<meta property="og:site_name" content="Trent Nelson">
<meta property="og:image:height" content="1024">
<meta property="og:image:width" content="1024">
<meta name="twitter:title" content="PyTorch and Python Free-Threading – Trent Nelson">
<meta name="twitter:description" content="This post examines multi-threaded parallel inference on PyTorch models using the new No-GIL, free-threaded version of Python. Using a simple 124M parameter GPT2 model that we train from scratch, we explore the novel new territory unlocked by free-threaded Python: parallel PyTorch model inference, where multiple threads, unimpeded by the Python GIL, attempt to generate text from a transformer-based model in parallel.">
<meta name="twitter:image" content="https://trent.me/articles/pytorch-and-python-free-threading/images/pytorch-and-python-free-threading.png">
<meta name="twitter:image-height" content="1024">
<meta name="twitter:image-width" content="1024">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Trent Nelson</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../articles/index.html"> 
<span class="menu-text">Articles</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects/index.html"> 
<span class="menu-text">Projects &amp; Repos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tools/index.html"> 
<span class="menu-text">Tools</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://twitter.com/trentnelson" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/tpn" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/trent-p-nelson" title="LinkedIn" class="quarto-navigation-tool px-1" aria-label="LinkedIn"><i class="bi bi-linkedin"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a></li>
  <li><a href="#pytorch-and-llm-crash-course" id="toc-pytorch-and-llm-crash-course" class="nav-link" data-scroll-target="#pytorch-and-llm-crash-course">PyTorch and LLM Crash Course</a>
  <ul>
  <li><a href="#training-gpt-2-124m-locally" id="toc-training-gpt-2-124m-locally" class="nav-link" data-scroll-target="#training-gpt-2-124m-locally">Training GPT-2 (124M) Locally</a></li>
  </ul></li>
  <li><a href="#pytorch-gpt-2-implementation" id="toc-pytorch-gpt-2-implementation" class="nav-link" data-scroll-target="#pytorch-gpt-2-implementation">PyTorch GPT-2 Implementation</a>
  <ul>
  <li><a href="#initial-implementation" id="toc-initial-implementation" class="nav-link" data-scroll-target="#initial-implementation">Initial Implementation</a></li>
  <li><a href="#loading-the-model" id="toc-loading-the-model" class="nav-link" data-scroll-target="#loading-the-model">Loading the Model</a></li>
  <li><a href="#generating-text" id="toc-generating-text" class="nav-link" data-scroll-target="#generating-text">Generating Text</a></li>
  </ul></li>
  <li><a href="#parallel-pytorch-inference" id="toc-parallel-pytorch-inference" class="nav-link" data-scroll-target="#parallel-pytorch-inference">Parallel PyTorch Inference</a>
  <ul>
  <li><a href="#pure-python-multi-threaded-http-server" id="toc-pure-python-multi-threaded-http-server" class="nav-link" data-scroll-target="#pure-python-multi-threaded-http-server">Pure Python Multi-threaded HTTP Server</a></li>
  <li><a href="#gpt2-http-app" id="toc-gpt2-http-app" class="nav-link" data-scroll-target="#gpt2-http-app">GPT2 HTTP App</a>
  <ul>
  <li><a href="#synchronous-up-front-generation" id="toc-synchronous-up-front-generation" class="nav-link" data-scroll-target="#synchronous-up-front-generation">Synchronous Up-Front Generation</a></li>
  <li><a href="#our-goals" id="toc-our-goals" class="nav-link" data-scroll-target="#our-goals">Our Goals</a></li>
  <li><a href="#asynchronous-token-by-token-generation" id="toc-asynchronous-token-by-token-generation" class="nav-link" data-scroll-target="#asynchronous-token-by-token-generation">Asynchronous Token-by-Token Generation</a>
  <ul class="collapse">
  <li><a href="#step-1-have-generate-enqueue-an-async-generate_response." id="toc-step-1-have-generate-enqueue-an-async-generate_response." class="nav-link" data-scroll-target="#step-1-have-generate-enqueue-an-async-generate_response.">Step 1: Have generate() enqueue an async generate_response().</a></li>
  <li><a href="#step-2-implement-an-async-generate_response" id="toc-step-2-implement-an-async-generate_response" class="nav-link" data-scroll-target="#step-2-implement-an-async-generate_response">Step 2: Implement an async generate_response()</a></li>
  <li><a href="#step-3-implement-an-async-gpt.async_generate_for" id="toc-step-3-implement-an-async-gpt.async_generate_for" class="nav-link" data-scroll-target="#step-3-implement-an-async-gpt.async_generate_for">Step 3: Implement an async GPT.async_generate_for()</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#test-drive" id="toc-test-drive" class="nav-link" data-scroll-target="#test-drive">Test Drive!</a>
  <ul>
  <li><a href="#launching-the-http-server" id="toc-launching-the-http-server" class="nav-link" data-scroll-target="#launching-the-http-server">Launching the HTTP Server</a></li>
  <li><a href="#visualizing-chunked-encoding" id="toc-visualizing-chunked-encoding" class="nav-link" data-scroll-target="#visualizing-chunked-encoding">Visualizing Chunked-Encoding</a></li>
  <li><a href="#verifying-via-curl" id="toc-verifying-via-curl" class="nav-link" data-scroll-target="#verifying-via-curl">Verifying via Curl</a></li>
  <li><a href="#launching-the-react-bootstrap-ui" id="toc-launching-the-react-bootstrap-ui" class="nav-link" data-scroll-target="#launching-the-react-bootstrap-ui">Launching the React Bootstrap UI</a></li>
  </ul></li>
  <li><a href="#parallel-generation" id="toc-parallel-generation" class="nav-link" data-scroll-target="#parallel-generation">Parallel Generation</a>
  <ul>
  <li><a href="#netcat-example" id="toc-netcat-example" class="nav-link" data-scroll-target="#netcat-example">Netcat Example</a></li>
  <li><a href="#curl-example" id="toc-curl-example" class="nav-link" data-scroll-target="#curl-example">Curl Example</a></li>
  </ul></li>
  <li><a href="#lets-load-test-this-sucker" id="toc-lets-load-test-this-sucker" class="nav-link" data-scroll-target="#lets-load-test-this-sucker">Let’s Load Test This Sucker!</a>
  <ul>
  <li><a href="#parallel-load-testing-no-gil" id="toc-parallel-load-testing-no-gil" class="nav-link" data-scroll-target="#parallel-load-testing-no-gil">Parallel Load Testing (No GIL)</a></li>
  <li><a href="#ablation-test-re-enable-the-gil" id="toc-ablation-test-re-enable-the-gil" class="nav-link" data-scroll-target="#ablation-test-re-enable-the-gil">Ablation Test: Re-enable the GIL</a></li>
  <li><a href="#parallel-load-testing-no-gil-vs-gil" id="toc-parallel-load-testing-no-gil-vs-gil" class="nav-link" data-scroll-target="#parallel-load-testing-no-gil-vs-gil">Parallel Load Testing: No GIL vs GIL</a></li>
  <li><a href="#parallel-load-testing-how-does-plaintext-fare" id="toc-parallel-load-testing-how-does-plaintext-fare" class="nav-link" data-scroll-target="#parallel-load-testing-how-does-plaintext-fare">Parallel Load Testing: How does Plaintext Fare?</a></li>
  <li><a href="#parallel-load-test-summary" id="toc-parallel-load-test-summary" class="nav-link" data-scroll-target="#parallel-load-test-summary">Parallel Load Test Summary</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#finishing-up" id="toc-finishing-up" class="nav-link" data-scroll-target="#finishing-up">Finishing Up</a>
  <ul>
  <li><a href="#reviewing-initial-implementation" id="toc-reviewing-initial-implementation" class="nav-link" data-scroll-target="#reviewing-initial-implementation">Reviewing Initial Implementation</a>
  <ul>
  <li><a href="#skipping-weight-initialization" id="toc-skipping-weight-initialization" class="nav-link" data-scroll-target="#skipping-weight-initialization">Skipping Weight Initialization</a></li>
  <li><a href="#can-we-load-other-checkpoints" id="toc-can-we-load-other-checkpoints" class="nav-link" data-scroll-target="#can-we-load-other-checkpoints">Can We Load Other Checkpoints?</a></li>
  <li><a href="#multi-gpu-support" id="toc-multi-gpu-support" class="nav-link" data-scroll-target="#multi-gpu-support">Multi-GPU Support</a></li>
  </ul></li>
  <li><a href="#model-optimization" id="toc-model-optimization" class="nav-link" data-scroll-target="#model-optimization">Model Optimization</a>
  <ul>
  <li><a href="#torchscript" id="toc-torchscript" class="nav-link" data-scroll-target="#torchscript">TorchScript</a></li>
  <li><a href="#torch-dynamo-torch.compile" id="toc-torch-dynamo-torch.compile" class="nav-link" data-scroll-target="#torch-dynamo-torch.compile">Torch Dynamo (torch.compile)</a>
  <ul class="collapse">
  <li><a href="#performance-comparison" id="toc-performance-comparison" class="nav-link" data-scroll-target="#performance-comparison">Performance Comparison</a></li>
  <li><a href="#free-threaded-python-py313t" id="toc-free-threaded-python-py313t" class="nav-link" data-scroll-target="#free-threaded-python-py313t">Free-Threaded Python (py313t)</a></li>
  <li><a href="#normal-python-py313" id="toc-normal-python-py313" class="nav-link" data-scroll-target="#normal-python-py313">Normal Python (py313)</a></li>
  <li><a href="#explicit-torch.compile-decorator" id="toc-explicit-torch.compile-decorator" class="nav-link" data-scroll-target="#explicit-torch.compile-decorator">Explicit <span class="citation" data-cites="torch.compile">@torch.compile</span> Decorator</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/tpn/website/edit/main/articles/pytorch-and-python-free-threading/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/tpn/website/issues/new/choose" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="torch-compile-analysis-preview.html"><i class="bi bi-journal-code"></i>Data Visualization: torch.compile</a></li><li><a href="wrk-analysis-preview.html"><i class="bi bi-journal-code"></i>Data Visualization: wrk</a></li><li><a href="gpt2-v1-preview.html"><i class="bi bi-journal-code"></i>GPT2 v1</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PyTorch and Python Free-Threading</h1>
<p class="subtitle lead"></p><p>Unlocking multi-threaded parallel inference on PyTorch models</p><p></p>
  <div class="quarto-categories">
    <div class="quarto-category">PyTorch</div>
    <div class="quarto-category">Python</div>
    <div class="quarto-category">Free-Threading</div>
    <div class="quarto-category">No-GIL</div>
    <div class="quarto-category">LLM</div>
    <div class="quarto-category">GPT2</div>
  </div>
  </div>

<div>
  <div class="description">
    <p>This post examines multi-threaded parallel inference on PyTorch models using the new <em>No-GIL</em>, free-threaded version of Python. Using a simple 124M parameter GPT2 model that we train from scratch, we explore the novel new territory unlocked by free-threaded Python: parallel PyTorch model inference, where multiple threads, unimpeded by the Python GIL, attempt to generate text from a transformer-based model in parallel.</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Trent Nelson </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 13, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>

<nav id="TOC-body" role="doc-toc">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction">Introduction</a></li>
  <li><a href="#getting-started" id="toc-getting-started">Getting Started</a></li>
  <li><a href="#pytorch-and-llm-crash-course" id="toc-pytorch-and-llm-crash-course">PyTorch and LLM Crash Course</a>
  <ul>
  <li><a href="#training-gpt-2-124m-locally" id="toc-training-gpt-2-124m-locally">Training GPT-2 (124M) Locally</a></li>
  </ul></li>
  <li><a href="#pytorch-gpt-2-implementation" id="toc-pytorch-gpt-2-implementation">PyTorch GPT-2 Implementation</a>
  <ul>
  <li><a href="#initial-implementation" id="toc-initial-implementation">Initial Implementation</a></li>
  <li><a href="#loading-the-model" id="toc-loading-the-model">Loading the Model</a></li>
  <li><a href="#generating-text" id="toc-generating-text">Generating Text</a></li>
  </ul></li>
  <li><a href="#parallel-pytorch-inference" id="toc-parallel-pytorch-inference">Parallel PyTorch Inference</a>
  <ul>
  <li><a href="#pure-python-multi-threaded-http-server" id="toc-pure-python-multi-threaded-http-server">Pure Python Multi-threaded HTTP Server</a></li>
  <li><a href="#gpt2-http-app" id="toc-gpt2-http-app">GPT2 HTTP App</a>
  <ul>
  <li><a href="#synchronous-up-front-generation" id="toc-synchronous-up-front-generation">Synchronous Up-Front Generation</a></li>
  <li><a href="#our-goals" id="toc-our-goals">Our Goals</a></li>
  <li><a href="#asynchronous-token-by-token-generation" id="toc-asynchronous-token-by-token-generation">Asynchronous Token-by-Token Generation</a>
  <ul>
  <li><a href="#step-1-have-generate-enqueue-an-async-generate_response." id="toc-step-1-have-generate-enqueue-an-async-generate_response.">Step 1: Have generate() enqueue an async generate_response().</a></li>
  <li><a href="#step-2-implement-an-async-generate_response" id="toc-step-2-implement-an-async-generate_response">Step 2: Implement an async generate_response()</a></li>
  <li><a href="#step-3-implement-an-async-gpt.async_generate_for" id="toc-step-3-implement-an-async-gpt.async_generate_for">Step 3: Implement an async GPT.async_generate_for()</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#test-drive" id="toc-test-drive">Test Drive!</a>
  <ul>
  <li><a href="#launching-the-http-server" id="toc-launching-the-http-server">Launching the HTTP Server</a></li>
  <li><a href="#visualizing-chunked-encoding" id="toc-visualizing-chunked-encoding">Visualizing Chunked-Encoding</a></li>
  <li><a href="#verifying-via-curl" id="toc-verifying-via-curl">Verifying via Curl</a></li>
  <li><a href="#launching-the-react-bootstrap-ui" id="toc-launching-the-react-bootstrap-ui">Launching the React Bootstrap UI</a></li>
  </ul></li>
  <li><a href="#parallel-generation" id="toc-parallel-generation">Parallel Generation</a>
  <ul>
  <li><a href="#netcat-example" id="toc-netcat-example">Netcat Example</a></li>
  <li><a href="#curl-example" id="toc-curl-example">Curl Example</a></li>
  </ul></li>
  <li><a href="#lets-load-test-this-sucker" id="toc-lets-load-test-this-sucker">Let’s Load Test This Sucker!</a>
  <ul>
  <li><a href="#parallel-load-testing-no-gil" id="toc-parallel-load-testing-no-gil">Parallel Load Testing (No GIL)</a></li>
  <li><a href="#ablation-test-re-enable-the-gil" id="toc-ablation-test-re-enable-the-gil">Ablation Test: Re-enable the GIL</a></li>
  <li><a href="#parallel-load-testing-no-gil-vs-gil" id="toc-parallel-load-testing-no-gil-vs-gil">Parallel Load Testing: No GIL vs GIL</a></li>
  <li><a href="#parallel-load-testing-how-does-plaintext-fare" id="toc-parallel-load-testing-how-does-plaintext-fare">Parallel Load Testing: How does Plaintext Fare?</a></li>
  <li><a href="#parallel-load-test-summary" id="toc-parallel-load-test-summary">Parallel Load Test Summary</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#finishing-up" id="toc-finishing-up">Finishing Up</a>
  <ul>
  <li><a href="#reviewing-initial-implementation" id="toc-reviewing-initial-implementation">Reviewing Initial Implementation</a>
  <ul>
  <li><a href="#skipping-weight-initialization" id="toc-skipping-weight-initialization">Skipping Weight Initialization</a></li>
  <li><a href="#can-we-load-other-checkpoints" id="toc-can-we-load-other-checkpoints">Can We Load Other Checkpoints?</a></li>
  <li><a href="#multi-gpu-support" id="toc-multi-gpu-support">Multi-GPU Support</a></li>
  </ul></li>
  <li><a href="#model-optimization" id="toc-model-optimization">Model Optimization</a>
  <ul>
  <li><a href="#torchscript" id="toc-torchscript">TorchScript</a></li>
  <li><a href="#torch-dynamo-torch.compile" id="toc-torch-dynamo-torch.compile">Torch Dynamo (torch.compile)</a>
  <ul>
  <li><a href="#performance-comparison" id="toc-performance-comparison">Performance Comparison</a></li>
  <li><a href="#free-threaded-python-py313t" id="toc-free-threaded-python-py313t">Free-Threaded Python (py313t)</a></li>
  <li><a href="#normal-python-py313" id="toc-normal-python-py313">Normal Python (py313)</a></li>
  <li><a href="#explicit-torch.compile-decorator" id="toc-explicit-torch.compile-decorator">Explicit <span class="citation" data-cites="torch.compile">@torch.compile</span> Decorator</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion">Conclusion</a></li>
  </ul>
</nav>
<p>This post is sponsored in part by <a href="https://meta.com">Meta</a> in collaboration with <a href="https://quansight.com">Quansight</a> and <a href="https://openteams.com">OpenTeams</a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Toggle the little radio button in the navigation bar at the top to switch between native <em>Light Mode</em> and <em>Dark Mode</em> themes.</p>
</div>
</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Python 3.13, released in October 2024, is the first version of Python to introduce support for a “no-GIL” <em>free-threaded</em> mode, per <a href="https://peps.python.org/pep-0703/">PEP-703 Making the Global Interpreter Lock Optional in CPython</a>, unlocking the ability for multiple Python threads to run simultaneously.</p>
<p>This allows, for the first time since the language’s inception in December 1989, a single Python process to saturate all CPU cores in parallel with pure Python code (i.e.&nbsp;not farming out to extension modules written in C, C++, or, more recently, Rust).</p>
<p>A handful of the <a href="https://peps.python.org/pep-0703/#motivation">motivations</a> captured in that PEP opine on how the GIL impedes Python AI workflows, particularly as it relates to GPU programming.</p>
<p>This blog post explores what can be done with <a href="https://pytorch.org">PyTorch</a> now with the new free-threaded version of Python, specifically focusing on run-time inference on transformer-based generative models.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>I didn’t focus on how <em>training</em> PyTorch models might look in the new free-threaded Python world for a couple of reasons.</p>
<p>Primarily, training is a lot more complex if you’re involving multiple nodes—as gradients need to be carefully synchronized at critical points, for example—and is well outside the scope of a simple blog post.</p>
<p>Additionally, there’s already a huge body of existing work tackling multi-node training in PyTorch by way of the <a href="https://pytorch.org/tutorials/intermediate/ddp_tutorial.html">Distributed Data Parallel</a>, <code>multiprocessing</code>-based facilities exposed by <a href="https://pytorch.org/tutorials/intermediate/dist_tuto.html"><code>torch.distributed</code></a>.</p>
<p>Whereas, on the flip side, no one has really explored what parallel inference might look like in a single-threaded Python because the GIL has prevented that from even being an option until now.</p>
</div>
</div>
</section>
<section id="getting-started" class="level1">
<h1>Getting Started</h1>
<p>All of this work was done on Linux (Ubuntu 22.04) with Python 3.13t, PyTorch 2.6, and CUDA 12.6.</p>
<p>Full source code is provided to everything captured in this post. It is worth noting that in a few cases, I am rolling my own solutions for things that have existing solutions in the broader Python ecosystem. For example, in the tail end of the post, I leverage a multi-threaded <code>asyncio</code>-based HTTP server I wrote instead of using existing solutions like <a href="https://fastapi.tiangolo.com/">FastAPI</a>.</p>
<p>The reason for this is that, as free-threaded Python is still in its infancy, a lot of packages do not work with it yet, especially those that rely on Cython, C or C++ code, or Rust.</p>
<p>In fact, Rust dependencies are particularly problematic due to the proliferation of Python projects leveraging <a href="https://github.com/PyO3/pyo3">PyO3</a> (Rust bindings for Python), especially prominent projects such as <a href="https://github.com/openai/tiktoken">TikToken</a> and <a href="https://docs.pydantic.dev/latest/">Pydantic</a>, upon which a lot of the Python AI ecosystem is built. PyO3 only recently grew support for free-threaded Python in their 0.23.3 release, which came out in December, 2024, and many dependent projects are yet to update to it.</p>
<p>Thus, this post and its supporting code should not be considered the state of the art for production deployments—its primary goal is exploratory in nature, and minimizing the number of moving pieces in the stack helps achieve this goal.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Environment Setup Details">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Environment Setup Details
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="environments" class="level2">
<h2 class="anchored" data-anchor-id="environments">Environments</h2>
<p>It is fiddly getting the environments set up in support of this post. Again, this is due to the infancy of free-threaded Python. So I apologize in advance for how long this environment setup section is.</p>
<p>I reference two <code>conda</code> environments in this post: a Python 3.13 free-threaded one named <code>py313t</code>, and a normal, not-free-threaded Python 3.13 one named <code>py313</code>.</p>
<p>The primary motivation behind the second <code>py313</code> environment is it allows us to install Jupyter Lab, which, at the time of writing, still isn’t compatible with a Python free-threaded installation. However, we can still register a free-threaded Python kernel with Jupyter, which is all we really care about when running the code in this post in a free-threaded environment.</p>
<p>Details on creating the <code>conda</code> environments follow.</p>
<section id="free-threaded-3.13-env-py313t" class="level3">
<h3 class="anchored" data-anchor-id="free-threaded-3.13-env-py313t">Free-Threaded 3.13 Env (py313t)</h3>
<p>I use <code>conda</code> to create the Python 3.13 free-threaded environment plus initial dependencies, activate it, then install the remaining dependencies via pip, as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">-n</span> py313t python=3.13 python-freethreading <span class="dt">\</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    nodejs pip tqdm flake8 rust requests <span class="dt">\</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">-c</span> conda-forge</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate py313t</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install numpy setuptools_rust regex safetensors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>nodejs</code> is required for the UI component we’ll introduce later. <code>regex</code>, <code>rust</code>, and <code>setuptools_rust</code> are needed for <code>tiktoken</code>, described next. Finally, <code>numpy</code> is for <code>torch</code>, which we install later, too.</p>
<section id="tiktoken" class="level4">
<h4 class="anchored" data-anchor-id="tiktoken">TikToken</h4>
<p><a href="https://github.com/openai/tiktoken">TikToken</a> is a fast BPE tokenizer from OpenAI that is used extensively in the emerging Python LLM landscape. At the time of writing, the latest TikToken release was <a href="https://github.com/openai/tiktoken/releases/tag/0.8.0">0.8.0</a>, which was built against PyO3 0.22.2, which isn’t compatible with free-threaded Python.</p>
<p>Thankfully, it was trivial to get a local installation of <code>tiktoken</code> working by cloning the Github repo, bumping the PyO3 version in <code>Cargo.toml</code>, then rebuilding and installing.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is a perfect example of the type of fiddling around I wanted to avoid by not depending on any external packages other than the bare necessities, such as PyTorch. I made an exception for <code>tiktoken</code> because a) it’s arguably an equally-important part of the LLM stack as <code>torch</code>, and b) it thankfully wasn’t <em>too</em> difficult getting a compatible version of <code>tiktoken</code> installed locally.</p>
</div>
</div>
<p>Clone the tiktoken git repo and cd into it as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/openai/tiktoken</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> tiktoken</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Edit the <code>Cargo.toml</code> file and change the <code>pyo3</code> dependency version to at least 0.23.3<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode diff code-with-copy"><code class="sourceCode diff"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">diff --git a/Cargo.toml b/Cargo.toml</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>index 2eed0c1..6be5f63 100644</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="dt">--- a/Cargo.toml</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="dt">+++ b/Cargo.toml</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="dt">@@ -9,7 +9,7 @@ name = "_tiktoken"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a> crate-type = ["cdylib"]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a> [dependencies]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">-pyo3 = { version = "0.22.2", default-features = false, features = ["extension-module", "macros"] }</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="va">+pyo3 = { version = "0.23.3", default-features = false, features = ["extension-module", "macros"] }</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a> # tiktoken dependencies</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a> fancy-regex = "0.13.0"</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>With this patch applied, and the <code>py313t</code> conda environment active (with <code>rust</code> and <code>setuptools_rust</code> installed):</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> setup.py build</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> setup.py install</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Show Build &amp; Install Output">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show Build &amp; Install Output
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">py313t</span><span class="kw">)</span> <span class="ex">{pytorch}</span> <span class="pp">[</span><span class="ss">12.6</span><span class="pp">]</span> [trent@dgx/ttypts/3<span class="er">(</span><span class="ex">~s/tiktoken</span><span class="kw">)</span><span class="ex">%]</span> python setup.py build</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> build</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> build_py</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/_educational.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/__init__.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/registry.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/model.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/load.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/core.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken_ext/openai_public.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken_ext</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> egg_info</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="ex">writing</span> tiktoken.egg-info/PKG-INFO</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="ex">writing</span> dependency_links to tiktoken.egg-info/dependency_links.txt</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="ex">writing</span> requirements to tiktoken.egg-info/requires.txt</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="ex">writing</span> top-level names to tiktoken.egg-info/top_level.txt</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="ex">reading</span> manifest file <span class="st">'tiktoken.egg-info/SOURCES.txt'</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="ex">reading</span> manifest template <span class="st">'MANIFEST.in'</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> no files found matching <span class="st">'Makefile'</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="ex">adding</span> license file <span class="st">'LICENSE'</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="ex">writing</span> manifest file <span class="st">'tiktoken.egg-info/SOURCES.txt'</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/py.typed <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> build_ext</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> build_rust</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> rustc <span class="at">--lib</span> <span class="at">--message-format</span><span class="op">=</span>json-render-diagnostics <span class="at">--manifest-path</span> Cargo.toml <span class="at">--release</span> <span class="at">-v</span> <span class="at">--features</span> pyo3/extension-module <span class="at">--crate-type</span> cdylib <span class="at">--</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> target-lexicon v0.12.16</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> once_cell v1.20.2</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> proc-macro2 v1.0.92</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> unicode-ident v1.0.14</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> memchr v2.7.4</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> regex-syntax v0.8.5</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> libc v0.2.169</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> autocfg v1.4.0</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> heck v0.5.0</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> bit-vec v0.6.3</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> unindent v0.2.3</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> indoc v2.0.5</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> cfg-if v1.0.0</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> rustc-hash v1.1.0</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> build_script_build <span class="at">--edition</span><span class="op">=</span>2018 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/target-lexicon-0.12.16/build.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> bin <span class="at">--emit</span><span class="op">=</span>dep-info,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("arch_zkasm", "default", "serde", "serde_support", "std"))'</span> <span class="at">-C</span> metadata=826df8be4fa9ef21 <span class="at">-C</span> extra-filename=-826df8be4fa9ef21 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/build/target-lexicon-826df8be4fa9ef21 <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> once_cell <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/once_cell-1.20.2/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="alloc"'</span> <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="race"'</span> <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("alloc", "atomic-polyfill", "critical-section", "default", "parking_lot", "portable-atomic", "race", "std", "unstable"))'</span> <span class="at">-C</span> metadata=6870d82906744d65 <span class="at">-C</span> extra-filename=-6870d82906744d65 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> build_script_build <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/proc-macro2-1.0.92/build.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> bin <span class="at">--emit</span><span class="op">=</span>dep-info,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="proc-macro"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("default", "nightly", "proc-macro", "span-locations"))'</span> <span class="at">-C</span> metadata=4463b02a2f05d75c <span class="at">-C</span> extra-filename=-4463b02a2f05d75c <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/build/proc-macro2-4463b02a2f05d75c <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> unicode_ident <span class="at">--edition</span><span class="op">=</span>2018 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/unicode-ident-1.0.14/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values())'</span> <span class="at">-C</span> metadata=17278dafa5f26de9 <span class="at">-C</span> extra-filename=-17278dafa5f26de9 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> memchr <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/memchr-2.7.4/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="alloc"'</span> <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("alloc", "compiler_builtins", "core", "default", "libc", "logging", "rustc-dep-of-std", "std", "use_std"))'</span> <span class="at">-C</span> metadata=25fa9792dd9399b0 <span class="at">-C</span> extra-filename=-25fa9792dd9399b0 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> regex_syntax <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/regex-syntax-0.8.5/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-age"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-bool"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-case"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-gencat"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-perl"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-script"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-segment"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("arbitrary", "default", "std", "unicode", "unicode-age", "unicode-bool", "unicode-case", "unicode-gencat", "unicode-perl", "unicode-script", "unicode-segment"))'</span> <span class="at">-C</span> metadata=66f570e05dbe3825 <span class="at">-C</span> extra-filename=-66f570e05dbe3825 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> build_script_build <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/libc-0.2.169/build.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> bin <span class="at">--emit</span><span class="op">=</span>dep-info,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("align", "const-extern-fn", "default", "extra_traits", "rustc-dep-of-std", "rustc-std-workspace-core", "std", "use_std"))'</span> <span class="at">-C</span> metadata=42fd5088387abf7a <span class="at">-C</span> extra-filename=-42fd5088387abf7a <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/build/libc-42fd5088387abf7a <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> autocfg <span class="at">--edition</span><span class="op">=</span>2015 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/autocfg-1.4.0/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values())'</span> <span class="at">-C</span> metadata=b8e4c5d316ce5bfb <span class="at">-C</span> extra-filename=-b8e4c5d316ce5bfb <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> bit_vec <span class="at">--edition</span><span class="op">=</span>2015 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/bit-vec-0.6.3/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("default", "serde", "serde_no_std", "serde_std", "std"))'</span> <span class="at">-C</span> metadata=de2a0d1e2ef2490a <span class="at">-C</span> extra-filename=-de2a0d1e2ef2490a <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> heck <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/heck-0.5.0/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values())'</span> <span class="at">-C</span> metadata=5e22b1dffa7f4255 <span class="at">-C</span> extra-filename=-5e22b1dffa7f4255 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> once_cell <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/once_cell-1.20.2/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="alloc"'</span> <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="race"'</span> <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("alloc", "atomic-polyfill", "critical-section", "default", "parking_lot", "portable-atomic", "race", "std", "unstable"))'</span> <span class="at">-C</span> metadata=05003007543cfa87 <span class="at">-C</span> extra-filename=-05003007543cfa87 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> unindent <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/unindent-0.2.3/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values())'</span> <span class="at">-C</span> metadata=d53e2a0385a47a80 <span class="at">-C</span> extra-filename=-d53e2a0385a47a80 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> indoc <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/indoc-2.0.5/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> proc-macro <span class="at">--emit</span><span class="op">=</span>dep-info,link <span class="at">-C</span> prefer-dynamic <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values())'</span> <span class="at">-C</span> metadata=b4e94d9ecbd21a39 <span class="at">-C</span> extra-filename=-b4e94d9ecbd21a39 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> proc_macro <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> cfg_if <span class="at">--edition</span><span class="op">=</span>2018 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/cfg-if-1.0.0/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("compiler_builtins", "core", "rustc-dep-of-std"))'</span> <span class="at">-C</span> metadata=e4ded2c19830fbdd <span class="at">-C</span> extra-filename=-e4ded2c19830fbdd <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> rustc_hash <span class="at">--edition</span><span class="op">=</span>2015 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/rustc-hash-1.1.0/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("default", "std"))'</span> <span class="at">-C</span> metadata=b006f4d81e95dfaf <span class="at">-C</span> extra-filename=-b006f4d81e95dfaf <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> bit-set v0.5.3</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> bit_set <span class="at">--edition</span><span class="op">=</span>2015 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/bit-set-0.5.3/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("default", "std"))'</span> <span class="at">-C</span> metadata=40d90f83eb5bab57 <span class="at">-C</span> extra-filename=-40d90f83eb5bab57 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> bit_vec=/home/trent/src/tiktoken/target/release/deps/libbit_vec-de2a0d1e2ef2490a.rmeta <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">/home/trent/src/tiktoken/target/release/build/libc-42fd5088387abf7a/build-script-build</span><span class="kw">`</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">/home/trent/src/tiktoken/target/release/build/proc-macro2-4463b02a2f05d75c/build-script-build</span><span class="kw">`</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> memoffset v0.9.1</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> build_script_build <span class="at">--edition</span><span class="op">=</span>2015 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/memoffset-0.9.1/build.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> bin <span class="at">--emit</span><span class="op">=</span>dep-info,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("default", "unstable_const", "unstable_offset_of"))'</span> <span class="at">-C</span> metadata=679ebbc3261d6845 <span class="at">-C</span> extra-filename=-679ebbc3261d6845 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/build/memoffset-679ebbc3261d6845 <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> autocfg=/home/trent/src/tiktoken/target/release/deps/libautocfg-b8e4c5d316ce5bfb.rlib <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> libc <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/libc-0.2.169/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("align", "const-extern-fn", "default", "extra_traits", "rustc-dep-of-std", "rustc-std-workspace-core", "std", "use_std"))'</span> <span class="at">-C</span> metadata=6b0fbe5bd5ba9d30 <span class="at">-C</span> extra-filename=-6b0fbe5bd5ba9d30 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow <span class="at">--cfg</span> freebsd11 <span class="at">--cfg</span> libc_const_extern_fn <span class="at">--check-cfg</span> <span class="st">'cfg(emscripten_new_stat_abi)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(espidf_time32)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(freebsd10)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(freebsd11)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(freebsd12)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(freebsd13)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(freebsd14)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(freebsd15)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(libc_const_extern_fn)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(libc_deny_warnings)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(libc_thread_local)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(libc_ctest)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(target_os,values("switch","aix","ohos","hurd","rtems","visionos","nuttx"))'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(target_env,values("illumos","wasi","aix","ohos"))'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(target_arch,values("loongarch64","mips32r6","mips64r6","csky"))'</span><span class="kw">`</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> proc_macro2 <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/proc-macro2-1.0.92/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="proc-macro"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("default", "nightly", "proc-macro", "span-locations"))'</span> <span class="at">-C</span> metadata=4c69c42d9df03375 <span class="at">-C</span> extra-filename=-4c69c42d9df03375 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> unicode_ident=/home/trent/src/tiktoken/target/release/deps/libunicode_ident-17278dafa5f26de9.rmeta <span class="at">--cap-lints</span> allow <span class="at">--cfg</span> wrap_proc_macro <span class="at">--check-cfg</span> <span class="st">'cfg(fuzzing)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(no_is_available)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(no_literal_byte_character)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(no_literal_c_string)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(no_source_text)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(proc_macro_span)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(procmacro2_backtrace)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(procmacro2_nightly_testing)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(procmacro2_semver_exempt)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(randomize_layout)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(span_locations)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(super_unstable)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(wrap_proc_macro)'</span><span class="kw">`</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">/home/trent/src/tiktoken/target/release/build/target-lexicon-826df8be4fa9ef21/build-script-build</span><span class="kw">`</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> target_lexicon <span class="at">--edition</span><span class="op">=</span>2018 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/target-lexicon-0.12.16/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("arch_zkasm", "default", "serde", "serde_support", "std"))'</span> <span class="at">-C</span> metadata=a879275207ec599a <span class="at">-C</span> extra-filename=-a879275207ec599a <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow <span class="at">--cfg</span> <span class="st">'feature="rust_1_40"'</span><span class="kw">`</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">/home/trent/src/tiktoken/target/release/build/memoffset-679ebbc3261d6845/build-script-build</span><span class="kw">`</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> memoffset <span class="at">--edition</span><span class="op">=</span>2015 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/memoffset-0.9.1/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("default", "unstable_const", "unstable_offset_of"))'</span> <span class="at">-C</span> metadata=65fe1a8a113b3005 <span class="at">-C</span> extra-filename=-65fe1a8a113b3005 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--cap-lints</span> allow <span class="at">--cfg</span> tuple_ty <span class="at">--cfg</span> allow_clippy <span class="at">--cfg</span> maybe_uninit <span class="at">--cfg</span> doctests <span class="at">--cfg</span> raw_ref_macros <span class="at">--cfg</span> stable_const <span class="at">--cfg</span> stable_offset_of<span class="kw">`</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> aho-corasick v1.1.3</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> aho_corasick <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/aho-corasick-1.1.3/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="perf-literal"'</span> <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("default", "logging", "perf-literal", "std"))'</span> <span class="at">-C</span> metadata=6668c9f838fb89b3 <span class="at">-C</span> extra-filename=-6668c9f838fb89b3 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> memchr=/home/trent/src/tiktoken/target/release/deps/libmemchr-25fa9792dd9399b0.rmeta <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> pyo3-build-config v0.23.3</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> build_script_build <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/pyo3-build-config-0.23.3/build.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> bin <span class="at">--emit</span><span class="op">=</span>dep-info,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="extension-module"'</span> <span class="at">--cfg</span> <span class="st">'feature="resolve-config"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("abi3", "abi3-py310", "abi3-py311", "abi3-py312", "abi3-py37", "abi3-py38", "abi3-py39", "default", "extension-module", "python3-dll-a", "resolve-config"))'</span> <span class="at">-C</span> metadata=d8ab86bb094cf645 <span class="at">-C</span> extra-filename=-d8ab86bb094cf645 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/build/pyo3-build-config-d8ab86bb094cf645 <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> target_lexicon=/home/trent/src/tiktoken/target/release/deps/libtarget_lexicon-a879275207ec599a.rlib <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> quote v1.0.38</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> quote <span class="at">--edition</span><span class="op">=</span>2018 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/quote-1.0.38/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="proc-macro"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("default", "proc-macro"))'</span> <span class="at">-C</span> metadata=169332b6fe3d21d6 <span class="at">-C</span> extra-filename=-169332b6fe3d21d6 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> proc_macro2=/home/trent/src/tiktoken/target/release/deps/libproc_macro2-4c69c42d9df03375.rmeta <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> syn v2.0.95</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> syn <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/syn-2.0.95/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="clone-impls"'</span> <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="derive"'</span> <span class="at">--cfg</span> <span class="st">'feature="extra-traits"'</span> <span class="at">--cfg</span> <span class="st">'feature="full"'</span> <span class="at">--cfg</span> <span class="st">'feature="parsing"'</span> <span class="at">--cfg</span> <span class="st">'feature="printing"'</span> <span class="at">--cfg</span> <span class="st">'feature="proc-macro"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("clone-impls", "default", "derive", "extra-traits", "fold", "full", "parsing", "printing", "proc-macro", "test", "visit", "visit-mut"))'</span> <span class="at">-C</span> metadata=29d4a0ddbd98f61f <span class="at">-C</span> extra-filename=-29d4a0ddbd98f61f <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> proc_macro2=/home/trent/src/tiktoken/target/release/deps/libproc_macro2-4c69c42d9df03375.rmeta <span class="at">--extern</span> quote=/home/trent/src/tiktoken/target/release/deps/libquote-169332b6fe3d21d6.rmeta <span class="at">--extern</span> unicode_ident=/home/trent/src/tiktoken/target/release/deps/libunicode_ident-17278dafa5f26de9.rmeta <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">/home/trent/src/tiktoken/target/release/build/pyo3-build-config-d8ab86bb094cf645/build-script-build</span><span class="kw">`</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> pyo3_build_config <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/pyo3-build-config-0.23.3/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> embed-bitcode=no <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="extension-module"'</span> <span class="at">--cfg</span> <span class="st">'feature="resolve-config"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("abi3", "abi3-py310", "abi3-py311", "abi3-py312", "abi3-py37", "abi3-py38", "abi3-py39", "default", "extension-module", "python3-dll-a", "resolve-config"))'</span> <span class="at">-C</span> metadata=b884267014f5753b <span class="at">-C</span> extra-filename=-b884267014f5753b <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> once_cell=/home/trent/src/tiktoken/target/release/deps/libonce_cell-6870d82906744d65.rmeta <span class="at">--extern</span> target_lexicon=/home/trent/src/tiktoken/target/release/deps/libtarget_lexicon-a879275207ec599a.rmeta <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> pyo3-ffi v0.23.3</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> pyo3-macros-backend v0.23.3</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> pyo3 v0.23.3</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> build_script_build <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/pyo3-ffi-0.23.3/build.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> bin <span class="at">--emit</span><span class="op">=</span>dep-info,link <span class="at">-C</span> embed-bitcode=no <span class="at">--warn</span><span class="op">=</span>rust_2018_idioms <span class="st">'--warn=clippy::useless_transmute'</span> <span class="st">'--warn=clippy::used_underscore_binding'</span> <span class="at">--warn</span><span class="op">=</span>unused_lifetimes <span class="st">'--warn=clippy::unnecessary_wraps'</span> <span class="st">'--warn=clippy::todo'</span> <span class="at">--warn</span><span class="op">=</span>rust_2021_prelude_collisions <span class="st">'--warn=clippy::manual_ok_or'</span> <span class="st">'--warn=clippy::manual_assert'</span> <span class="st">'--warn=clippy::let_unit_value'</span> <span class="at">--warn</span><span class="op">=</span>invalid_doc_attributes <span class="st">'--warn=clippy::flat_map_option'</span> <span class="st">'--warn=clippy::filter_map_next'</span> <span class="st">'--warn=clippy::explicit_iter_loop'</span> <span class="st">'--warn=clippy::explicit_into_iter_loop'</span> <span class="at">--warn</span><span class="op">=</span>elided_lifetimes_in_paths <span class="st">'--warn=clippy::dbg_macro'</span> <span class="st">'--warn=clippy::checked_conversions'</span> <span class="st">'--warn=rustdoc::broken_intra_doc_links'</span> <span class="st">'--warn=rustdoc::bare_urls'</span> <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="extension-module"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("abi3", "abi3-py310", "abi3-py311", "abi3-py312", "abi3-py37", "abi3-py38", "abi3-py39", "default", "extension-module", "generate-import-lib"))'</span> <span class="at">-C</span> metadata=5c5f8f108a22b6ae <span class="at">-C</span> extra-filename=-5c5f8f108a22b6ae <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/build/pyo3-ffi-5c5f8f108a22b6ae <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> pyo3_build_config=/home/trent/src/tiktoken/target/release/deps/libpyo3_build_config-b884267014f5753b.rlib <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> build_script_build <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/pyo3-macros-backend-0.23.3/build.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> bin <span class="at">--emit</span><span class="op">=</span>dep-info,link <span class="at">-C</span> embed-bitcode=no <span class="at">--warn</span><span class="op">=</span>rust_2018_idioms <span class="st">'--warn=clippy::useless_transmute'</span> <span class="st">'--warn=clippy::used_underscore_binding'</span> <span class="at">--warn</span><span class="op">=</span>unused_lifetimes <span class="st">'--warn=clippy::unnecessary_wraps'</span> <span class="st">'--warn=clippy::todo'</span> <span class="at">--warn</span><span class="op">=</span>rust_2021_prelude_collisions <span class="st">'--warn=clippy::manual_ok_or'</span> <span class="st">'--warn=clippy::manual_assert'</span> <span class="st">'--warn=clippy::let_unit_value'</span> <span class="at">--warn</span><span class="op">=</span>invalid_doc_attributes <span class="st">'--warn=clippy::flat_map_option'</span> <span class="st">'--warn=clippy::filter_map_next'</span> <span class="st">'--warn=clippy::explicit_iter_loop'</span> <span class="st">'--warn=clippy::explicit_into_iter_loop'</span> <span class="at">--warn</span><span class="op">=</span>elided_lifetimes_in_paths <span class="st">'--warn=clippy::dbg_macro'</span> <span class="st">'--warn=clippy::checked_conversions'</span> <span class="st">'--warn=rustdoc::broken_intra_doc_links'</span> <span class="st">'--warn=rustdoc::bare_urls'</span> <span class="at">-C</span> debug-assertions=off <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("experimental-async"))'</span> <span class="at">-C</span> metadata=bb4a4b3911c85e51 <span class="at">-C</span> extra-filename=-bb4a4b3911c85e51 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/build/pyo3-macros-backend-bb4a4b3911c85e51 <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> pyo3_build_config=/home/trent/src/tiktoken/target/release/deps/libpyo3_build_config-b884267014f5753b.rlib <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> build_script_build <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/pyo3-0.23.3/build.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> bin <span class="at">--emit</span><span class="op">=</span>dep-info,link <span class="at">-C</span> embed-bitcode=no <span class="at">--warn</span><span class="op">=</span>rust_2018_idioms <span class="st">'--warn=clippy::useless_transmute'</span> <span class="st">'--warn=clippy::used_underscore_binding'</span> <span class="at">--warn</span><span class="op">=</span>unused_lifetimes <span class="st">'--warn=clippy::unnecessary_wraps'</span> <span class="st">'--warn=clippy::todo'</span> <span class="at">--warn</span><span class="op">=</span>rust_2021_prelude_collisions <span class="st">'--warn=clippy::manual_ok_or'</span> <span class="st">'--warn=clippy::manual_assert'</span> <span class="st">'--warn=clippy::let_unit_value'</span> <span class="at">--warn</span><span class="op">=</span>invalid_doc_attributes <span class="st">'--warn=clippy::flat_map_option'</span> <span class="st">'--warn=clippy::filter_map_next'</span> <span class="st">'--warn=clippy::explicit_iter_loop'</span> <span class="st">'--warn=clippy::explicit_into_iter_loop'</span> <span class="at">--warn</span><span class="op">=</span>elided_lifetimes_in_paths <span class="st">'--warn=clippy::dbg_macro'</span> <span class="st">'--warn=clippy::checked_conversions'</span> <span class="st">'--warn=rustdoc::broken_intra_doc_links'</span> <span class="st">'--warn=rustdoc::bare_urls'</span> <span class="at">-C</span> debug-assertions=off <span class="at">--cfg</span> <span class="st">'feature="extension-module"'</span> <span class="at">--cfg</span> <span class="st">'feature="indoc"'</span> <span class="at">--cfg</span> <span class="st">'feature="macros"'</span> <span class="at">--cfg</span> <span class="st">'feature="pyo3-macros"'</span> <span class="at">--cfg</span> <span class="st">'feature="unindent"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("abi3", "abi3-py310", "abi3-py311", "abi3-py312", "abi3-py37", "abi3-py38", "abi3-py39", "anyhow", "auto-initialize", "chrono", "chrono-tz", "default", "either", "experimental-async", "experimental-inspect", "extension-module", "eyre", "full", "generate-import-lib", "hashbrown", "indexmap", "indoc", "inventory", "macros", "multiple-pymethods", "nightly", "num-bigint", "num-complex", "num-rational", "py-clone", "pyo3-macros", "rust_decimal", "serde", "smallvec", "unindent"))'</span> <span class="at">-C</span> metadata=65f0dbfaaf67ed5a <span class="at">-C</span> extra-filename=-65f0dbfaaf67ed5a <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/build/pyo3-65f0dbfaaf67ed5a <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> pyo3_build_config=/home/trent/src/tiktoken/target/release/deps/libpyo3_build_config-b884267014f5753b.rlib <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> regex-automata v0.4.9</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> regex_automata <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/regex-automata-0.4.9/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="alloc"'</span> <span class="at">--cfg</span> <span class="st">'feature="dfa"'</span> <span class="at">--cfg</span> <span class="st">'feature="dfa-build"'</span> <span class="at">--cfg</span> <span class="st">'feature="dfa-onepass"'</span> <span class="at">--cfg</span> <span class="st">'feature="dfa-search"'</span> <span class="at">--cfg</span> <span class="st">'feature="hybrid"'</span> <span class="at">--cfg</span> <span class="st">'feature="meta"'</span> <span class="at">--cfg</span> <span class="st">'feature="nfa"'</span> <span class="at">--cfg</span> <span class="st">'feature="nfa-backtrack"'</span> <span class="at">--cfg</span> <span class="st">'feature="nfa-pikevm"'</span> <span class="at">--cfg</span> <span class="st">'feature="nfa-thompson"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf-inline"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf-literal"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf-literal-multisubstring"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf-literal-substring"'</span> <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--cfg</span> <span class="st">'feature="syntax"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-age"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-bool"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-case"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-gencat"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-perl"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-script"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-segment"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-word-boundary"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("alloc", "default", "dfa", "dfa-build", "dfa-onepass", "dfa-search", "hybrid", "internal-instrument", "internal-instrument-pikevm", "logging", "meta", "nfa", "nfa-backtrack", "nfa-pikevm", "nfa-thompson", "perf", "perf-inline", "perf-literal", "perf-literal-multisubstring", "perf-literal-substring", "std", "syntax", "unicode", "unicode-age", "unicode-bool", "unicode-case", "unicode-gencat", "unicode-perl", "unicode-script", "unicode-segment", "unicode-word-boundary"))'</span> <span class="at">-C</span> metadata=01135b6ed6d4413e <span class="at">-C</span> extra-filename=-01135b6ed6d4413e <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> aho_corasick=/home/trent/src/tiktoken/target/release/deps/libaho_corasick-6668c9f838fb89b3.rmeta <span class="at">--extern</span> memchr=/home/trent/src/tiktoken/target/release/deps/libmemchr-25fa9792dd9399b0.rmeta <span class="at">--extern</span> regex_syntax=/home/trent/src/tiktoken/target/release/deps/libregex_syntax-66f570e05dbe3825.rmeta <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">/home/trent/src/tiktoken/target/release/build/pyo3-macros-backend-bb4a4b3911c85e51/build-script-build</span><span class="kw">`</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">/home/trent/src/tiktoken/target/release/build/pyo3-ffi-5c5f8f108a22b6ae/build-script-build</span><span class="kw">`</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">/home/trent/src/tiktoken/target/release/build/pyo3-65f0dbfaaf67ed5a/build-script-build</span><span class="kw">`</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> pyo3_ffi <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/pyo3-ffi-0.23.3/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--warn</span><span class="op">=</span>rust_2018_idioms <span class="st">'--warn=clippy::useless_transmute'</span> <span class="st">'--warn=clippy::used_underscore_binding'</span> <span class="at">--warn</span><span class="op">=</span>unused_lifetimes <span class="st">'--warn=clippy::unnecessary_wraps'</span> <span class="st">'--warn=clippy::todo'</span> <span class="at">--warn</span><span class="op">=</span>rust_2021_prelude_collisions <span class="st">'--warn=clippy::manual_ok_or'</span> <span class="st">'--warn=clippy::manual_assert'</span> <span class="st">'--warn=clippy::let_unit_value'</span> <span class="at">--warn</span><span class="op">=</span>invalid_doc_attributes <span class="st">'--warn=clippy::flat_map_option'</span> <span class="st">'--warn=clippy::filter_map_next'</span> <span class="st">'--warn=clippy::explicit_iter_loop'</span> <span class="st">'--warn=clippy::explicit_into_iter_loop'</span> <span class="at">--warn</span><span class="op">=</span>elided_lifetimes_in_paths <span class="st">'--warn=clippy::dbg_macro'</span> <span class="st">'--warn=clippy::checked_conversions'</span> <span class="st">'--warn=rustdoc::broken_intra_doc_links'</span> <span class="st">'--warn=rustdoc::bare_urls'</span> <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="extension-module"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("abi3", "abi3-py310", "abi3-py311", "abi3-py312", "abi3-py37", "abi3-py38", "abi3-py39", "default", "extension-module", "generate-import-lib"))'</span> <span class="at">-C</span> metadata=9ad2a4f2678f35bd <span class="at">-C</span> extra-filename=-9ad2a4f2678f35bd <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> libc=/home/trent/src/tiktoken/target/release/deps/liblibc-6b0fbe5bd5ba9d30.rmeta <span class="at">--cap-lints</span> allow <span class="at">--cfg</span> Py_3_7 <span class="at">--cfg</span> Py_3_8 <span class="at">--cfg</span> Py_3_9 <span class="at">--cfg</span> Py_3_10 <span class="at">--cfg</span> Py_3_11 <span class="at">--cfg</span> Py_3_12 <span class="at">--cfg</span> Py_3_13 <span class="at">--cfg</span> Py_GIL_DISABLED <span class="at">--cfg</span> rustc_has_once_lock <span class="at">--cfg</span> invalid_from_utf8_lint <span class="at">--cfg</span> c_str_lit <span class="at">--cfg</span> diagnostic_namespace <span class="at">--check-cfg</span> <span class="st">'cfg(Py_LIMITED_API)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_GIL_DISABLED)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(PyPy)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(GraalPy)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(py_sys_config, values("Py_DEBUG", "Py_REF_DEBUG", "Py_TRACE_REFS", "COUNT_ALLOCS"))'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(invalid_from_utf8_lint)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(pyo3_disable_reference_pool)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(pyo3_leak_on_drop_without_reference_pool)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(diagnostic_namespace)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(c_str_lit)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(rustc_has_once_lock)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_7)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_8)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_9)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_10)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_11)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_12)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_13)'</span><span class="kw">`</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> pyo3_macros_backend <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/pyo3-macros-backend-0.23.3/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> embed-bitcode=no <span class="at">--warn</span><span class="op">=</span>rust_2018_idioms <span class="st">'--warn=clippy::useless_transmute'</span> <span class="st">'--warn=clippy::used_underscore_binding'</span> <span class="at">--warn</span><span class="op">=</span>unused_lifetimes <span class="st">'--warn=clippy::unnecessary_wraps'</span> <span class="st">'--warn=clippy::todo'</span> <span class="at">--warn</span><span class="op">=</span>rust_2021_prelude_collisions <span class="st">'--warn=clippy::manual_ok_or'</span> <span class="st">'--warn=clippy::manual_assert'</span> <span class="st">'--warn=clippy::let_unit_value'</span> <span class="at">--warn</span><span class="op">=</span>invalid_doc_attributes <span class="st">'--warn=clippy::flat_map_option'</span> <span class="st">'--warn=clippy::filter_map_next'</span> <span class="st">'--warn=clippy::explicit_iter_loop'</span> <span class="st">'--warn=clippy::explicit_into_iter_loop'</span> <span class="at">--warn</span><span class="op">=</span>elided_lifetimes_in_paths <span class="st">'--warn=clippy::dbg_macro'</span> <span class="st">'--warn=clippy::checked_conversions'</span> <span class="st">'--warn=rustdoc::broken_intra_doc_links'</span> <span class="st">'--warn=rustdoc::bare_urls'</span> <span class="at">-C</span> debug-assertions=off <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("experimental-async"))'</span> <span class="at">-C</span> metadata=c7424188824c71f8 <span class="at">-C</span> extra-filename=-c7424188824c71f8 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> heck=/home/trent/src/tiktoken/target/release/deps/libheck-5e22b1dffa7f4255.rmeta <span class="at">--extern</span> proc_macro2=/home/trent/src/tiktoken/target/release/deps/libproc_macro2-4c69c42d9df03375.rmeta <span class="at">--extern</span> pyo3_build_config=/home/trent/src/tiktoken/target/release/deps/libpyo3_build_config-b884267014f5753b.rmeta <span class="at">--extern</span> quote=/home/trent/src/tiktoken/target/release/deps/libquote-169332b6fe3d21d6.rmeta <span class="at">--extern</span> syn=/home/trent/src/tiktoken/target/release/deps/libsyn-29d4a0ddbd98f61f.rmeta <span class="at">--cap-lints</span> allow <span class="at">--cfg</span> rustc_has_once_lock <span class="at">--cfg</span> invalid_from_utf8_lint <span class="at">--cfg</span> c_str_lit <span class="at">--cfg</span> diagnostic_namespace <span class="at">--check-cfg</span> <span class="st">'cfg(Py_LIMITED_API)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_GIL_DISABLED)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(PyPy)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(GraalPy)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(py_sys_config, values("Py_DEBUG", "Py_REF_DEBUG", "Py_TRACE_REFS", "COUNT_ALLOCS"))'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(invalid_from_utf8_lint)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(pyo3_disable_reference_pool)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(pyo3_leak_on_drop_without_reference_pool)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(diagnostic_namespace)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(c_str_lit)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(rustc_has_once_lock)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_7)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_8)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_9)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_10)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_11)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_12)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_13)'</span><span class="kw">`</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> fancy-regex v0.13.0</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> regex v1.11.1</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> bstr v1.11.3</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> regex <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/regex-1.11.1/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf-backtrack"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf-cache"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf-dfa"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf-inline"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf-literal"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf-onepass"'</span> <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-age"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-bool"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-case"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-gencat"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-perl"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-script"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode-segment"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("default", "logging", "pattern", "perf", "perf-backtrack", "perf-cache", "perf-dfa", "perf-dfa-full", "perf-inline", "perf-literal", "perf-onepass", "std", "unicode", "unicode-age", "unicode-bool", "unicode-case", "unicode-gencat", "unicode-perl", "unicode-script", "unicode-segment", "unstable", "use_std"))'</span> <span class="at">-C</span> metadata=9ab83d1dbb2872e1 <span class="at">-C</span> extra-filename=-9ab83d1dbb2872e1 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> aho_corasick=/home/trent/src/tiktoken/target/release/deps/libaho_corasick-6668c9f838fb89b3.rmeta <span class="at">--extern</span> memchr=/home/trent/src/tiktoken/target/release/deps/libmemchr-25fa9792dd9399b0.rmeta <span class="at">--extern</span> regex_automata=/home/trent/src/tiktoken/target/release/deps/libregex_automata-01135b6ed6d4413e.rmeta <span class="at">--extern</span> regex_syntax=/home/trent/src/tiktoken/target/release/deps/libregex_syntax-66f570e05dbe3825.rmeta <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> fancy_regex <span class="at">--edition</span><span class="op">=</span>2018 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/fancy-regex-0.13.0/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="perf"'</span> <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("default", "perf", "std", "track_caller", "unicode"))'</span> <span class="at">-C</span> metadata=2bd42caf041ad10c <span class="at">-C</span> extra-filename=-2bd42caf041ad10c <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> bit_set=/home/trent/src/tiktoken/target/release/deps/libbit_set-40d90f83eb5bab57.rmeta <span class="at">--extern</span> regex_automata=/home/trent/src/tiktoken/target/release/deps/libregex_automata-01135b6ed6d4413e.rmeta <span class="at">--extern</span> regex_syntax=/home/trent/src/tiktoken/target/release/deps/libregex_syntax-66f570e05dbe3825.rmeta <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> bstr <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/bstr-1.11.3/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--cfg</span> <span class="st">'feature="alloc"'</span> <span class="at">--cfg</span> <span class="st">'feature="default"'</span> <span class="at">--cfg</span> <span class="st">'feature="std"'</span> <span class="at">--cfg</span> <span class="st">'feature="unicode"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("alloc", "default", "serde", "std", "unicode"))'</span> <span class="at">-C</span> metadata=cc96e78f4e9fd97f <span class="at">-C</span> extra-filename=-cc96e78f4e9fd97f <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> memchr=/home/trent/src/tiktoken/target/release/deps/libmemchr-25fa9792dd9399b0.rmeta <span class="at">--extern</span> regex_automata=/home/trent/src/tiktoken/target/release/deps/libregex_automata-01135b6ed6d4413e.rmeta <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> pyo3-macros v0.23.3</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> pyo3_macros <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/pyo3-macros-0.23.3/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> proc-macro <span class="at">--emit</span><span class="op">=</span>dep-info,link <span class="at">-C</span> prefer-dynamic <span class="at">-C</span> embed-bitcode=no <span class="at">--warn</span><span class="op">=</span>rust_2018_idioms <span class="st">'--warn=clippy::useless_transmute'</span> <span class="st">'--warn=clippy::used_underscore_binding'</span> <span class="at">--warn</span><span class="op">=</span>unused_lifetimes <span class="st">'--warn=clippy::unnecessary_wraps'</span> <span class="st">'--warn=clippy::todo'</span> <span class="at">--warn</span><span class="op">=</span>rust_2021_prelude_collisions <span class="st">'--warn=clippy::manual_ok_or'</span> <span class="st">'--warn=clippy::manual_assert'</span> <span class="st">'--warn=clippy::let_unit_value'</span> <span class="at">--warn</span><span class="op">=</span>invalid_doc_attributes <span class="st">'--warn=clippy::flat_map_option'</span> <span class="st">'--warn=clippy::filter_map_next'</span> <span class="st">'--warn=clippy::explicit_iter_loop'</span> <span class="st">'--warn=clippy::explicit_into_iter_loop'</span> <span class="at">--warn</span><span class="op">=</span>elided_lifetimes_in_paths <span class="st">'--warn=clippy::dbg_macro'</span> <span class="st">'--warn=clippy::checked_conversions'</span> <span class="st">'--warn=rustdoc::broken_intra_doc_links'</span> <span class="st">'--warn=rustdoc::bare_urls'</span> <span class="at">-C</span> debug-assertions=off <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("experimental-async", "multiple-pymethods"))'</span> <span class="at">-C</span> metadata=97a13ca0f34dda72 <span class="at">-C</span> extra-filename=-97a13ca0f34dda72 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> proc_macro2=/home/trent/src/tiktoken/target/release/deps/libproc_macro2-4c69c42d9df03375.rlib <span class="at">--extern</span> pyo3_macros_backend=/home/trent/src/tiktoken/target/release/deps/libpyo3_macros_backend-c7424188824c71f8.rlib <span class="at">--extern</span> quote=/home/trent/src/tiktoken/target/release/deps/libquote-169332b6fe3d21d6.rlib <span class="at">--extern</span> syn=/home/trent/src/tiktoken/target/release/deps/libsyn-29d4a0ddbd98f61f.rlib <span class="at">--extern</span> proc_macro <span class="at">--cap-lints</span> allow<span class="kw">`</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> pyo3 <span class="at">--edition</span><span class="op">=</span>2021 /home/trent/.cargo/registry/src/index.crates.io-6f17d22bba15001f/pyo3-0.23.3/src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> lib <span class="at">--emit</span><span class="op">=</span>dep-info,metadata,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--warn</span><span class="op">=</span>rust_2018_idioms <span class="st">'--warn=clippy::useless_transmute'</span> <span class="st">'--warn=clippy::used_underscore_binding'</span> <span class="at">--warn</span><span class="op">=</span>unused_lifetimes <span class="st">'--warn=clippy::unnecessary_wraps'</span> <span class="st">'--warn=clippy::todo'</span> <span class="at">--warn</span><span class="op">=</span>rust_2021_prelude_collisions <span class="st">'--warn=clippy::manual_ok_or'</span> <span class="st">'--warn=clippy::manual_assert'</span> <span class="st">'--warn=clippy::let_unit_value'</span> <span class="at">--warn</span><span class="op">=</span>invalid_doc_attributes <span class="st">'--warn=clippy::flat_map_option'</span> <span class="st">'--warn=clippy::filter_map_next'</span> <span class="st">'--warn=clippy::explicit_iter_loop'</span> <span class="st">'--warn=clippy::explicit_into_iter_loop'</span> <span class="at">--warn</span><span class="op">=</span>elided_lifetimes_in_paths <span class="st">'--warn=clippy::dbg_macro'</span> <span class="st">'--warn=clippy::checked_conversions'</span> <span class="st">'--warn=rustdoc::broken_intra_doc_links'</span> <span class="st">'--warn=rustdoc::bare_urls'</span> <span class="at">--cfg</span> <span class="st">'feature="extension-module"'</span> <span class="at">--cfg</span> <span class="st">'feature="indoc"'</span> <span class="at">--cfg</span> <span class="st">'feature="macros"'</span> <span class="at">--cfg</span> <span class="st">'feature="pyo3-macros"'</span> <span class="at">--cfg</span> <span class="st">'feature="unindent"'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values("abi3", "abi3-py310", "abi3-py311", "abi3-py312", "abi3-py37", "abi3-py38", "abi3-py39", "anyhow", "auto-initialize", "chrono", "chrono-tz", "default", "either", "experimental-async", "experimental-inspect", "extension-module", "eyre", "full", "generate-import-lib", "hashbrown", "indexmap", "indoc", "inventory", "macros", "multiple-pymethods", "nightly", "num-bigint", "num-complex", "num-rational", "py-clone", "pyo3-macros", "rust_decimal", "serde", "smallvec", "unindent"))'</span> <span class="at">-C</span> metadata=99d0b007138eadf4 <span class="at">-C</span> extra-filename=-99d0b007138eadf4 <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> cfg_if=/home/trent/src/tiktoken/target/release/deps/libcfg_if-e4ded2c19830fbdd.rmeta <span class="at">--extern</span> indoc=/home/trent/src/tiktoken/target/release/deps/libindoc-b4e94d9ecbd21a39.so <span class="at">--extern</span> libc=/home/trent/src/tiktoken/target/release/deps/liblibc-6b0fbe5bd5ba9d30.rmeta <span class="at">--extern</span> memoffset=/home/trent/src/tiktoken/target/release/deps/libmemoffset-65fe1a8a113b3005.rmeta <span class="at">--extern</span> once_cell=/home/trent/src/tiktoken/target/release/deps/libonce_cell-05003007543cfa87.rmeta <span class="at">--extern</span> pyo3_ffi=/home/trent/src/tiktoken/target/release/deps/libpyo3_ffi-9ad2a4f2678f35bd.rmeta <span class="at">--extern</span> pyo3_macros=/home/trent/src/tiktoken/target/release/deps/libpyo3_macros-97a13ca0f34dda72.so <span class="at">--extern</span> unindent=/home/trent/src/tiktoken/target/release/deps/libunindent-d53e2a0385a47a80.rmeta <span class="at">--cap-lints</span> allow <span class="at">--cfg</span> Py_3_7 <span class="at">--cfg</span> Py_3_8 <span class="at">--cfg</span> Py_3_9 <span class="at">--cfg</span> Py_3_10 <span class="at">--cfg</span> Py_3_11 <span class="at">--cfg</span> Py_3_12 <span class="at">--cfg</span> Py_3_13 <span class="at">--cfg</span> Py_GIL_DISABLED <span class="at">--cfg</span> rustc_has_once_lock <span class="at">--cfg</span> invalid_from_utf8_lint <span class="at">--cfg</span> c_str_lit <span class="at">--cfg</span> diagnostic_namespace <span class="at">--check-cfg</span> <span class="st">'cfg(Py_LIMITED_API)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_GIL_DISABLED)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(PyPy)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(GraalPy)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(py_sys_config, values("Py_DEBUG", "Py_REF_DEBUG", "Py_TRACE_REFS", "COUNT_ALLOCS"))'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(invalid_from_utf8_lint)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(pyo3_disable_reference_pool)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(pyo3_leak_on_drop_without_reference_pool)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(diagnostic_namespace)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(c_str_lit)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(rustc_has_once_lock)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_7)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_8)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_9)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_10)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_11)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_12)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(Py_3_13)'</span><span class="kw">`</span></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Dirty</span> tiktoken v0.8.0 <span class="er">(</span><span class="ex">/home/trent/src/tiktoken</span><span class="kw">)</span><span class="bu">:</span> the toolchain changed</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Compiling</span> tiktoken v0.8.0 <span class="er">(</span><span class="ex">/home/trent/src/tiktoken</span><span class="kw">)</span></span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">rustc</span> <span class="at">--crate-name</span> _tiktoken <span class="at">--edition</span><span class="op">=</span>2021 src/lib.rs <span class="at">--error-format</span><span class="op">=</span>json <span class="at">--json</span><span class="op">=</span>diagnostic-rendered-ansi,artifacts,future-incompat <span class="at">--diagnostic-width</span><span class="op">=</span>254 <span class="at">--crate-type</span> cdylib <span class="at">--emit</span><span class="op">=</span>dep-info,link <span class="at">-C</span> opt-level=3 <span class="at">-C</span> embed-bitcode=no <span class="at">--check-cfg</span> <span class="st">'cfg(docsrs)'</span> <span class="at">--check-cfg</span> <span class="st">'cfg(feature, values())'</span> <span class="at">-C</span> metadata=2d15c1d1b98ec97b <span class="at">--out-dir</span> /home/trent/src/tiktoken/target/release/deps <span class="at">-C</span> linker=/home/trent/mambaforge/envs/py313t/bin/x86_64-conda-linux-gnu-cc <span class="at">-C</span> strip=debuginfo <span class="at">-L</span> dependency=/home/trent/src/tiktoken/target/release/deps <span class="at">--extern</span> bstr=/home/trent/src/tiktoken/target/release/deps/libbstr-cc96e78f4e9fd97f.rlib <span class="at">--extern</span> fancy_regex=/home/trent/src/tiktoken/target/release/deps/libfancy_regex-2bd42caf041ad10c.rlib <span class="at">--extern</span> pyo3=/home/trent/src/tiktoken/target/release/deps/libpyo3-99d0b007138eadf4.rlib <span class="at">--extern</span> regex=/home/trent/src/tiktoken/target/release/deps/libregex-9ab83d1dbb2872e1.rlib <span class="at">--extern</span> rustc_hash=/home/trent/src/tiktoken/target/release/deps/librustc_hash-b006f4d81e95dfaf.rlib<span class="kw">`</span></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated method <span class="kw">`</span><span class="ex">pyo3::IntoPy::into_py</span><span class="kw">`</span>: <span class="kw">`</span><span class="ex">IntoPy</span><span class="kw">`</span> is going to be replaced by <span class="kw">`</span><span class="ex">IntoPyObject</span><span class="kw">`</span>. See the migration guide <span class="er">(</span><span class="ex">https://pyo3.rs/v0.23.0/migration</span><span class="kw">)</span> <span class="cf">for</span> more <span class="ex">information.</span></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:508:16</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a><span class="ex">508</span> <span class="kw">|</span>         <span class="ex">buffer.into_py</span><span class="er">(</span><span class="ex">py</span><span class="kw">)</span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                <span class="ex">^^^^^^^</span></span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>    <span class="ex">=</span> note: <span class="kw">`</span><span class="co">#[warn(deprecated)]</span><span class="kw">`</span> on by default</span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated associated function <span class="kw">`</span><span class="ex">pyo3::types::PyList::new_bound</span><span class="kw">`</span>: renamed to <span class="kw">`</span><span class="ex">PyList::new</span><span class="kw">`</span></span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:555:38</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a><span class="ex">555</span> <span class="kw">|</span>         <span class="bu">let</span> <span class="va">py_completions</span> <span class="op">=</span> <span class="va">PyList</span><span class="op">::</span><span class="va">new_bound</span><span class="er">(</span></span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                                      <span class="ex">^^^^^^^^^</span></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated associated function <span class="kw">`</span><span class="ex">pyo3::types::PyList::new_bound</span><span class="kw">`</span>: renamed to <span class="kw">`</span><span class="ex">PyList::new</span><span class="kw">`</span></span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:559:36</span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a><span class="ex">559</span> <span class="kw">|</span>                 <span class="ex">.map</span><span class="er">(</span><span class="kw">|</span><span class="fu">seq</span><span class="kw">|</span> <span class="ex">PyList::new_bound</span><span class="er">(</span><span class="ex">py,</span> <span class="kw">&amp;</span><span class="va">seq</span><span class="op">[</span>..<span class="op">]</span><span class="kw">))</span><span class="ex">,</span></span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                                    <span class="ex">^^^^^^^^^</span></span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated method <span class="kw">`</span><span class="ex">pyo3::IntoPy::into_py</span><span class="kw">`</span>: <span class="kw">`</span><span class="ex">IntoPy</span><span class="kw">`</span> is going to be replaced by <span class="kw">`</span><span class="ex">IntoPyObject</span><span class="kw">`</span>. See the migration guide <span class="er">(</span><span class="ex">https://pyo3.rs/v0.23.0/migration</span><span class="kw">)</span> <span class="cf">for</span> more <span class="ex">information.</span></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:561:34</span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a><span class="ex">561</span> <span class="kw">|</span>         <span class="kw">(</span><span class="ex">tokens,</span> py_completions<span class="kw">)</span><span class="ex">.into_py</span><span class="er">(</span><span class="ex">py</span><span class="kw">)</span></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                                  <span class="ex">^^^^^^^</span></span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated associated function <span class="kw">`</span><span class="ex">pyo3::types::PyBytes::new_bound</span><span class="kw">`</span>: renamed to <span class="kw">`</span><span class="ex">PyBytes::new</span><span class="kw">`</span></span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:589:38</span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a><span class="ex">589</span> <span class="kw">|</span>             <span class="ex">Ok</span><span class="er">(</span><span class="ex">bytes</span><span class="kw">)</span> <span class="ex">=</span><span class="op">&gt;</span> Ok<span class="er">(</span><span class="ex">PyBytes::new_bound</span><span class="er">(</span><span class="ex">py,</span> <span class="kw">&amp;</span><span class="ex">bytes</span><span class="kw">)</span><span class="fu">.into()</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                                      <span class="ex">^^^^^^^^^</span></span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated associated function <span class="kw">`</span><span class="ex">pyo3::types::PyBytes::new_bound</span><span class="kw">`</span>: renamed to <span class="kw">`</span><span class="ex">PyBytes::new</span><span class="kw">`</span></span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:596:32</span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a><span class="ex">596</span> <span class="kw">|</span>             <span class="cf">return</span> <span class="ex">Ok</span><span class="er">(</span><span class="ex">PyBytes::new_bound</span><span class="er">(</span><span class="ex">py,</span> bytes<span class="kw">)</span><span class="fu">.into()</span><span class="kw">);</span></span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                                <span class="ex">^^^^^^^^^</span></span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated associated function <span class="kw">`</span><span class="ex">pyo3::types::PyBytes::new_bound</span><span class="kw">`</span>: renamed to <span class="kw">`</span><span class="ex">PyBytes::new</span><span class="kw">`</span></span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:599:32</span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a><span class="ex">599</span> <span class="kw">|</span>             <span class="cf">return</span> <span class="ex">Ok</span><span class="er">(</span><span class="ex">PyBytes::new_bound</span><span class="er">(</span><span class="ex">py,</span> bytes<span class="kw">)</span><span class="fu">.into()</span><span class="kw">);</span></span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                                <span class="ex">^^^^^^^^^</span></span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated associated function <span class="kw">`</span><span class="ex">pyo3::types::PyBytes::new_bound</span><span class="kw">`</span>: renamed to <span class="kw">`</span><span class="ex">PyBytes::new</span><span class="kw">`</span></span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:611:31</span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a><span class="ex">611</span> <span class="kw">|</span>             <span class="ex">.map</span><span class="er">(</span><span class="kw">|</span><span class="ex">x</span><span class="kw">|</span> <span class="ex">PyBytes::new_bound</span><span class="er">(</span><span class="ex">py,</span> x<span class="kw">)</span><span class="fu">.into()</span><span class="kw">)</span></span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                               <span class="ex">^^^^^^^^^</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> <span class="kw">`</span><span class="ex">tiktoken</span><span class="kw">`</span> <span class="er">(</span><span class="ex">lib</span><span class="kw">)</span> <span class="ex">generated</span> 8 warnings</span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Finished</span> <span class="kw">`</span><span class="ex">release</span><span class="kw">`</span> profile <span class="pp">[</span><span class="ss">optimized</span><span class="pp">]</span> target<span class="er">(</span><span class="ex">s</span><span class="kw">)</span> <span class="er">in</span> <span class="ex">13.17s</span></span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a><span class="ex">Copying</span> rust artifact from target/release/lib_tiktoken.so to build/lib.linux-x86_64-cpython-313t/tiktoken/_tiktoken.cpython-313t-x86_64-linux-gnu.so</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">py313t</span><span class="kw">)</span> <span class="ex">{pytorch}</span> <span class="pp">[</span><span class="ss">12.6</span><span class="pp">]</span> [trent@dgx/ttypts/3<span class="er">(</span><span class="ex">~s/tiktoken</span><span class="kw">)</span><span class="ex">%]</span> python setup.py install</span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> install</span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/setuptools/_distutils/cmd.py:79:</span> SetuptoolsDeprecationWarning: setup.py install is deprecated.</span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a><span class="ex">!!</span></span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a>        <span class="ex">********************************************************************************</span></span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a>        <span class="ex">Please</span> avoid running <span class="kw">``</span>setup.py<span class="kw">``</span> directly.</span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>        <span class="ex">Instead,</span> use pypa/build, pypa/installer or other</span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>        <span class="ex">standards-based</span> tools.</span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a>        <span class="ex">See</span> https://blog.ganssle.io/articles/2021/10/setup-py-deprecated.html for details.</span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a>        <span class="ex">********************************************************************************</span></span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a><span class="ex">!!</span></span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">self.initialize_options()</span></span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> build</span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> build_py</span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/_educational.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/__init__.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/registry.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/model.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/load.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/core.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken_ext/openai_public.py <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken_ext</span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> egg_info</span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a><span class="ex">writing</span> tiktoken.egg-info/PKG-INFO</span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a><span class="ex">writing</span> dependency_links to tiktoken.egg-info/dependency_links.txt</span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a><span class="ex">writing</span> requirements to tiktoken.egg-info/requires.txt</span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a><span class="ex">writing</span> top-level names to tiktoken.egg-info/top_level.txt</span>
<span id="cb5-183"><a href="#cb5-183" aria-hidden="true" tabindex="-1"></a><span class="ex">reading</span> manifest file <span class="st">'tiktoken.egg-info/SOURCES.txt'</span></span>
<span id="cb5-184"><a href="#cb5-184" aria-hidden="true" tabindex="-1"></a><span class="ex">reading</span> manifest template <span class="st">'MANIFEST.in'</span></span>
<span id="cb5-185"><a href="#cb5-185" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> no files found matching <span class="st">'Makefile'</span></span>
<span id="cb5-186"><a href="#cb5-186" aria-hidden="true" tabindex="-1"></a><span class="ex">adding</span> license file <span class="st">'LICENSE'</span></span>
<span id="cb5-187"><a href="#cb5-187" aria-hidden="true" tabindex="-1"></a><span class="ex">writing</span> manifest file <span class="st">'tiktoken.egg-info/SOURCES.txt'</span></span>
<span id="cb5-188"><a href="#cb5-188" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> tiktoken/py.typed <span class="at">-</span><span class="op">&gt;</span> build/lib.linux-x86_64-cpython-313t/tiktoken</span>
<span id="cb5-189"><a href="#cb5-189" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> build_ext</span>
<span id="cb5-190"><a href="#cb5-190" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> build_rust</span>
<span id="cb5-191"><a href="#cb5-191" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> rustc <span class="at">--lib</span> <span class="at">--message-format</span><span class="op">=</span>json-render-diagnostics <span class="at">--manifest-path</span> Cargo.toml <span class="at">--release</span> <span class="at">-v</span> <span class="at">--features</span> pyo3/extension-module <span class="at">--crate-type</span> cdylib <span class="at">--</span></span>
<span id="cb5-192"><a href="#cb5-192" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> target-lexicon v0.12.16</span>
<span id="cb5-193"><a href="#cb5-193" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> unicode-ident v1.0.14</span>
<span id="cb5-194"><a href="#cb5-194" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> memchr v2.7.4</span>
<span id="cb5-195"><a href="#cb5-195" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> regex-syntax v0.8.5</span>
<span id="cb5-196"><a href="#cb5-196" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> autocfg v1.4.0</span>
<span id="cb5-197"><a href="#cb5-197" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> aho-corasick v1.1.3</span>
<span id="cb5-198"><a href="#cb5-198" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> heck v0.5.0</span>
<span id="cb5-199"><a href="#cb5-199" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> bit-vec v0.6.3</span>
<span id="cb5-200"><a href="#cb5-200" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> indoc v2.0.5</span>
<span id="cb5-201"><a href="#cb5-201" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> cfg-if v1.0.0</span>
<span id="cb5-202"><a href="#cb5-202" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> once_cell v1.20.2</span>
<span id="cb5-203"><a href="#cb5-203" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> unindent v0.2.3</span>
<span id="cb5-204"><a href="#cb5-204" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> rustc-hash v1.1.0</span>
<span id="cb5-205"><a href="#cb5-205" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> proc-macro2 v1.0.92</span>
<span id="cb5-206"><a href="#cb5-206" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> regex-automata v0.4.9</span>
<span id="cb5-207"><a href="#cb5-207" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> libc v0.2.169</span>
<span id="cb5-208"><a href="#cb5-208" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> bit-set v0.5.3</span>
<span id="cb5-209"><a href="#cb5-209" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> pyo3-build-config v0.23.3</span>
<span id="cb5-210"><a href="#cb5-210" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> quote v1.0.38</span>
<span id="cb5-211"><a href="#cb5-211" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> memoffset v0.9.1</span>
<span id="cb5-212"><a href="#cb5-212" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> bstr v1.11.3</span>
<span id="cb5-213"><a href="#cb5-213" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> fancy-regex v0.13.0</span>
<span id="cb5-214"><a href="#cb5-214" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> regex v1.11.1</span>
<span id="cb5-215"><a href="#cb5-215" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> syn v2.0.95</span>
<span id="cb5-216"><a href="#cb5-216" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> pyo3-macros-backend v0.23.3</span>
<span id="cb5-217"><a href="#cb5-217" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> pyo3-ffi v0.23.3</span>
<span id="cb5-218"><a href="#cb5-218" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> pyo3-macros v0.23.3</span>
<span id="cb5-219"><a href="#cb5-219" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> pyo3 v0.23.3</span>
<span id="cb5-220"><a href="#cb5-220" aria-hidden="true" tabindex="-1"></a>       <span class="ex">Fresh</span> tiktoken v0.8.0 <span class="er">(</span><span class="ex">/home/trent/src/tiktoken</span><span class="kw">)</span></span>
<span id="cb5-221"><a href="#cb5-221" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated method <span class="kw">`</span><span class="ex">pyo3::IntoPy::into_py</span><span class="kw">`</span>: <span class="kw">`</span><span class="ex">IntoPy</span><span class="kw">`</span> is going to be replaced by <span class="kw">`</span><span class="ex">IntoPyObject</span><span class="kw">`</span>. See the migration guide <span class="er">(</span><span class="ex">https://pyo3.rs/v0.23.0/migration</span><span class="kw">)</span> <span class="cf">for</span> more <span class="ex">information.</span></span>
<span id="cb5-222"><a href="#cb5-222" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:508:16</span>
<span id="cb5-223"><a href="#cb5-223" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-224"><a href="#cb5-224" aria-hidden="true" tabindex="-1"></a><span class="ex">508</span> <span class="kw">|</span>         <span class="ex">buffer.into_py</span><span class="er">(</span><span class="ex">py</span><span class="kw">)</span></span>
<span id="cb5-225"><a href="#cb5-225" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                <span class="ex">^^^^^^^</span></span>
<span id="cb5-226"><a href="#cb5-226" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-227"><a href="#cb5-227" aria-hidden="true" tabindex="-1"></a>    <span class="ex">=</span> note: <span class="kw">`</span><span class="co">#[warn(deprecated)]</span><span class="kw">`</span> on by default</span>
<span id="cb5-228"><a href="#cb5-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-229"><a href="#cb5-229" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated associated function <span class="kw">`</span><span class="ex">pyo3::types::PyList::new_bound</span><span class="kw">`</span>: renamed to <span class="kw">`</span><span class="ex">PyList::new</span><span class="kw">`</span></span>
<span id="cb5-230"><a href="#cb5-230" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:555:38</span>
<span id="cb5-231"><a href="#cb5-231" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-232"><a href="#cb5-232" aria-hidden="true" tabindex="-1"></a><span class="ex">555</span> <span class="kw">|</span>         <span class="bu">let</span> <span class="va">py_completions</span> <span class="op">=</span> <span class="va">PyList</span><span class="op">::</span><span class="va">new_bound</span><span class="er">(</span></span>
<span id="cb5-233"><a href="#cb5-233" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                                      <span class="ex">^^^^^^^^^</span></span>
<span id="cb5-234"><a href="#cb5-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-235"><a href="#cb5-235" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated associated function <span class="kw">`</span><span class="ex">pyo3::types::PyList::new_bound</span><span class="kw">`</span>: renamed to <span class="kw">`</span><span class="ex">PyList::new</span><span class="kw">`</span></span>
<span id="cb5-236"><a href="#cb5-236" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:559:36</span>
<span id="cb5-237"><a href="#cb5-237" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-238"><a href="#cb5-238" aria-hidden="true" tabindex="-1"></a><span class="ex">559</span> <span class="kw">|</span>                 <span class="ex">.map</span><span class="er">(</span><span class="kw">|</span><span class="fu">seq</span><span class="kw">|</span> <span class="ex">PyList::new_bound</span><span class="er">(</span><span class="ex">py,</span> <span class="kw">&amp;</span><span class="va">seq</span><span class="op">[</span>..<span class="op">]</span><span class="kw">))</span><span class="ex">,</span></span>
<span id="cb5-239"><a href="#cb5-239" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                                    <span class="ex">^^^^^^^^^</span></span>
<span id="cb5-240"><a href="#cb5-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-241"><a href="#cb5-241" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated method <span class="kw">`</span><span class="ex">pyo3::IntoPy::into_py</span><span class="kw">`</span>: <span class="kw">`</span><span class="ex">IntoPy</span><span class="kw">`</span> is going to be replaced by <span class="kw">`</span><span class="ex">IntoPyObject</span><span class="kw">`</span>. See the migration guide <span class="er">(</span><span class="ex">https://pyo3.rs/v0.23.0/migration</span><span class="kw">)</span> <span class="cf">for</span> more <span class="ex">information.</span></span>
<span id="cb5-242"><a href="#cb5-242" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:561:34</span>
<span id="cb5-243"><a href="#cb5-243" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-244"><a href="#cb5-244" aria-hidden="true" tabindex="-1"></a><span class="ex">561</span> <span class="kw">|</span>         <span class="kw">(</span><span class="ex">tokens,</span> py_completions<span class="kw">)</span><span class="ex">.into_py</span><span class="er">(</span><span class="ex">py</span><span class="kw">)</span></span>
<span id="cb5-245"><a href="#cb5-245" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                                  <span class="ex">^^^^^^^</span></span>
<span id="cb5-246"><a href="#cb5-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-247"><a href="#cb5-247" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated associated function <span class="kw">`</span><span class="ex">pyo3::types::PyBytes::new_bound</span><span class="kw">`</span>: renamed to <span class="kw">`</span><span class="ex">PyBytes::new</span><span class="kw">`</span></span>
<span id="cb5-248"><a href="#cb5-248" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:589:38</span>
<span id="cb5-249"><a href="#cb5-249" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-250"><a href="#cb5-250" aria-hidden="true" tabindex="-1"></a><span class="ex">589</span> <span class="kw">|</span>             <span class="ex">Ok</span><span class="er">(</span><span class="ex">bytes</span><span class="kw">)</span> <span class="ex">=</span><span class="op">&gt;</span> Ok<span class="er">(</span><span class="ex">PyBytes::new_bound</span><span class="er">(</span><span class="ex">py,</span> <span class="kw">&amp;</span><span class="ex">bytes</span><span class="kw">)</span><span class="fu">.into()</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb5-251"><a href="#cb5-251" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                                      <span class="ex">^^^^^^^^^</span></span>
<span id="cb5-252"><a href="#cb5-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-253"><a href="#cb5-253" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated associated function <span class="kw">`</span><span class="ex">pyo3::types::PyBytes::new_bound</span><span class="kw">`</span>: renamed to <span class="kw">`</span><span class="ex">PyBytes::new</span><span class="kw">`</span></span>
<span id="cb5-254"><a href="#cb5-254" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:596:32</span>
<span id="cb5-255"><a href="#cb5-255" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-256"><a href="#cb5-256" aria-hidden="true" tabindex="-1"></a><span class="ex">596</span> <span class="kw">|</span>             <span class="cf">return</span> <span class="ex">Ok</span><span class="er">(</span><span class="ex">PyBytes::new_bound</span><span class="er">(</span><span class="ex">py,</span> bytes<span class="kw">)</span><span class="fu">.into()</span><span class="kw">);</span></span>
<span id="cb5-257"><a href="#cb5-257" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                                <span class="ex">^^^^^^^^^</span></span>
<span id="cb5-258"><a href="#cb5-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-259"><a href="#cb5-259" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated associated function <span class="kw">`</span><span class="ex">pyo3::types::PyBytes::new_bound</span><span class="kw">`</span>: renamed to <span class="kw">`</span><span class="ex">PyBytes::new</span><span class="kw">`</span></span>
<span id="cb5-260"><a href="#cb5-260" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:599:32</span>
<span id="cb5-261"><a href="#cb5-261" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-262"><a href="#cb5-262" aria-hidden="true" tabindex="-1"></a><span class="ex">599</span> <span class="kw">|</span>             <span class="cf">return</span> <span class="ex">Ok</span><span class="er">(</span><span class="ex">PyBytes::new_bound</span><span class="er">(</span><span class="ex">py,</span> bytes<span class="kw">)</span><span class="fu">.into()</span><span class="kw">);</span></span>
<span id="cb5-263"><a href="#cb5-263" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                                <span class="ex">^^^^^^^^^</span></span>
<span id="cb5-264"><a href="#cb5-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-265"><a href="#cb5-265" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> use of deprecated associated function <span class="kw">`</span><span class="ex">pyo3::types::PyBytes::new_bound</span><span class="kw">`</span>: renamed to <span class="kw">`</span><span class="ex">PyBytes::new</span><span class="kw">`</span></span>
<span id="cb5-266"><a href="#cb5-266" aria-hidden="true" tabindex="-1"></a>   <span class="ex">--</span><span class="op">&gt;</span> src/lib.rs:611:31</span>
<span id="cb5-267"><a href="#cb5-267" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb5-268"><a href="#cb5-268" aria-hidden="true" tabindex="-1"></a><span class="ex">611</span> <span class="kw">|</span>             <span class="ex">.map</span><span class="er">(</span><span class="kw">|</span><span class="ex">x</span><span class="kw">|</span> <span class="ex">PyBytes::new_bound</span><span class="er">(</span><span class="ex">py,</span> x<span class="kw">)</span><span class="fu">.into()</span><span class="kw">)</span></span>
<span id="cb5-269"><a href="#cb5-269" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>                               <span class="ex">^^^^^^^^^</span></span>
<span id="cb5-270"><a href="#cb5-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-271"><a href="#cb5-271" aria-hidden="true" tabindex="-1"></a><span class="ex">warning:</span> <span class="kw">`</span><span class="ex">tiktoken</span><span class="kw">`</span> <span class="er">(</span><span class="ex">lib</span><span class="kw">)</span> <span class="ex">generated</span> 8 warnings</span>
<span id="cb5-272"><a href="#cb5-272" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Finished</span> <span class="kw">`</span><span class="ex">release</span><span class="kw">`</span> profile <span class="pp">[</span><span class="ss">optimized</span><span class="pp">]</span> target<span class="er">(</span><span class="ex">s</span><span class="kw">)</span> <span class="er">in</span> <span class="ex">0.03s</span></span>
<span id="cb5-273"><a href="#cb5-273" aria-hidden="true" tabindex="-1"></a><span class="ex">Copying</span> rust artifact from target/release/lib_tiktoken.so to build/lib.linux-x86_64-cpython-313t/tiktoken/_tiktoken.cpython-313t-x86_64-linux-gnu.so</span>
<span id="cb5-274"><a href="#cb5-274" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> install_lib</span>
<span id="cb5-275"><a href="#cb5-275" aria-hidden="true" tabindex="-1"></a><span class="ex">creating</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken_ext</span>
<span id="cb5-276"><a href="#cb5-276" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> build/lib.linux-x86_64-cpython-313t/tiktoken_ext/openai_public.py <span class="at">-</span><span class="op">&gt;</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken_ext</span>
<span id="cb5-277"><a href="#cb5-277" aria-hidden="true" tabindex="-1"></a><span class="ex">creating</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken</span>
<span id="cb5-278"><a href="#cb5-278" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> build/lib.linux-x86_64-cpython-313t/tiktoken/_educational.py <span class="at">-</span><span class="op">&gt;</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken</span>
<span id="cb5-279"><a href="#cb5-279" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> build/lib.linux-x86_64-cpython-313t/tiktoken/__init__.py <span class="at">-</span><span class="op">&gt;</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken</span>
<span id="cb5-280"><a href="#cb5-280" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> build/lib.linux-x86_64-cpython-313t/tiktoken/py.typed <span class="at">-</span><span class="op">&gt;</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken</span>
<span id="cb5-281"><a href="#cb5-281" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> build/lib.linux-x86_64-cpython-313t/tiktoken/registry.py <span class="at">-</span><span class="op">&gt;</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken</span>
<span id="cb5-282"><a href="#cb5-282" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> build/lib.linux-x86_64-cpython-313t/tiktoken/model.py <span class="at">-</span><span class="op">&gt;</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken</span>
<span id="cb5-283"><a href="#cb5-283" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> build/lib.linux-x86_64-cpython-313t/tiktoken/load.py <span class="at">-</span><span class="op">&gt;</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken</span>
<span id="cb5-284"><a href="#cb5-284" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> build/lib.linux-x86_64-cpython-313t/tiktoken/_tiktoken.cpython-313t-x86_64-linux-gnu.so <span class="at">-</span><span class="op">&gt;</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken</span>
<span id="cb5-285"><a href="#cb5-285" aria-hidden="true" tabindex="-1"></a><span class="ex">copying</span> build/lib.linux-x86_64-cpython-313t/tiktoken/core.py <span class="at">-</span><span class="op">&gt;</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken</span>
<span id="cb5-286"><a href="#cb5-286" aria-hidden="true" tabindex="-1"></a><span class="ex">byte-compiling</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken_ext/openai_public.py to openai_public.cpython-313.pyc</span>
<span id="cb5-287"><a href="#cb5-287" aria-hidden="true" tabindex="-1"></a><span class="ex">byte-compiling</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken/_educational.py to _educational.cpython-313.pyc</span>
<span id="cb5-288"><a href="#cb5-288" aria-hidden="true" tabindex="-1"></a><span class="ex">byte-compiling</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken/__init__.py to __init__.cpython-313.pyc</span>
<span id="cb5-289"><a href="#cb5-289" aria-hidden="true" tabindex="-1"></a><span class="ex">byte-compiling</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken/registry.py to registry.cpython-313.pyc</span>
<span id="cb5-290"><a href="#cb5-290" aria-hidden="true" tabindex="-1"></a><span class="ex">byte-compiling</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken/model.py to model.cpython-313.pyc</span>
<span id="cb5-291"><a href="#cb5-291" aria-hidden="true" tabindex="-1"></a><span class="ex">byte-compiling</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken/load.py to load.cpython-313.pyc</span>
<span id="cb5-292"><a href="#cb5-292" aria-hidden="true" tabindex="-1"></a><span class="ex">byte-compiling</span> /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken/core.py to core.cpython-313.pyc</span>
<span id="cb5-293"><a href="#cb5-293" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> install_egg_info</span>
<span id="cb5-294"><a href="#cb5-294" aria-hidden="true" tabindex="-1"></a><span class="ex">Copying</span> tiktoken.egg-info to /home/trent/mambaforge/envs/py313t/lib/python3.13t/site-packages/tiktoken-0.8.0-py3.13.egg-info</span>
<span id="cb5-295"><a href="#cb5-295" aria-hidden="true" tabindex="-1"></a><span class="ex">running</span> install_scripts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>After this, you should be able to import the <code>tiktoken</code> module in Python:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> cd ..</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> python <span class="at">-Xgil</span><span class="op">=</span>0</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Python</span> 3.13.1 experimental free-threading build <span class="kw">|</span> <span class="ex">packaged</span> by conda-forge <span class="kw">|</span> <span class="kw">(</span><span class="ex">main,</span> Jan 13 2025, 09:59:40<span class="kw">)</span> <span class="ex">[GCC</span> 13.3.0] on linux</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Type</span> <span class="st">"help"</span>, <span class="st">"copyright"</span>, <span class="st">"credits"</span> or <span class="st">"license"</span> for more information.</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">tiktoken</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="torch" class="level4">
<h4 class="anchored" data-anchor-id="torch">Torch</h4>
<p>Install PyTorch 2.6 via <code>pip</code> with the conda <code>py313t</code> environment active:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> conda activate py313t</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> pip install torch==2.6 <span class="at">--index-url</span> https://download.pytorch.org/whl/cu126</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you have trouble installing PyTorch, consult their <a href="https://pytorch.org/get-started/locally/">Getting Started</a> guide.</p>
<p>You can verify torch installed correctly as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> python <span class="at">-Xgil</span><span class="op">=</span>0</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Python</span> 3.13.1 experimental free-threading build <span class="kw">|</span> <span class="ex">packaged</span> by conda-forge <span class="kw">|</span> <span class="kw">(</span><span class="ex">main,</span> Jan 13 2025, 09:59:40<span class="kw">)</span> <span class="ex">[GCC</span> 13.3.0] on linux</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Type</span> <span class="st">"help"</span>, <span class="st">"copyright"</span>, <span class="st">"credits"</span> or <span class="st">"license"</span> for more information.</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">torch</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> torch.cuda.is_available<span class="kw">()</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="ex">True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="ipython-kernel" class="level4">
<h4 class="anchored" data-anchor-id="ipython-kernel">IPython Kernel</h4>
<p>Installing IPython Kernel allows us to use our free-threaded Python installation via the Jupyter Lab instance we install in the <code>py313</code> environment.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate py313t</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install ipykernel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Once <code>ipykernel</code> is installed, run the following:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> python3.13t <span class="at">-m</span> ipykernel <span class="at">--install</span> <span class="at">--name</span> py313t <span class="at">--user</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Installed</span> kernelspec py313t in /home/trent/.local/share/jupyter/kernels/py313t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This will install a kernel configuration file, <code>kernel.json</code>, which we need to tweak by adding the <code>-Xgil=0</code> startup flag to the Python interpreter:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> cd ~/.local/jupyter/share/kernels/py313t</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> cp kernel.json kernel.json.orig</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> vi kernel.json</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Edit kernel.json to make it look like the diff below.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> diff <span class="at">-u</span> kernel.json.orig kernel.json</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode diff code-with-copy"><code class="sourceCode diff"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">--- kernel.json.orig    2025-02-04 15:02:21.814112004 -0800</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="dt">+++ kernel.json 2025-02-04 15:02:36.553806199 -0800</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="dt">@@ -1,6 +1,7 @@</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a> {</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  "argv": [</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>   "/home/trent/mambaforge/envs/py313t/bin/python3.13t",</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="va">+  "-Xgil=0",</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>   "-Xfrozen_modules=off",</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>   "-m",</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>   "ipykernel_launcher",</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="dt">@@ -12,4 +13,4 @@</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  "metadata": {</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>   "debugger": true</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="hidden">
<p>(Hidden for now as we removed the immediate need for <code>datrie</code> by fixing the HTTP server routing logic.)</p>
<section id="datrie-and-cython" class="level4">
<h4 class="anchored" data-anchor-id="datrie-and-cython">Datrie and Cython</h4>
<p><a href="https://github.com/pytries/datrie">datrie</a> is a Python library that provides a <em>trie</em> (or <em>digital search tree</em>) data structure by way of the <a href="https://linux.thai.net/~thep/datrie/datrie.html">libdatrie</a> C library. The Python <code>datrie</code> library isn’t strictly necessary to run <code>parallelopedia.gpt2</code>, but other components rely on it, so it’s handy to get installed now, if possible.</p>
<p>It relies upon Cython, and thus, for now, you need to install a free-threaded compatible version of Cython first, as follows:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate py313t</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install git+https://github.com/cython/cython</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then, clone the <code>datrie</code> repo and install as follows:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate py313t</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/pytries/datrie <span class="at">--recursive</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> datrie</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> setup.py build</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> setup.py install</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If everything goes well, you should see something like this when you launch Python and import <code>datrie</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> python</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Python</span> 3.13.1 experimental free-threading build <span class="kw">|</span> <span class="ex">packaged</span> by conda-forge <span class="kw">|</span> <span class="kw">(</span><span class="ex">main,</span> Jan 13 2025, 09:59:40<span class="kw">)</span> <span class="ex">[GCC</span> 13.3.0] on linux</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Type</span> <span class="st">"help"</span>, <span class="st">"copyright"</span>, <span class="st">"credits"</span> or <span class="st">"license"</span> for more information.</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">datrie</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</div>
</section>
</section>
<section id="normal-3.13-env-py313" class="level3">
<h3 class="anchored" data-anchor-id="normal-3.13-env-py313">Normal 3.13 Env (py313)</h3>
<p>The second <code>py313</code> environment is almost identical to <code>py313t</code>, except it is not a <code>python-freethreading</code> installation, and, additionally, we install Jupyter Lab. We can install <code>tiktoken</code> directly via <code>pip</code>, so we don’t need the supporting Rust cruft.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">-n</span> py313 python=3.13 <span class="dt">\</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    nodejs pip tqdm flake8 jupyterlab requests <span class="dt">\</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">-c</span> conda-forge</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate py313</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install numpy tiktoken safetensors</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install torch==2.6 <span class="at">--index-url</span> https://download.pytorch.org/whl/cu126</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="parallelopedia" class="level2">
<h2 class="anchored" data-anchor-id="parallelopedia">Parallelopedia</h2>
<p>All of the code in this article is available in the <a href="https://github.com/tpn/parallelopedia">Parallelopedia</a> repository on Github. The code we’ll be focusing on in this post lives in the <a href="https://github.com/tpn/parallelopedia/blob/main/src/parallelopedia/gpt2.py">parallelopedia.gpt2</a> module.</p>
<p>There is also a web user interface component named <a href="https://github.com/tpn/parallelopedia-ui">Parallelopedia-UI</a>, which we will use later in the post.</p>
<p>Clone the repositories as follows:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> git clone https://github.com/tpn/parallelopedia</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> git clone https://github.com/tpn/parallelopedia-ui</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="env-vars callout callout-style-default callout-important callout-titled" title="Important Environment Variables">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important Environment Variables
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The code and command examples in this post will assume you’ve added the <code>src</code> directory to your <code>PYTHONPATH</code>, the <code>bin</code> directory to your <code>PATH</code>, and set the <code>PARALLELOPEDIA_ROOT</code> environment variable to the root of the repository. You can do this as follows:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> parallelopedia</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">PYTHONPATH</span><span class="op">=</span><span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span>/src:<span class="va">$PYTHONPATH</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">PATH</span><span class="op">=</span><span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span>/bin:<span class="va">$PATH</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">PARALLELOPEDIA_ROOT</span><span class="op">=</span><span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ..</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> parallelopedia-ui</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">PARALLELOPEDIA_UI</span><span class="op">=</span><span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It is recommended that you add these to your shell. For me, using zsh, I use the following:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">PARALLELOPEDIA_ROOT</span><span class="op">=</span><span class="pp">~</span>s1/parallelopedia</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">PARALLELOPEDIA_UI</span><span class="op">=</span><span class="pp">~</span>s1/parallelopedia-ui</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">PYTHONPATH</span><span class="op">=</span><span class="va">$PARALLELOPEDIA_ROOT</span>/src:<span class="va">$PYTHONPATH</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">PATH</span><span class="op">=</span><span class="va">$PARALLELOPEDIA_ROOT</span>/bin:<span class="va">$PATH</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>You can perform a quick sanity check that things are working as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> python <span class="at">-Xgil</span><span class="op">=</span>0 <span class="at">-m</span> parallelopedia.http.server <span class="at">--help</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="ex">usage:</span> server.py <span class="pp">[-</span><span class="ss">h</span><span class="pp">]</span> [--ip IP] [--port PORT] <span class="pp">[--</span><span class="ss">debug</span><span class="pp">]</span> [--log-level <span class="dt">{DEBUG</span><span class="op">,</span><span class="dt">INFO</span><span class="op">,</span><span class="dt">WARNING</span><span class="op">,</span><span class="dt">ERROR</span><span class="op">,</span><span class="dt">CRITICAL}</span>] [--threads THREADS] [--protocol-class PROTOCOL_CLASS] [--app-classes APP_CLASSES [APP_CLASSES ...]] [--listen-backlog LISTEN_BACKLOG]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Run</span> the HTTP server.</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="ex">options:</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="ex">-h,</span> <span class="at">--help</span>            show this help message and exit</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--ip</span> IP               IP address to bind the server to.</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--port</span> PORT           Port number to bind the server to.</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--debug</span>               Enable debug mode for asyncio.</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--log-level</span> <span class="dt">{DEBUG</span><span class="op">,</span><span class="dt">INFO</span><span class="op">,</span><span class="dt">WARNING</span><span class="op">,</span><span class="dt">ERROR</span><span class="op">,</span><span class="dt">CRITICAL}</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                        <span class="ex">Set</span> the logging level.</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--threads</span> THREADS     Number of threads to use.</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--protocol-class</span> PROTOCOL_CLASS</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                        <span class="ex">The</span> protocol class to use for the server.</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--app-classes</span> APP_CLASSES [APP_CLASSES ...]</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                        <span class="ex">Space-separated</span> list of HTTP application classes.</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--listen-backlog</span> LISTEN_BACKLOG</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                        <span class="ex">The</span> listen backlog for the server.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</div>
</div>
</div>
</section>
<section id="pytorch-and-llm-crash-course" class="level1">
<h1>PyTorch and LLM Crash Course</h1>
<p>My involvement with PyTorch and Large Language Models (LLMs) started around late November last year, 2024. Going in, I knew nothing about PyTorch, nor deep neural networks, nor LLMs—other than having enjoyed using LLMs thoroughly the past couple of years. I had never trained an AI model of any kind. I did have a bit of NumPy and data science exposure up my sleeve, plus general familiarity with Python.</p>
<p>Thanks to <a href="https://karpathy.ai/">Andrej Karpathy</a>’s phenomenal YouTube series on deep neural networks and LLMs titled <a href="https://www.youtube.com/playlist?list=PLAqhIrjkxbuWI23v9cThsA9GvCAUhRvKZ">Neural Networks: From Zero to Hero</a>, over the course of about 3 weeks or so I went from zero to… well I wouldn’t necessarily say <em>hero</em>—perhaps zero to <em>not-completley-clueless</em> is more apropos.</p>
<p>Andrej’s content is a fantastic resource to learn everything you need to know to understand how modern LLMs work from the ground-up. It’s not a short series—there are 19 hours, 21 minutes and two seconds of content across ten videos—and you’ll probably spend double that if you <em>really</em> want to properly absorb the content.</p>
<p>None of the work presented in this post would have been possible had I not invested the time in Andrej’s series. If you’re reading this Andrej, thanks, and keep up the brilliant work!</p>
<section id="training-gpt-2-124m-locally" class="level2">
<h2 class="anchored" data-anchor-id="training-gpt-2-124m-locally">Training GPT-2 (124M) Locally</h2>
<p>Equipped with my new knowledge about LLMs, PyTorch, and, thanks to Andrej’s final video in the series titled <a href="https://www.youtube.com/watch?v=l8pRSuU81PU&amp;list=PLAqhIrjkxbuWI23v9cThsA9GvCAUhRvKZ&amp;index=10&amp;t=1286s&amp;pp=iAQB">Let’s reproduce GPT-2 (124M)</a> and the accompanying <a href="https://github.com/karpathy/build-nanogpt">build-nanogpt</a> Github repo, I was able to train a local GPT-2 model via PyTorch, from scratch, using the <a href="https://huggingface.co/rhysjones/gpt2-124M-edu-fineweb-10B">edu_fineweb10B</a> dataset.</p>
<p>I only had to make one change in order to run locally: <a href="https://github.com/tpn/build-nanogpt/commit/0069c4a35d1a362c1fd50f9f5bce00a170e15904">Use 8 for micro batch size instead of 64</a>. With that change in place, I was able to train GPT-2 from scratch as follows:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> conda activate py313</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> git clone gh:tpn/build-nanogpt</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> cd build-nanogpt</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the fineweb dataset.</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> python fineweb.py</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Train!</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> torchrun <span class="at">--standalone</span> <span class="at">--nproc_per_node</span><span class="op">=</span>4 train_gpt2.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This was run on an NVIDIA DGX workstation from 2017, which has an Intel Xeon(R) CPU E5-2698 v4 @ 2.20GHz (20 cores, 40 threads), and four Tesla V100-DGXS-32GB GPUs.</p>
<p>Training in parallel across all four GPUs yielded around 36,000 tokens/sec, with an average time of about 14.5 seconds per loop iteration. Training took about 3 days and 5 hours for 19,072 steps. All four GPUs were pegged close to their 300W power limit for those three days.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Amusingly, well after the fact, I decided to see what kind of training performance I’d get on my Windows 11 gaming box (via WSL2 and Ubuntu 22.04), which has an AMD Ryzen 9 7950X3D (16 cores, 32 threads) and NVIDIA RTX 4090. Training via <code>python train_gpt2.py</code> (<code>torchrun</code> wasn’t needed as I wasn’t using multiple GPUs) yielded about 125,000 tokens/sec, and the loop iteration time averaged about 4.2 seconds.</p>
<p>On my work Windows 11 box, which has an Intel Core i9-14900K (24 cores, 32 threads) and NVIDIA RTX 5090, I got about 195,000 tokens/sec, and the loop iteration averaged about 2.7 seconds.</p>
<p>So training 19,072 steps on my 5090 box would have taken around ~14 hours or so, and, at the very least, would have reduced my electricity bill for that month by a decent bit :-)</p>
</div>
</div>
<p>Once training completes, a <code>log/model_19072.pt</code> file is produced, which is the checkpoint of the model at that final step, obtained via a call to <code>torch.save()</code>. The model has 124M parameters—which is tiny by modern standards—and is just under 500MB on disk.</p>
<p>You can download that very model I trained via the HuggingFace dataset I set up here: <a href="https://huggingface.co/datasets/trentnelson/parallelopedia-data-gpt2/blob/main/model_19072.pt">model_19072.pt</a>. Once downloaded, place the file in <code>$PARALLELOPEDIA_ROOT/data</code>; alternatively, if you run the Jupyter Notebook below, it’ll automatically download the model from HuggingFace on first run.</p>
</section>
</section>
<section id="pytorch-gpt-2-implementation" class="level1">
<h1>PyTorch GPT-2 Implementation</h1>
<p>Let’s introduce the first version of the Python code we’re going to use. Again, all of this has been made possible thanks to Andrej Karpathy’s work with his <a href="https://www.youtube.com/watch?v=l8pRSuU81PU&amp;list=PLAqhIrjkxbuWI23v9cThsA9GvCAUhRvKZ&amp;index=10&amp;t=1286s&amp;pp=iAQB">YouTube series</a> and <a href="https://github.com/karpathy/build-nanogpt">build-nanogpt</a> repo, so any and all code you see in this post can typically be traced back to something equivalent that appears in <a href="https://github.com/karpathy/build-nanogpt/blob/master/train_gpt2.py">train_gpt2.py</a>. None of this code would have made any sense to me a month or two ago—but I can promise you that if you devote sufficient time to watching and understanding the entire series, you’ll have a comprehensive understanding of all of the pieces present in this post.</p>
<p>You can follow along in a Jupyter Lab notebook if you activate the <code>py313</code> environment and launch <code>jupyter lab</code>. If you correctly registered your <code>py313t</code> kernel per the instructions earlier, you should see an option when creating a new notebook to use the <code>py313t</code> Python kernel, which will be the free-threaded version. On the right of this page you should see all of the notebooks referenced.</p>
<section id="initial-implementation" class="level2">
<h2 class="anchored" data-anchor-id="initial-implementation">Initial Implementation</h2>
<p>The code below roughly corresponds to my first version of the code in the commit <a href="https://github.com/tpn/parallelopedia/blob/3ed4fe60a767a12b31fca183fed00fef43c65827/src/parallelopedia/gpt2.py">3ed4fe6: Add gpt2.py</a>, with some formatting and style tweaks to ensure the code is viewable on mobile devices without requiring horizontal scrolling.</p>
<p>We’ll revise this code later in the post, but for now, it’s a good starting point to get a feel for how we can use PyTorch to load a GPT-2 model checkpoint, tokenize some input text, and generate some output text.</p>
<div id="initial-model-setup-code">
<div class="quarto-embed-nb-cell">
<div id="gpt2-v1-setup" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gpt2_v1.ipynb</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Imports</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dataclasses</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> os.path <span class="im">import</span> join, exists</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> textwrap</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> textwrap <span class="im">import</span> wrap</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tiktoken</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.nn <span class="im">import</span> functional <span class="im">as</span> F</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper Timer Class</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ElapsedTimer:</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="co">    Context manager and reusable timer to measure elapsed time.</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="co">        timer = elapsed_timer()</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="co">        with timer:</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="co">            do_something()</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="co">        print(f'Elapsed: {timer.elapsed:.3f}')</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="co">        # Re-enterable:</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="co">        with timer:</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a><span class="co">            do_something_else()</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="co">        print(f'Elapsed: {timer.elapsed:.3f}')</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.start <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._elapsed <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__enter__</span>(<span class="va">self</span>):</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.start <span class="op">=</span> time.perf_counter()</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__exit__</span>(<span class="va">self</span>, exc_type, exc_value, traceback):</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._elapsed <span class="op">=</span> time.perf_counter() <span class="op">-</span> <span class="va">self</span>.start</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> elapsed(<span class="va">self</span>):</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a><span class="co">        Return the elapsed time for the most recent context.</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>._elapsed <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Timer has not been used in a context yet."</span>)</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>._elapsed</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Globals</span></span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>LOG_LEVEL <span class="op">=</span> <span class="st">'DEBUG'</span></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>PARALLELOPEDIA_ROOT <span class="op">=</span> os.environ[<span class="st">'PARALLELOPEDIA_ROOT'</span>]</span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>PARALLELOPEDIA_DATA_DIR <span class="op">=</span> join(PARALLELOPEDIA_ROOT, <span class="st">'data'</span>)</span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>MODEL_CHECKPOINT <span class="op">=</span> join(</span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>    PARALLELOPEDIA_DATA_DIR,</span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">'model_19072.pt'</span>,</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>MODEL_DOWNLOAD_URL <span class="op">=</span> (</span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://huggingface.co/datasets/trentnelson/"</span></span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">"parallelopedia-data-gpt2/resolve/main/model_19072.pt"</span></span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the model from huggingface if necessary.</span></span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>os.makedirs(PARALLELOPEDIA_DATA_DIR, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> exists(MODEL_CHECKPOINT):</span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Downloading </span><span class="sc">{</span>MODEL_DOWNLOAD_URL<span class="sc">}</span><span class="ss"> via wget '</span></span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a>          <span class="st">'this might take a while...'</span>)</span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> [</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a>        <span class="st">"wget"</span>,</span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a>        <span class="st">"--quiet"</span>,</span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a>        MODEL_DOWNLOAD_URL,</span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>        <span class="st">"-P"</span>,</span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a>        PARALLELOPEDIA_DATA_DIR,</span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a>    timer <span class="op">=</span> ElapsedTimer()</span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> timer:</span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a>        subprocess.run(args, check<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Downloaded model in </span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span>)</span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> exists(MODEL_CHECKPOINT), <span class="st">"Missing checkpoint."</span></span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Logging</span></span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a><span class="co"># N.B. We redirect logs to sys.stdout in order for Quarto to pick</span></span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a><span class="co">#      them up and include them in rendering the output.</span></span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(</span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a>    level<span class="op">=</span><span class="bu">getattr</span>(logging, LOG_LEVEL),</span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span>,</span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a>    stream<span class="op">=</span>sys.stdout</span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup</span></span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-113"><a href="#cb22-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bfloat16 for matmul precision where possible.</span></span>
<span id="cb22-114"><a href="#cb22-114" aria-hidden="true" tabindex="-1"></a>torch.set_float32_matmul_precision(<span class="st">'high'</span>)</span>
<span id="cb22-115"><a href="#cb22-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-116"><a href="#cb22-116" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-117"><a href="#cb22-117" aria-hidden="true" tabindex="-1"></a><span class="co"># GPT2 PyTorch Model Components</span></span>
<span id="cb22-118"><a href="#cb22-118" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-119"><a href="#cb22-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-120"><a href="#cb22-120" aria-hidden="true" tabindex="-1"></a><span class="co"># Now define the classes making up our GPT2 implementation.</span></span>
<span id="cb22-121"><a href="#cb22-121" aria-hidden="true" tabindex="-1"></a><span class="co"># These map directly to the components introduced by the</span></span>
<span id="cb22-122"><a href="#cb22-122" aria-hidden="true" tabindex="-1"></a><span class="co"># now-seminal 2017 "Attention Is All You Need" paper.</span></span>
<span id="cb22-123"><a href="#cb22-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-124"><a href="#cb22-124" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CausalSelfAttention(nn.Module):</span>
<span id="cb22-125"><a href="#cb22-125" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb22-126"><a href="#cb22-126" aria-hidden="true" tabindex="-1"></a><span class="co">    Causal self-attention for the GPT2 model.</span></span>
<span id="cb22-127"><a href="#cb22-127" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb22-128"><a href="#cb22-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-129"><a href="#cb22-129" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, config):</span>
<span id="cb22-130"><a href="#cb22-130" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb22-131"><a href="#cb22-131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> config.n_embd <span class="op">%</span> config.n_head <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb22-132"><a href="#cb22-132" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Key, query, value projections for all heads, but in a batch.</span></span>
<span id="cb22-133"><a href="#cb22-133" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_attn <span class="op">=</span> nn.Linear(config.n_embd, <span class="dv">3</span> <span class="op">*</span> config.n_embd)</span>
<span id="cb22-134"><a href="#cb22-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-135"><a href="#cb22-135" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Output projection.</span></span>
<span id="cb22-136"><a href="#cb22-136" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_proj <span class="op">=</span> nn.Linear(config.n_embd, config.n_embd)</span>
<span id="cb22-137"><a href="#cb22-137" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_proj.NANOGPT_SCALE_INIT <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-138"><a href="#cb22-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-139"><a href="#cb22-139" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Regularization.</span></span>
<span id="cb22-140"><a href="#cb22-140" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n_head <span class="op">=</span> config.n_head</span>
<span id="cb22-141"><a href="#cb22-141" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n_embd <span class="op">=</span> config.n_embd</span>
<span id="cb22-142"><a href="#cb22-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-143"><a href="#cb22-143" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb22-144"><a href="#cb22-144" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Batch size, sequence length, embedding dimensionality.</span></span>
<span id="cb22-145"><a href="#cb22-145" aria-hidden="true" tabindex="-1"></a>        B, T, C <span class="op">=</span> (x.size())</span>
<span id="cb22-146"><a href="#cb22-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-147"><a href="#cb22-147" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate query, key, values for all heads in</span></span>
<span id="cb22-148"><a href="#cb22-148" aria-hidden="true" tabindex="-1"></a>        <span class="co"># batch and move head forward to be the batch dim.</span></span>
<span id="cb22-149"><a href="#cb22-149" aria-hidden="true" tabindex="-1"></a>        <span class="co">#</span></span>
<span id="cb22-150"><a href="#cb22-150" aria-hidden="true" tabindex="-1"></a>        <span class="co"># N.B. nh is "number of heads", hs is "head size",</span></span>
<span id="cb22-151"><a href="#cb22-151" aria-hidden="true" tabindex="-1"></a>        <span class="co">#      and C (number of channels) is nh * hs.</span></span>
<span id="cb22-152"><a href="#cb22-152" aria-hidden="true" tabindex="-1"></a>        <span class="co">#      E.g. in GPT-2 (124M), n_head=12, hs=64, so</span></span>
<span id="cb22-153"><a href="#cb22-153" aria-hidden="true" tabindex="-1"></a>        <span class="co">#      nh*hs=C=768 channels in the Transformer.</span></span>
<span id="cb22-154"><a href="#cb22-154" aria-hidden="true" tabindex="-1"></a>        qkv <span class="op">=</span> <span class="va">self</span>.c_attn(x)</span>
<span id="cb22-155"><a href="#cb22-155" aria-hidden="true" tabindex="-1"></a>        q, k, v <span class="op">=</span> qkv.split(<span class="va">self</span>.n_embd, dim<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb22-156"><a href="#cb22-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-157"><a href="#cb22-157" aria-hidden="true" tabindex="-1"></a>        head_dim <span class="op">=</span> C <span class="op">//</span> <span class="va">self</span>.n_head</span>
<span id="cb22-158"><a href="#cb22-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-159"><a href="#cb22-159" aria-hidden="true" tabindex="-1"></a>        <span class="co"># (B, nh, T, hs)</span></span>
<span id="cb22-160"><a href="#cb22-160" aria-hidden="true" tabindex="-1"></a>        k <span class="op">=</span> k.view(B, T, <span class="va">self</span>.n_head, head_dim).transpose(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb22-161"><a href="#cb22-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-162"><a href="#cb22-162" aria-hidden="true" tabindex="-1"></a>        <span class="co"># (B, nh, T, hs)</span></span>
<span id="cb22-163"><a href="#cb22-163" aria-hidden="true" tabindex="-1"></a>        q <span class="op">=</span> q.view(B, T, <span class="va">self</span>.n_head, head_dim).transpose(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb22-164"><a href="#cb22-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-165"><a href="#cb22-165" aria-hidden="true" tabindex="-1"></a>        <span class="co"># (B, nh, T, hs)</span></span>
<span id="cb22-166"><a href="#cb22-166" aria-hidden="true" tabindex="-1"></a>        v <span class="op">=</span> v.view(B, T, <span class="va">self</span>.n_head, head_dim).transpose(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb22-167"><a href="#cb22-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-168"><a href="#cb22-168" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Flash attention.</span></span>
<span id="cb22-169"><a href="#cb22-169" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> F.scaled_dot_product_attention(q, k, v, is_causal<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-170"><a href="#cb22-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-171"><a href="#cb22-171" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Re-assemble all head outputs side by side.</span></span>
<span id="cb22-172"><a href="#cb22-172" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> (y.transpose(<span class="dv">1</span>, <span class="dv">2</span>).contiguous().view(B, T, C))</span>
<span id="cb22-173"><a href="#cb22-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-174"><a href="#cb22-174" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Output projection.</span></span>
<span id="cb22-175"><a href="#cb22-175" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> <span class="va">self</span>.c_proj(y)</span>
<span id="cb22-176"><a href="#cb22-176" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> y</span>
<span id="cb22-177"><a href="#cb22-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-178"><a href="#cb22-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-179"><a href="#cb22-179" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MLP(nn.Module):</span>
<span id="cb22-180"><a href="#cb22-180" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb22-181"><a href="#cb22-181" aria-hidden="true" tabindex="-1"></a><span class="co">    Multi-layer perceptron for the GPT2 model.</span></span>
<span id="cb22-182"><a href="#cb22-182" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb22-183"><a href="#cb22-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-184"><a href="#cb22-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, config):</span>
<span id="cb22-185"><a href="#cb22-185" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb22-186"><a href="#cb22-186" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_fc <span class="op">=</span> nn.Linear(config.n_embd, <span class="dv">4</span> <span class="op">*</span> config.n_embd)</span>
<span id="cb22-187"><a href="#cb22-187" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.gelu <span class="op">=</span> nn.GELU(approximate<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb22-188"><a href="#cb22-188" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_proj <span class="op">=</span> nn.Linear(<span class="dv">4</span> <span class="op">*</span> config.n_embd, config.n_embd)</span>
<span id="cb22-189"><a href="#cb22-189" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_proj.NANOGPT_SCALE_INIT <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-190"><a href="#cb22-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-191"><a href="#cb22-191" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb22-192"><a href="#cb22-192" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.c_fc(x)</span>
<span id="cb22-193"><a href="#cb22-193" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.gelu(x)</span>
<span id="cb22-194"><a href="#cb22-194" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.c_proj(x)</span>
<span id="cb22-195"><a href="#cb22-195" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb22-196"><a href="#cb22-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-197"><a href="#cb22-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-198"><a href="#cb22-198" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Block(nn.Module):</span>
<span id="cb22-199"><a href="#cb22-199" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb22-200"><a href="#cb22-200" aria-hidden="true" tabindex="-1"></a><span class="co">    Transformer block for the GPT2 model.</span></span>
<span id="cb22-201"><a href="#cb22-201" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb22-202"><a href="#cb22-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-203"><a href="#cb22-203" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, config):</span>
<span id="cb22-204"><a href="#cb22-204" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb22-205"><a href="#cb22-205" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ln_1 <span class="op">=</span> nn.LayerNorm(config.n_embd)</span>
<span id="cb22-206"><a href="#cb22-206" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.attn <span class="op">=</span> CausalSelfAttention(config)</span>
<span id="cb22-207"><a href="#cb22-207" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ln_2 <span class="op">=</span> nn.LayerNorm(config.n_embd)</span>
<span id="cb22-208"><a href="#cb22-208" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mlp <span class="op">=</span> MLP(config)</span>
<span id="cb22-209"><a href="#cb22-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-210"><a href="#cb22-210" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb22-211"><a href="#cb22-211" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x <span class="op">+</span> <span class="va">self</span>.attn(<span class="va">self</span>.ln_1(x))</span>
<span id="cb22-212"><a href="#cb22-212" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x <span class="op">+</span> <span class="va">self</span>.mlp(<span class="va">self</span>.ln_2(x))</span>
<span id="cb22-213"><a href="#cb22-213" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb22-214"><a href="#cb22-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-215"><a href="#cb22-215" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-216"><a href="#cb22-216" aria-hidden="true" tabindex="-1"></a><span class="co"># GPT2 Supporting Classes</span></span>
<span id="cb22-217"><a href="#cb22-217" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-218"><a href="#cb22-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-219"><a href="#cb22-219" aria-hidden="true" tabindex="-1"></a><span class="co"># N.B. These differ slightly from Andrej's classes in</span></span>
<span id="cb22-220"><a href="#cb22-220" aria-hidden="true" tabindex="-1"></a><span class="co">#      `train_gpt2.py`.  `GPTCheckpoint` is a helper</span></span>
<span id="cb22-221"><a href="#cb22-221" aria-hidden="true" tabindex="-1"></a><span class="co">#      class I wrote that has no analog in the former.</span></span>
<span id="cb22-222"><a href="#cb22-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-223"><a href="#cb22-223" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb22-224"><a href="#cb22-224" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GPTConfig:</span>
<span id="cb22-225"><a href="#cb22-225" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb22-226"><a href="#cb22-226" aria-hidden="true" tabindex="-1"></a><span class="co">    Configuration class for GPT model.</span></span>
<span id="cb22-227"><a href="#cb22-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-228"><a href="#cb22-228" aria-hidden="true" tabindex="-1"></a><span class="co">    Attributes:</span></span>
<span id="cb22-229"><a href="#cb22-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-230"><a href="#cb22-230" aria-hidden="true" tabindex="-1"></a><span class="co">        block_size (int): Maximum sequence length.</span></span>
<span id="cb22-231"><a href="#cb22-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-232"><a href="#cb22-232" aria-hidden="true" tabindex="-1"></a><span class="co">        vocab_size (int): Number of tokens.  GPT2 from</span></span>
<span id="cb22-233"><a href="#cb22-233" aria-hidden="true" tabindex="-1"></a><span class="co">            huggingface has a vocab size of 50257, which</span></span>
<span id="cb22-234"><a href="#cb22-234" aria-hidden="true" tabindex="-1"></a><span class="co">            includes 50,000 BPE merges, 256 byte tokens,</span></span>
<span id="cb22-235"><a href="#cb22-235" aria-hidden="true" tabindex="-1"></a><span class="co">            and 1 &lt;|endoftext|&gt; token.  However, Andrej</span></span>
<span id="cb22-236"><a href="#cb22-236" aria-hidden="true" tabindex="-1"></a><span class="co">            Karpathy's `build-nanogpt/train_gpt2.py`</span></span>
<span id="cb22-237"><a href="#cb22-237" aria-hidden="true" tabindex="-1"></a><span class="co">            uses a vocab size of 50304.  I vaguely recall</span></span>
<span id="cb22-238"><a href="#cb22-238" aria-hidden="true" tabindex="-1"></a><span class="co">            the explanation for this discrepancy as a local</span></span>
<span id="cb22-239"><a href="#cb22-239" aria-hidden="true" tabindex="-1"></a><span class="co">            optimization to yield better alignment sizes,</span></span>
<span id="cb22-240"><a href="#cb22-240" aria-hidden="true" tabindex="-1"></a><span class="co">            but I'm not 100% certain.</span></span>
<span id="cb22-241"><a href="#cb22-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-242"><a href="#cb22-242" aria-hidden="true" tabindex="-1"></a><span class="co">            The local GPT2 training that we did on</span></span>
<span id="cb22-243"><a href="#cb22-243" aria-hidden="true" tabindex="-1"></a><span class="co">            edu_fineweb10b used 50304, so we will use</span></span>
<span id="cb22-244"><a href="#cb22-244" aria-hidden="true" tabindex="-1"></a><span class="co">            that here.</span></span>
<span id="cb22-245"><a href="#cb22-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-246"><a href="#cb22-246" aria-hidden="true" tabindex="-1"></a><span class="co">        n_layer (int): Number of layers.</span></span>
<span id="cb22-247"><a href="#cb22-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-248"><a href="#cb22-248" aria-hidden="true" tabindex="-1"></a><span class="co">        n_head (int): Number of attention heads.</span></span>
<span id="cb22-249"><a href="#cb22-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-250"><a href="#cb22-250" aria-hidden="true" tabindex="-1"></a><span class="co">        n_embd (int): Embedding dimension.</span></span>
<span id="cb22-251"><a href="#cb22-251" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb22-252"><a href="#cb22-252" aria-hidden="true" tabindex="-1"></a>    block_size: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb22-253"><a href="#cb22-253" aria-hidden="true" tabindex="-1"></a>    vocab_size: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50304</span></span>
<span id="cb22-254"><a href="#cb22-254" aria-hidden="true" tabindex="-1"></a>    n_layer: <span class="bu">int</span> <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb22-255"><a href="#cb22-255" aria-hidden="true" tabindex="-1"></a>    n_head: <span class="bu">int</span> <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb22-256"><a href="#cb22-256" aria-hidden="true" tabindex="-1"></a>    n_embd: <span class="bu">int</span> <span class="op">=</span> <span class="dv">768</span></span>
<span id="cb22-257"><a href="#cb22-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-258"><a href="#cb22-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-259"><a href="#cb22-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-260"><a href="#cb22-260" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-261"><a href="#cb22-261" aria-hidden="true" tabindex="-1"></a><span class="co"># GPT2 Model Implementation</span></span>
<span id="cb22-262"><a href="#cb22-262" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================================</span></span>
<span id="cb22-263"><a href="#cb22-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-264"><a href="#cb22-264" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GPT(nn.Module):</span>
<span id="cb22-265"><a href="#cb22-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-266"><a href="#cb22-266" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, config, device):</span>
<span id="cb22-267"><a href="#cb22-267" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb22-268"><a href="#cb22-268" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.config <span class="op">=</span> config</span>
<span id="cb22-269"><a href="#cb22-269" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.device <span class="op">=</span> device</span>
<span id="cb22-270"><a href="#cb22-270" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.manual_seed <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb22-271"><a href="#cb22-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-272"><a href="#cb22-272" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.transformer <span class="op">=</span> nn.ModuleDict(</span>
<span id="cb22-273"><a href="#cb22-273" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(</span>
<span id="cb22-274"><a href="#cb22-274" aria-hidden="true" tabindex="-1"></a>                wte<span class="op">=</span>nn.Embedding(config.vocab_size, config.n_embd),</span>
<span id="cb22-275"><a href="#cb22-275" aria-hidden="true" tabindex="-1"></a>                wpe<span class="op">=</span>nn.Embedding(config.block_size, config.n_embd),</span>
<span id="cb22-276"><a href="#cb22-276" aria-hidden="true" tabindex="-1"></a>                h<span class="op">=</span>nn.ModuleList(</span>
<span id="cb22-277"><a href="#cb22-277" aria-hidden="true" tabindex="-1"></a>                    [Block(config) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(config.n_layer)]</span>
<span id="cb22-278"><a href="#cb22-278" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb22-279"><a href="#cb22-279" aria-hidden="true" tabindex="-1"></a>                ln_f<span class="op">=</span>nn.LayerNorm(config.n_embd),</span>
<span id="cb22-280"><a href="#cb22-280" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb22-281"><a href="#cb22-281" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-282"><a href="#cb22-282" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lm_head <span class="op">=</span> nn.Linear(</span>
<span id="cb22-283"><a href="#cb22-283" aria-hidden="true" tabindex="-1"></a>            config.n_embd, config.vocab_size, bias<span class="op">=</span><span class="va">False</span></span>
<span id="cb22-284"><a href="#cb22-284" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-285"><a href="#cb22-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-286"><a href="#cb22-286" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.transformer.wte.weight <span class="op">=</span> <span class="va">self</span>.lm_head.weight</span>
<span id="cb22-287"><a href="#cb22-287" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.<span class="bu">apply</span>(<span class="va">self</span>._init_weights)</span>
<span id="cb22-288"><a href="#cb22-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-289"><a href="#cb22-289" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _init_weights(<span class="va">self</span>, module):</span>
<span id="cb22-290"><a href="#cb22-290" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(module, nn.Linear):</span>
<span id="cb22-291"><a href="#cb22-291" aria-hidden="true" tabindex="-1"></a>            std <span class="op">=</span> <span class="fl">0.02</span></span>
<span id="cb22-292"><a href="#cb22-292" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">hasattr</span>(module, <span class="st">"NANOGPT_SCALE_INIT"</span>):</span>
<span id="cb22-293"><a href="#cb22-293" aria-hidden="true" tabindex="-1"></a>                std <span class="op">*=</span> (<span class="dv">2</span> <span class="op">*</span> <span class="va">self</span>.config.n_layer) <span class="op">**</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span id="cb22-294"><a href="#cb22-294" aria-hidden="true" tabindex="-1"></a>            torch.nn.init.normal_(module.weight, mean<span class="op">=</span><span class="fl">0.0</span>, std<span class="op">=</span>std)</span>
<span id="cb22-295"><a href="#cb22-295" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> module.bias <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb22-296"><a href="#cb22-296" aria-hidden="true" tabindex="-1"></a>                torch.nn.init.zeros_(module.bias)</span>
<span id="cb22-297"><a href="#cb22-297" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="bu">isinstance</span>(module, nn.Embedding):</span>
<span id="cb22-298"><a href="#cb22-298" aria-hidden="true" tabindex="-1"></a>            torch.nn.init.normal_(module.weight, mean<span class="op">=</span><span class="fl">0.0</span>, std<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb22-299"><a href="#cb22-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-300"><a href="#cb22-300" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, idx, targets<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb22-301"><a href="#cb22-301" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb22-302"><a href="#cb22-302" aria-hidden="true" tabindex="-1"></a><span class="co">        Forward pass of the GPT model.</span></span>
<span id="cb22-303"><a href="#cb22-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-304"><a href="#cb22-304" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb22-305"><a href="#cb22-305" aria-hidden="true" tabindex="-1"></a><span class="co">            idx (torch.Tensor): Supplies the input tensor of shape</span></span>
<span id="cb22-306"><a href="#cb22-306" aria-hidden="true" tabindex="-1"></a><span class="co">                (B, T).</span></span>
<span id="cb22-307"><a href="#cb22-307" aria-hidden="true" tabindex="-1"></a><span class="co">            targets (torch.Tensor): Optionally supplies the target</span></span>
<span id="cb22-308"><a href="#cb22-308" aria-hidden="true" tabindex="-1"></a><span class="co">                tensor of shape (B, T) for computing the loss.</span></span>
<span id="cb22-309"><a href="#cb22-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-310"><a href="#cb22-310" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb22-311"><a href="#cb22-311" aria-hidden="true" tabindex="-1"></a>        (B, T) <span class="op">=</span> idx.size()</span>
<span id="cb22-312"><a href="#cb22-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-313"><a href="#cb22-313" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward the token and position embeddings.</span></span>
<span id="cb22-314"><a href="#cb22-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-315"><a href="#cb22-315" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Shape (T)</span></span>
<span id="cb22-316"><a href="#cb22-316" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> torch.arange(<span class="dv">0</span>, T, dtype<span class="op">=</span>torch.<span class="bu">long</span>, device<span class="op">=</span>idx.device)</span>
<span id="cb22-317"><a href="#cb22-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-318"><a href="#cb22-318" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Position embeddings of shape (T, n_embd).</span></span>
<span id="cb22-319"><a href="#cb22-319" aria-hidden="true" tabindex="-1"></a>        pos_emb <span class="op">=</span> <span class="va">self</span>.transformer.wpe(pos)</span>
<span id="cb22-320"><a href="#cb22-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-321"><a href="#cb22-321" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Token embeddings of shape (B, T, n_embd).</span></span>
<span id="cb22-322"><a href="#cb22-322" aria-hidden="true" tabindex="-1"></a>        tok_emb <span class="op">=</span> <span class="va">self</span>.transformer.wte(idx)</span>
<span id="cb22-323"><a href="#cb22-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-324"><a href="#cb22-324" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> tok_emb <span class="op">+</span> pos_emb</span>
<span id="cb22-325"><a href="#cb22-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-326"><a href="#cb22-326" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward the blocks of the transformer.</span></span>
<span id="cb22-327"><a href="#cb22-327" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> block <span class="kw">in</span> <span class="va">self</span>.transformer.h:</span>
<span id="cb22-328"><a href="#cb22-328" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> block(x)</span>
<span id="cb22-329"><a href="#cb22-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-330"><a href="#cb22-330" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward the final layernorm and the classifier.</span></span>
<span id="cb22-331"><a href="#cb22-331" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.transformer.ln_f(x)</span>
<span id="cb22-332"><a href="#cb22-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-333"><a href="#cb22-333" aria-hidden="true" tabindex="-1"></a>        <span class="co"># (B, T, vocab_size)</span></span>
<span id="cb22-334"><a href="#cb22-334" aria-hidden="true" tabindex="-1"></a>        logits <span class="op">=</span> <span class="va">self</span>.lm_head(x)</span>
<span id="cb22-335"><a href="#cb22-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-336"><a href="#cb22-336" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-337"><a href="#cb22-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> targets <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb22-338"><a href="#cb22-338" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> F.cross_entropy(</span>
<span id="cb22-339"><a href="#cb22-339" aria-hidden="true" tabindex="-1"></a>                logits.view(<span class="op">-</span><span class="dv">1</span>, logits.size(<span class="op">-</span><span class="dv">1</span>)), targets.view(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb22-340"><a href="#cb22-340" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb22-341"><a href="#cb22-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-342"><a href="#cb22-342" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (logits, loss)</span>
<span id="cb22-343"><a href="#cb22-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-344"><a href="#cb22-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb22-345"><a href="#cb22-345" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> from_local_pretrained(</span>
<span id="cb22-346"><a href="#cb22-346" aria-hidden="true" tabindex="-1"></a>        cls, model_path: <span class="bu">str</span>, map_location: <span class="bu">str</span> <span class="op">=</span> <span class="st">"cuda"</span></span>
<span id="cb22-347"><a href="#cb22-347" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb22-348"><a href="#cb22-348" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb22-349"><a href="#cb22-349" aria-hidden="true" tabindex="-1"></a><span class="co">        Load a model from a local checkpoint.</span></span>
<span id="cb22-350"><a href="#cb22-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-351"><a href="#cb22-351" aria-hidden="true" tabindex="-1"></a><span class="co">        N.B. This is a new method based off GPT.from_pretrained</span></span>
<span id="cb22-352"><a href="#cb22-352" aria-hidden="true" tabindex="-1"></a><span class="co">             in Andrej Karpathy's train_gpt2.py.</span></span>
<span id="cb22-353"><a href="#cb22-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-354"><a href="#cb22-354" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb22-355"><a href="#cb22-355" aria-hidden="true" tabindex="-1"></a><span class="co">            cls (type): Supplies the class type.</span></span>
<span id="cb22-356"><a href="#cb22-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-357"><a href="#cb22-357" aria-hidden="true" tabindex="-1"></a><span class="co">            model_path (str): Supplies the path to the model</span></span>
<span id="cb22-358"><a href="#cb22-358" aria-hidden="true" tabindex="-1"></a><span class="co">                checkpoint.</span></span>
<span id="cb22-359"><a href="#cb22-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-360"><a href="#cb22-360" aria-hidden="true" tabindex="-1"></a><span class="co">            map_location (str): Supplies the device to which</span></span>
<span id="cb22-361"><a href="#cb22-361" aria-hidden="true" tabindex="-1"></a><span class="co">                the model will be mapped.</span></span>
<span id="cb22-362"><a href="#cb22-362" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb22-363"><a href="#cb22-363" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.serialization.safe_globals([GPTConfig]):</span>
<span id="cb22-364"><a href="#cb22-364" aria-hidden="true" tabindex="-1"></a>            checkpoint <span class="op">=</span> torch.load(</span>
<span id="cb22-365"><a href="#cb22-365" aria-hidden="true" tabindex="-1"></a>                model_path,</span>
<span id="cb22-366"><a href="#cb22-366" aria-hidden="true" tabindex="-1"></a>                map_location<span class="op">=</span>map_location,</span>
<span id="cb22-367"><a href="#cb22-367" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb22-368"><a href="#cb22-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-369"><a href="#cb22-369" aria-hidden="true" tabindex="-1"></a>        config <span class="op">=</span> checkpoint[<span class="st">"config"</span>]</span>
<span id="cb22-370"><a href="#cb22-370" aria-hidden="true" tabindex="-1"></a>        config <span class="op">=</span> GPTConfig(<span class="op">**</span>checkpoint[<span class="st">"config"</span>])</span>
<span id="cb22-371"><a href="#cb22-371" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> cls(config, device<span class="op">=</span>map_location)</span>
<span id="cb22-372"><a href="#cb22-372" aria-hidden="true" tabindex="-1"></a>        model.load_state_dict(checkpoint[<span class="st">"model"</span>])</span>
<span id="cb22-373"><a href="#cb22-373" aria-hidden="true" tabindex="-1"></a>        model.<span class="bu">eval</span>()</span>
<span id="cb22-374"><a href="#cb22-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-375"><a href="#cb22-375" aria-hidden="true" tabindex="-1"></a>        msg <span class="op">=</span> (</span>
<span id="cb22-376"><a href="#cb22-376" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"Loaded model from step </span><span class="sc">{</span>checkpoint[<span class="st">'step'</span>]<span class="sc">}</span><span class="ss">, "</span></span>
<span id="cb22-377"><a href="#cb22-377" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"val_loss </span><span class="sc">{</span>checkpoint[<span class="st">'val_loss'</span>]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb22-378"><a href="#cb22-378" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-379"><a href="#cb22-379" aria-hidden="true" tabindex="-1"></a>        logging.info(msg)</span>
<span id="cb22-380"><a href="#cb22-380" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> model</span>
<span id="cb22-381"><a href="#cb22-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-382"><a href="#cb22-382" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate(</span>
<span id="cb22-383"><a href="#cb22-383" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>, text: <span class="bu">str</span>, max_length: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1024</span>, top_k: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>,</span>
<span id="cb22-384"><a href="#cb22-384" aria-hidden="true" tabindex="-1"></a>        seed: <span class="bu">int</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb22-385"><a href="#cb22-385" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb22-386"><a href="#cb22-386" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb22-387"><a href="#cb22-387" aria-hidden="true" tabindex="-1"></a><span class="co">        Generate text from the model.</span></span>
<span id="cb22-388"><a href="#cb22-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-389"><a href="#cb22-389" aria-hidden="true" tabindex="-1"></a><span class="co">        N.B. This is a new method based off the generation code</span></span>
<span id="cb22-390"><a href="#cb22-390" aria-hidden="true" tabindex="-1"></a><span class="co">             present in Andrej Karpathy's train_gpt2.py.</span></span>
<span id="cb22-391"><a href="#cb22-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-392"><a href="#cb22-392" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb22-393"><a href="#cb22-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-394"><a href="#cb22-394" aria-hidden="true" tabindex="-1"></a><span class="co">            text (str): Supplies the prompt.</span></span>
<span id="cb22-395"><a href="#cb22-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-396"><a href="#cb22-396" aria-hidden="true" tabindex="-1"></a><span class="co">            max_length (int): Supplies the maximum total length,</span></span>
<span id="cb22-397"><a href="#cb22-397" aria-hidden="true" tabindex="-1"></a><span class="co">                including prompt.</span></span>
<span id="cb22-398"><a href="#cb22-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-399"><a href="#cb22-399" aria-hidden="true" tabindex="-1"></a><span class="co">            top_k (int): Supplies the number of tokens to consider</span></span>
<span id="cb22-400"><a href="#cb22-400" aria-hidden="true" tabindex="-1"></a><span class="co">                at each generation step.</span></span>
<span id="cb22-401"><a href="#cb22-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-402"><a href="#cb22-402" aria-hidden="true" tabindex="-1"></a><span class="co">            seed (int): Optionally supplies the manual seed to use</span></span>
<span id="cb22-403"><a href="#cb22-403" aria-hidden="true" tabindex="-1"></a><span class="co">                for the generator.  If None, the model's manual</span></span>
<span id="cb22-404"><a href="#cb22-404" aria-hidden="true" tabindex="-1"></a><span class="co">                seed will be used.</span></span>
<span id="cb22-405"><a href="#cb22-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-406"><a href="#cb22-406" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb22-407"><a href="#cb22-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-408"><a href="#cb22-408" aria-hidden="true" tabindex="-1"></a><span class="co">            str: The generated text (including the initial prompt).</span></span>
<span id="cb22-409"><a href="#cb22-409" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb22-410"><a href="#cb22-410" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.<span class="bu">eval</span>()</span>
<span id="cb22-411"><a href="#cb22-411" aria-hidden="true" tabindex="-1"></a>        device <span class="op">=</span> <span class="va">self</span>.device</span>
<span id="cb22-412"><a href="#cb22-412" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Obtain our GPT2 tokenizer, and resolve the stop token.</span></span>
<span id="cb22-413"><a href="#cb22-413" aria-hidden="true" tabindex="-1"></a>        enc <span class="op">=</span> tiktoken.get_encoding(<span class="st">"gpt2"</span>)</span>
<span id="cb22-414"><a href="#cb22-414" aria-hidden="true" tabindex="-1"></a>        stop_string <span class="op">=</span> <span class="st">'&lt;|endoftext|&gt;'</span></span>
<span id="cb22-415"><a href="#cb22-415" aria-hidden="true" tabindex="-1"></a>        stop_token <span class="op">=</span> enc.n_vocab <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb22-416"><a href="#cb22-416" aria-hidden="true" tabindex="-1"></a>        actual <span class="op">=</span> enc.decode([stop_token])</span>
<span id="cb22-417"><a href="#cb22-417" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> actual <span class="op">==</span> stop_string, (</span>
<span id="cb22-418"><a href="#cb22-418" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"expected </span><span class="sc">{</span>stop_string<span class="sc">}</span><span class="ss">, got </span><span class="sc">{</span>actual<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb22-419"><a href="#cb22-419" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-420"><a href="#cb22-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-421"><a href="#cb22-421" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Encode the prompt.</span></span>
<span id="cb22-422"><a href="#cb22-422" aria-hidden="true" tabindex="-1"></a>        tokens <span class="op">=</span> enc.encode(text)</span>
<span id="cb22-423"><a href="#cb22-423" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.tensor(</span>
<span id="cb22-424"><a href="#cb22-424" aria-hidden="true" tabindex="-1"></a>            tokens, dtype<span class="op">=</span>torch.<span class="bu">long</span>, device<span class="op">=</span>device</span>
<span id="cb22-425"><a href="#cb22-425" aria-hidden="true" tabindex="-1"></a>        ).unsqueeze(<span class="dv">0</span>)</span>
<span id="cb22-426"><a href="#cb22-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-427"><a href="#cb22-427" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create a random generator for reproducibility.</span></span>
<span id="cb22-428"><a href="#cb22-428" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> seed <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb22-429"><a href="#cb22-429" aria-hidden="true" tabindex="-1"></a>            seed <span class="op">=</span> <span class="va">self</span>.manual_seed</span>
<span id="cb22-430"><a href="#cb22-430" aria-hidden="true" tabindex="-1"></a>        sample_rng <span class="op">=</span> torch.Generator(device<span class="op">=</span>device)</span>
<span id="cb22-431"><a href="#cb22-431" aria-hidden="true" tabindex="-1"></a>        sample_rng.manual_seed(seed)</span>
<span id="cb22-432"><a href="#cb22-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-433"><a href="#cb22-433" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate tokens up to our max length, or until we hit the</span></span>
<span id="cb22-434"><a href="#cb22-434" aria-hidden="true" tabindex="-1"></a>        <span class="co"># stop token.</span></span>
<span id="cb22-435"><a href="#cb22-435" aria-hidden="true" tabindex="-1"></a>        start <span class="op">=</span> time.perf_counter()</span>
<span id="cb22-436"><a href="#cb22-436" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-437"><a href="#cb22-437" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> x.size(<span class="dv">1</span>) <span class="op">&lt;</span> max_length:</span>
<span id="cb22-438"><a href="#cb22-438" aria-hidden="true" tabindex="-1"></a>            count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb22-439"><a href="#cb22-439" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> torch.no_grad():</span>
<span id="cb22-440"><a href="#cb22-440" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Forward pass, ignoring the returned loss.</span></span>
<span id="cb22-441"><a href="#cb22-441" aria-hidden="true" tabindex="-1"></a>                (logits, _) <span class="op">=</span> <span class="va">self</span>(x)</span>
<span id="cb22-442"><a href="#cb22-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-443"><a href="#cb22-443" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Take the logits at the last time-step (shape:</span></span>
<span id="cb22-444"><a href="#cb22-444" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (1, vocab_size)).</span></span>
<span id="cb22-445"><a href="#cb22-445" aria-hidden="true" tabindex="-1"></a>            logits <span class="op">=</span> logits[:, <span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb22-446"><a href="#cb22-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-447"><a href="#cb22-447" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Convert to probabilities.</span></span>
<span id="cb22-448"><a href="#cb22-448" aria-hidden="true" tabindex="-1"></a>            probs <span class="op">=</span> F.softmax(logits, dim<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb22-449"><a href="#cb22-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-450"><a href="#cb22-450" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Top-k sampling.</span></span>
<span id="cb22-451"><a href="#cb22-451" aria-hidden="true" tabindex="-1"></a>            topk_probs, topk_indices <span class="op">=</span> torch.topk(</span>
<span id="cb22-452"><a href="#cb22-452" aria-hidden="true" tabindex="-1"></a>                probs, k<span class="op">=</span>top_k, dim<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb22-453"><a href="#cb22-453" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb22-454"><a href="#cb22-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-455"><a href="#cb22-455" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Sample the next token.</span></span>
<span id="cb22-456"><a href="#cb22-456" aria-hidden="true" tabindex="-1"></a>            next_idx <span class="op">=</span> torch.multinomial(</span>
<span id="cb22-457"><a href="#cb22-457" aria-hidden="true" tabindex="-1"></a>                topk_probs, num_samples<span class="op">=</span><span class="dv">1</span>, generator<span class="op">=</span>sample_rng</span>
<span id="cb22-458"><a href="#cb22-458" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb22-459"><a href="#cb22-459" aria-hidden="true" tabindex="-1"></a>            next_token <span class="op">=</span> torch.gather(topk_indices, <span class="op">-</span><span class="dv">1</span>, next_idx)</span>
<span id="cb22-460"><a href="#cb22-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-461"><a href="#cb22-461" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If the next token is the stop token, we're done.</span></span>
<span id="cb22-462"><a href="#cb22-462" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> next_token.item() <span class="op">==</span> stop_token:</span>
<span id="cb22-463"><a href="#cb22-463" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb22-464"><a href="#cb22-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-465"><a href="#cb22-465" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Otherwise, append the token to the current sequence</span></span>
<span id="cb22-466"><a href="#cb22-466" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and continue generation.</span></span>
<span id="cb22-467"><a href="#cb22-467" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> torch.cat((x, next_token), dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-468"><a href="#cb22-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-469"><a href="#cb22-469" aria-hidden="true" tabindex="-1"></a>        end <span class="op">=</span> time.perf_counter()</span>
<span id="cb22-470"><a href="#cb22-470" aria-hidden="true" tabindex="-1"></a>        elapsed <span class="op">=</span> end <span class="op">-</span> start</span>
<span id="cb22-471"><a href="#cb22-471" aria-hidden="true" tabindex="-1"></a>        tokens_per_sec <span class="op">=</span> <span class="bu">float</span>(count) <span class="op">/</span> elapsed</span>
<span id="cb22-472"><a href="#cb22-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-473"><a href="#cb22-473" aria-hidden="true" tabindex="-1"></a>        msg <span class="op">=</span> (</span>
<span id="cb22-474"><a href="#cb22-474" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'Generated </span><span class="sc">{</span>count<span class="sc">}</span><span class="ss"> tokens in </span><span class="sc">{</span>elapsed<span class="sc">:.2f}</span><span class="ss"> seconds '</span></span>
<span id="cb22-475"><a href="#cb22-475" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'(</span><span class="sc">{</span>tokens_per_sec<span class="sc">:.2f}</span><span class="ss"> tokens/sec)'</span></span>
<span id="cb22-476"><a href="#cb22-476" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-477"><a href="#cb22-477" aria-hidden="true" tabindex="-1"></a>        logging.debug(msg)</span>
<span id="cb22-478"><a href="#cb22-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-479"><a href="#cb22-479" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Decode the output tokens and return the generated text,</span></span>
<span id="cb22-480"><a href="#cb22-480" aria-hidden="true" tabindex="-1"></a>        <span class="co"># including the initial prompt.</span></span>
<span id="cb22-481"><a href="#cb22-481" aria-hidden="true" tabindex="-1"></a>        output_tokens <span class="op">=</span> x[<span class="dv">0</span>].tolist()</span>
<span id="cb22-482"><a href="#cb22-482" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> enc.decode(output_tokens)</span>
<span id="cb22-483"><a href="#cb22-483" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</section>
<section id="loading-the-model" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-model">Loading the Model</h2>
<p>With the code above executed in a preceding Jupyter Notebook cell, we can load the model as follows:</p>
<div class="quarto-embed-nb-cell">
<div id="cell-gpt2-v1-load-model" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GPT.from_local_pretrained(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    MODEL_CHECKPOINT,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    map_location<span class="op">=</span><span class="st">'cuda'</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>model.to(<span class="st">'cuda'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2025-02-09 15:26:39,136 - INFO - Loaded model from step 19072, val_loss 3.0519702434539795</code></pre>
</div>
<div id="gpt2-v1-load-model" class="cell-output cell-output-display" data-execution_count="2">
<pre><code>GPT(
  (transformer): ModuleDict(
    (wte): Embedding(50304, 768)
    (wpe): Embedding(1024, 768)
    (h): ModuleList(
      (0-11): 12 x Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): CausalSelfAttention(
          (c_attn): Linear(in_features=768, out_features=2304, bias=True)
          (c_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): MLP(
          (c_fc): Linear(in_features=768, out_features=3072, bias=True)
          (gelu): GELU(approximate='tanh')
          (c_proj): Linear(in_features=3072, out_features=768, bias=True)
        )
      )
    )
    (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
  )
  (lm_head): Linear(in_features=768, out_features=50304, bias=False)
)</code></pre>
</div>
</div>
</div>
</section>
<section id="generating-text" class="level2">
<h2 class="anchored" data-anchor-id="generating-text">Generating Text</h2>
<p>Once we’ve got a model instance, text can be generated by simply calling the model’s <code>generate()</code> function with a prompt, and, optionally, some additional parameters like seed and max length. This is also referred to as inference—the two terms are interchangeable, and mean the same thing: the act of providing some input tokens—your encoded prompt—to your trained model, and having it generate tokens in response.</p>
<p>Note that this isn’t a <em>chat</em> or <em>instruction</em> model, nor has it been fine-tuned to remotely resemble something actually usable. So you can’t ask it questions or have it write code for you.</p>
<p>What you can do, though, is provide it with a half written sentence, and then laugh at the ridiculous content it generates in response. Although note that its syntax is pretty good—the model has clearly learned enough during training about how the English language is structured, which words make sense when placed together, that sort of thing. It just has no clue about underlying semantics.</p>
<div class="desktop-only">
<div class="quarto-embed-nb-cell">
<div id="gpt2-v1-generate-1-desktop" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>prompt <span class="op">=</span> <span class="st">"Albert Einstein's Theory of Relativity stated that"</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> model.generate(prompt, seed<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="op">+</span> textwrap.fill(result, width<span class="op">=</span><span class="dv">105</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2025-02-09 15:26:40,464 - DEBUG - Generated 79 tokens in 0.81 seconds (98.10 tokens/sec)

Albert Einstein's Theory of Relativity stated that the speed of light was approximately 10 000 of
parsecs, whereas quantum physicists have suggested that, as we move further into the universe, the
universe might grow older. The new experiment, conducted by researchers at the University of New Jersey,
New York, and the University of California, Berkeley shows that photons travelling at the speed of light
will be around 30 to 65 kilometres per second.</code></pre>
</div>
</div>
</div>
</div>
<div class="tablet-only">
<div class="quarto-embed-nb-cell">
<div id="gpt2-v1-generate-1-tablet" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>prompt <span class="op">=</span> <span class="st">"Albert Einstein's Theory of Relativity stated that"</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> model.generate(prompt, seed<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="op">+</span> textwrap.fill(result, width<span class="op">=</span><span class="dv">58</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2025-02-09 15:26:41,014 - DEBUG - Generated 79 tokens in 0.54 seconds (145.49 tokens/sec)

Albert Einstein's Theory of Relativity stated that the
speed of light was approximately 10 000 of parsecs,
whereas quantum physicists have suggested that, as we move
further into the universe, the universe might grow older.
The new experiment, conducted by researchers at the
University of New Jersey, New York, and the University of
California, Berkeley shows that photons travelling at the
speed of light will be around 30 to 65 kilometres per
second.</code></pre>
</div>
</div>
</div>
</div>
<div class="phone-only">
<div class="quarto-embed-nb-cell">
<div id="gpt2-v1-generate-1-phone" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>prompt <span class="op">=</span> <span class="st">"Albert Einstein's Theory of Relativity stated that"</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> model.generate(prompt, seed<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="op">+</span> textwrap.fill(result, width<span class="op">=</span><span class="dv">45</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2025-02-09 15:26:41,565 - DEBUG - Generated 79 tokens in 0.54 seconds (145.05 tokens/sec)

Albert Einstein's Theory of Relativity stated
that the speed of light was approximately 10
000 of parsecs, whereas quantum physicists
have suggested that, as we move further into
the universe, the universe might grow older.
The new experiment, conducted by researchers
at the University of New Jersey, New York,
and the University of California, Berkeley
shows that photons travelling at the speed of
light will be around 30 to 65 kilometres per
second.</code></pre>
</div>
</div>
</div>
</div>
<p>Now, it’s worth noting at this point that a 124 million parameter GPT2 model, trained from scratch for 19,072 iterations on the <code>edu_fineweb10b</code> data set, with a final loss score of 3.052, is, quite frankly, hot garbage :-)</p>
<p>Do not be expecting output from this model to rival anything close to what you’d expect from a contemporary LLM. In fact, we can’t even rely on it to even remotely generate content that is factual in nature. It spews hot probabilisitic garbage that mostly conforms to the structure of the English language.</p>
<p>But at least it’s <em>our</em> hot garbage that we trained from nothing, and it’s all we need to start playing around with generating text in parallel.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Hot Garbage Example">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hot Garbage Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Provide a slightly different seed to the prompt above and you’ll precisely see some hot garbage generation in action. In the following example, with an identical prompt as the one prior, it just streams nonsense until hitting its max token limit, nary a stop token in sight.</p>
<div class="desktop-only">
<div class="quarto-embed-nb-cell">
<div id="gpt2-v1-generate-2-desktop" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> model.generate(prompt, seed<span class="op">=</span><span class="dv">20190903</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="op">+</span> textwrap.fill(result, width<span class="op">=</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2025-02-09 15:26:57,518 - DEBUG - Generated 1015 tokens in 15.95 seconds (63.65 tokens/sec)

Albert Einstein's Theory of Relativity stated that the speed of light is the same as it is in two
places, which means that a given speed can either be described by two different speed equations
directly or they may be both equations. It is then assumed that the speed of light is the speed of
the universe or the universe's existence relative to Earth. In relativity, a measure of the speed of
light is the absolute speed of the light. As long as the speed of light is less than its speed in
two different places, the absolute speed can be calculated. For example, the absolute speed is
1/2990000000 (2,299,792,458) km/hr with an absolute speed about 10 times as fast as it is in two
different places. Now we can use the following equation to describe the speed of light: E = C/C2 The
speed of light, as a function of C, is a constant. By Einstein's definition of relativity, the speed
of light is a constant. This is because light travels at its maximum speed along the direction (if
it's travelling above the speed of light, the point where light must be observed is called
"aperture" of the speed of light). The speed of light is about half as fast as the speed of light
because the speed of light has a smaller varying velocity for each direction of radiation. The speed
of light, as a function of C, is a constant. The speed of a wave is the constant measured along the
direction of the wave relative to its location in space. E = C/C2 where E is the speed of light
along the direction of the wave. Because the speed of the wave is the speed of the particle in the
wave, and c the speed of the particle, E's is also given by the speed of light. For example, a light
particle is moving from its place of greatest velocity to its location of greatest velocity. E.g. C
= F/d, C = d/d For most materials and most other objects, the speed of light is the same for all
wavelengths. The speed of light is, on the other hand, the speed of the energy form of a photon.
E.g. c = C/d, C = e/d For most particles, light travels over one degree of separation and this is
how photons interact with other particles. We can compare a particle's velocity to an object's
velocity. The speed of light is measured by the distance between the particle's nose and the surface
of the object. For example, a photon of light emits the energy of a single photon. If a photon of
another type is fired at the same speed as the first, it will get out of the light, but a photon of
the other type will not get back to the ground. The fractional energy will be reduced. The distance
between two photons of the same type will be reduced to the square of their energies. E.g. C = C/C2,
C = -D/d., D = 9/6 A photon of color does not have sufficient energy to be emitted by that color and
is therefore subject to The speed of light is the change in velocity over time. This is a constant,
but sometimes it is possible to express it like this: E = c2/e In relativity, the length of the
distance is the length of time the length of wave is divided by the speed of light. E.g. a beam of
light travelling at about 9.2 miles per second must travel at around 7.3 miles per second to get
E.g. a beam moving at 3.2 miles per second must travel at around 8 miles per second to get E.g. a
beam moving at 1.8 miles per second must travel at 9.0 miles per second to get E.g. an object going
at 2.3 miles per second must travel at 1.8 miles per second to get E.g. a beam moving at 2.3 miles
per second must travel at 3.4 miles per second to get E.g.. a beam traveling at 3.4 miles per second
to get E.g.. a beam moving at 2.3 miles per second must travel at 3.8 miles per second to get E.g..
a beam traveling at 3.8 miles per second to get E.g.. a beam moving at about 4.4 miles per second
must travel at about 3.9 miles per second to get E.g.. a beam moving at 5.5 miles per second to get
a beam moving at 5.9 miles per S.G.D.. is the same thing as a mass. The distance is a unit in terms
of the speed of light. Determining the speed of light is an additional measure of the energy. For
most things</code></pre>
</div>
</div>
</div>
</div>
<div class="tablet-only">
<div class="quarto-embed-nb-cell">
<div id="gpt2-v1-generate-2-tablet" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> model.generate(prompt, seed<span class="op">=</span><span class="dv">20190903</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="op">+</span> textwrap.fill(result, width<span class="op">=</span><span class="dv">54</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2025-02-09 15:27:13,333 - DEBUG - Generated 1015 tokens in 15.81 seconds (64.21 tokens/sec)

Albert Einstein's Theory of Relativity stated that the
speed of light is the same as it is in two places,
which means that a given speed can either be described
by two different speed equations directly or they may
be both equations. It is then assumed that the speed
of light is the speed of the universe or the
universe's existence relative to Earth. In relativity,
a measure of the speed of light is the absolute speed
of the light. As long as the speed of light is less
than its speed in two different places, the absolute
speed can be calculated. For example, the absolute
speed is 1/2990000000 (2,299,792,458) km/hr with an
absolute speed about 10 times as fast as it is in two
different places. Now we can use the following
equation to describe the speed of light: E = C/C2 The
speed of light, as a function of C, is a constant. By
Einstein's definition of relativity, the speed of
light is a constant. This is because light travels at
its maximum speed along the direction (if it's
travelling above the speed of light, the point where
light must be observed is called "aperture" of the
speed of light). The speed of light is about half as
fast as the speed of light because the speed of light
has a smaller varying velocity for each direction of
radiation. The speed of light, as a function of C, is
a constant. The speed of a wave is the constant
measured along the direction of the wave relative to
its location in space. E = C/C2 where E is the speed
of light along the direction of the wave. Because the
speed of the wave is the speed of the particle in the
wave, and c the speed of the particle, E's is also
given by the speed of light. For example, a light
particle is moving from its place of greatest velocity
to its location of greatest velocity. E.g. C = F/d, C
= d/d For most materials and most other objects, the
speed of light is the same for all wavelengths. The
speed of light is, on the other hand, the speed of the
energy form of a photon. E.g. c = C/d, C = e/d For
most particles, light travels over one degree of
separation and this is how photons interact with other
particles. We can compare a particle's velocity to an
object's velocity. The speed of light is measured by
the distance between the particle's nose and the
surface of the object. For example, a photon of light
emits the energy of a single photon. If a photon of
another type is fired at the same speed as the first,
it will get out of the light, but a photon of the
other type will not get back to the ground. The
fractional energy will be reduced. The distance
between two photons of the same type will be reduced
to the square of their energies. E.g. C = C/C2, C =
-D/d., D = 9/6 A photon of color does not have
sufficient energy to be emitted by that color and is
therefore subject to The speed of light is the change
in velocity over time. This is a constant, but
sometimes it is possible to express it like this: E =
c2/e In relativity, the length of the distance is the
length of time the length of wave is divided by the
speed of light. E.g. a beam of light travelling at
about 9.2 miles per second must travel at around 7.3
miles per second to get E.g. a beam moving at 3.2
miles per second must travel at around 8 miles per
second to get E.g. a beam moving at 1.8 miles per
second must travel at 9.0 miles per second to get E.g.
an object going at 2.3 miles per second must travel at
1.8 miles per second to get E.g. a beam moving at 2.3
miles per second must travel at 3.4 miles per second
to get E.g.. a beam traveling at 3.4 miles per second
to get E.g.. a beam moving at 2.3 miles per second
must travel at 3.8 miles per second to get E.g.. a
beam traveling at 3.8 miles per second to get E.g.. a
beam moving at about 4.4 miles per second must travel
at about 3.9 miles per second to get E.g.. a beam
moving at 5.5 miles per second to get a beam moving at
5.9 miles per S.G.D.. is the same thing as a mass. The
distance is a unit in terms of the speed of light.
Determining the speed of light is an additional
measure of the energy. For most things</code></pre>
</div>
</div>
</div>
</div>
<div class="phone-only">
<div class="quarto-embed-nb-cell">
<div id="gpt2-v1-generate-2-phone" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> model.generate(prompt, seed<span class="op">=</span><span class="dv">20190903</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="op">+</span> textwrap.fill(result, width<span class="op">=</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2025-02-09 15:27:56,654 - DEBUG - Generated 1015 tokens in 15.89 seconds (63.87 tokens/sec)

Albert Einstein's Theory of Relativity
stated that the speed of light is the
same as it is in two places, which means
that a given speed can either be
described by two different speed
equations directly or they may be both
equations. It is then assumed that the
speed of light is the speed of the
universe or the universe's existence
relative to Earth. In relativity, a
measure of the speed of light is the
absolute speed of the light. As long as
the speed of light is less than its
speed in two different places, the
absolute speed can be calculated. For
example, the absolute speed is
1/2990000000 (2,299,792,458) km/hr with
an absolute speed about 10 times as fast
as it is in two different places. Now we
can use the following equation to
describe the speed of light: E = C/C2
The speed of light, as a function of C,
is a constant. By Einstein's definition
of relativity, the speed of light is a
constant. This is because light travels
at its maximum speed along the direction
(if it's travelling above the speed of
light, the point where light must be
observed is called "aperture" of the
speed of light). The speed of light is
about half as fast as the speed of light
because the speed of light has a smaller
varying velocity for each direction of
radiation. The speed of light, as a
function of C, is a constant. The speed
of a wave is the constant measured along
the direction of the wave relative to
its location in space. E = C/C2 where E
is the speed of light along the
direction of the wave. Because the speed
of the wave is the speed of the particle
in the wave, and c the speed of the
particle, E's is also given by the speed
of light. For example, a light particle
is moving from its place of greatest
velocity to its location of greatest
velocity. E.g. C = F/d, C = d/d For most
materials and most other objects, the
speed of light is the same for all
wavelengths. The speed of light is, on
the other hand, the speed of the energy
form of a photon. E.g. c = C/d, C = e/d
For most particles, light travels over
one degree of separation and this is how
photons interact with other particles.
We can compare a particle's velocity to
an object's velocity. The speed of light
is measured by the distance between the
particle's nose and the surface of the
object. For example, a photon of light
emits the energy of a single photon. If
a photon of another type is fired at the
same speed as the first, it will get out
of the light, but a photon of the other
type will not get back to the ground.
The fractional energy will be reduced.
The distance between two photons of the
same type will be reduced to the square
of their energies. E.g. C = C/C2, C =
-D/d., D = 9/6 A photon of color does
not have sufficient energy to be emitted
by that color and is therefore subject
to The speed of light is the change in
velocity over time. This is a constant,
but sometimes it is possible to express
it like this: E = c2/e In relativity,
the length of the distance is the length
of time the length of wave is divided by
the speed of light. E.g. a beam of light
travelling at about 9.2 miles per second
must travel at around 7.3 miles per
second to get E.g. a beam moving at 3.2
miles per second must travel at around 8
miles per second to get E.g. a beam
moving at 1.8 miles per second must
travel at 9.0 miles per second to get
E.g. an object going at 2.3 miles per
second must travel at 1.8 miles per
second to get E.g. a beam moving at 2.3
miles per second must travel at 3.4
miles per second to get E.g.. a beam
traveling at 3.4 miles per second to get
E.g.. a beam moving at 2.3 miles per
second must travel at 3.8 miles per
second to get E.g.. a beam traveling at
3.8 miles per second to get E.g.. a beam
moving at about 4.4 miles per second
must travel at about 3.9 miles per
second to get E.g.. a beam moving at 5.5
miles per second to get a beam moving at
5.9 miles per S.G.D.. is the same thing
as a mass. The distance is a unit in
terms of the speed of light. Determining
the speed of light is an additional
measure of the energy. For most things</code></pre>
</div>
</div>
</div>
</div>
<p>lolwat.</p>
</div>
</div>
</div>
</section>
</section>
<section id="parallel-pytorch-inference" class="level1">
<h1>Parallel PyTorch Inference</h1>
<p>Now that we’ve got generation working, let’s tackle the fun part: investigating whether or not PyTorch model inference can be done simultaneously, in parallel, by multiple threads, running on multiple cores at the same time, in a single free-threaded Python process. And ideally, we should only need one GPU, with all of these threads <em>sharing</em> it as fairly as possible. Although if we have multiple GPUs, we should be able to distribute the incoming work evenly across those too, if we want.</p>
<p>This is novel, uncharted territory we’re able to now explore thanks to the free-threaded version of Python.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Simultaneous vs Parallel vs Concurrent">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Simultaneous vs Parallel vs Concurrent
</div>
</div>
<div class="callout-body-container callout-body">
<p>The phrasing I’ve used above—<em>“simultaneously, in parallel”</em>—is a bit redundant. They both imply the same thing. When I use either word in this post, I’m explicitly referring to the new ability unlocked by free-threaded Python, where multiple threads can be running Python code on different CPU cores at the same time—i.e.&nbsp;<em>simultaneously</em>. And thus, you’re performing work in <em>parallel</em>.</p>
<p>When I use the term <em>concurrent</em> or <em>concurrency</em>, I’m using it in the traditional sense within the context of Python: making progress on multiple things at a time. This term is well suited to describe things like web servers, where a single Python process, with a single thread, running on a single CPU core, can service multiple clients at any given time (by way of <a href="https://speakerdeck.com/trent/pyparallel-how-we-removed-the-gil-and-exploited-all-cores?slide=27">non-blocking socket I/O and event multiplexing</a>), but it’s not servicing any of those clients <em>simultaneously</em> on different cores, because that would require multiple threads running in <em>parallel</em>.</p>
<p>Some more details regarding <em>parallelism</em> vs <em>concurrency</em> can be found on <a href="https://speakerdeck.com/trent/parallelism-and-concurrency-with-python?slide=8">slide 8</a> of a deck I put together many years ago titled <a href="https://speakerdeck.com/trent/parallelism-and-concurrency-with-python">Parallelism and Concurrency in Python</a>.</p>
</div>
</div>
<p>So how do we test this out? I guess we could spin up some threads and have them all call <code>model.generate()</code>, but that’s a little boring.</p>
<p>Why not try implement a pure Python, multi-threaded <code>asyncio</code>-based HTTP server, expose a <code>/generate</code>-esque style <code>GET</code> endpoint, and wire that up to the model generation code we saw above, allowing us to serve web requests for generation in parallel, ideally in an <code>asyncio</code>-friendly manner, where we can stream individual tokens back one-by-one via HTTP’s chunked-encoding transfer protocol, giving each thread’s event loop the ability to service multiple clients <em>concurrently</em> in a reasonably fair manner, whilst also servicing many clients in <em>parallel</em> across all threads, and for kicks, get AI to whip up a janky little React Bootstrap UI that we can slap in front of it all to test it?</p>
<section id="pure-python-multi-threaded-http-server" class="level2">
<h2 class="anchored" data-anchor-id="pure-python-multi-threaded-http-server">Pure Python Multi-threaded HTTP Server</h2>
<p>First thing we need is a nice and simple <code>asyncio</code>-based HTTP server, that also happens to work with multi-threading now that we have a free-threaded Python at our disposal.</p>
<p>Luckily, I have one of those laying around already! In support of another article I’m actively working on (which was meant to get published before this post), I ported the <a href="https://github.com/pyparallel/pyparallel/blob/branches/3.3-px/Lib/async/http/server.py">HTTP Server</a> I wrote many years ago for <a href="https://pyparallel.org">PyParallel</a><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> to use the new <code>asyncio</code> facilities available with Python, and then slapped multiple threads on it, where each thread gets its own <code>asyncio</code> event loop.</p>
<p>Turns out, thankfully, that this Just Works, at least on Linux<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>—we can now have a pure Python HTTP server, running in a single Python process, that’ll happily saturate every CPU core under load.</p>
<p>The server code lives in <a href="https://github.com/tpn/parallelopedia/blob/main/src/parallelopedia/http/server.py"><code>parallelopedia.http.server</code></a>, and it includes a super janky little notion of <em>“HTTP Apps”</em>, the purpose of which can be best demonstrated with a simple example:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PlaintextApp(HttpApp):</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">@route</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plaintext(<span class="va">self</span>, request):</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> text_response(request, <span class="st">'Hello, World!'</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.server.send_response(response)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SleeperApp(HttpApp):</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">@route</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sleep(<span class="va">self</span>, request, seconds):</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="bu">int</span>(seconds))</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>        msg <span class="op">=</span> <span class="ss">f'Slept for </span><span class="sc">{</span>seconds<span class="sc">}</span><span class="ss"> seconds.'</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> text_response(request, msg)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.server.send_response(response)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a server with the two apps.</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>app_classes<span class="op">=</span>[PlaintextApp, SleeperApp]</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>server <span class="op">=</span> HttpServer(app_classes<span class="op">=</span>app_classes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In the above example, the HTTP server will route requests for the <code>/plaintext</code> endpoint to an instance of the <code>PlaintextApp</code>’s <code>plaintext()</code> routine, and <code>/sleep</code> requests get routed to the <code>SleeperApp</code>’s <code>sleep()</code> routine.</p>
<p>The <em>“slapped multiple threads on it”</em> activity I refered to earlier is handled by some new <a href="https://github.com/tpn/parallelopedia/blob/main/src/parallelopedia/http/server.py#L1344">async and threading scaffolding</a> added to the bottom of that module, with the pertinent pieces reproduced below:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> main_async(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    args: argparse.Namespace,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    protocol_class: <span class="bu">type</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>protocol_args: Tuple</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">    This is the main function for the server when it is running in</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co">    asynchronous mode.  It will create a server instance and then</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">    call serve_forever() on it.</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Arguments:</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co">        args (argparse.Namespace): Supplies the command-line arguments.</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co">        protocol_class (type): Supplies the protocol class to use.</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co">        protocol_args (tuple): Supplies the arguments to pass to the</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co">            protocol class constructor.</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    loop <span class="op">=</span> asyncio.get_running_loop()</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> os.name <span class="kw">in</span> (<span class="st">'nt'</span>, <span class="st">'cygwin'</span>):</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>        reuse_port <span class="op">=</span> <span class="va">False</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>        reuse_port <span class="op">=</span> <span class="va">True</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    reuse_address <span class="op">=</span> <span class="va">True</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    server <span class="op">=</span> <span class="cf">await</span> loop.create_server(</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span>: protocol_class(<span class="op">*</span>protocol_args),</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>        args.ip,</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>        args.port,</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>        backlog<span class="op">=</span>args.listen_backlog,</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>        reuse_address<span class="op">=</span>reuse_address,</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>        reuse_port<span class="op">=</span>reuse_port,</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="cf">with</span> server:</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">await</span> server.serve_forever()</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> start_event_loop(</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>    args: argparse.Namespace,</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>    protocol_class: <span class="bu">type</span>,</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>protocol_args: Tuple</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a><span class="co">    This function will start the asyncio event loop and run</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a><span class="co">    the main_async() function.  It is intended to be the</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a><span class="co">    target of a threading.Thread.</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a><span class="co">    Arguments:</span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a><span class="co">        args (argparse.Namespace): Supplies the command-line arguments.</span></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a><span class="co">        protocol_class (type): Supplies the protocol class to use.</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a><span class="co">        protocol_args (tuple): Supplies the arguments to pass to the</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a><span class="co">            protocol class constructor.</span></span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>    asyncio.run(</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>        main_async(</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>            args,</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>            protocol_class,</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>protocol_args,</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>        debug<span class="op">=</span>args.debug,</span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main_threaded_multi_accept(</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>    args: argparse.Namespace,</span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>    protocol_class: <span class="bu">type</span>,</span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>protocol_args: Tuple</span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a><span class="co">    This is the main function for the server when it is running in</span></span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a><span class="co">    multi-threaded mode with multiple accept sockets.  Each thread</span></span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a><span class="co">    will have its own asyncio loop issue a create_server() call for</span></span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a><span class="co">    the given host/port and protocol.</span></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a><span class="co">    Arguments:</span></span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a><span class="co">        args (argparse.Namespace): Supplies the command-line arguments.</span></span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a><span class="co">        protocol_class (type): Supplies the protocol class to use.</span></span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a><span class="co">        protocol_args (tuple): Supplies the arguments to pass to the</span></span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a><span class="co">            protocol class constructor.</span></span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> threading</span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a>    threads <span class="op">=</span> []</span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(args.threads):</span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a>        thread <span class="op">=</span> threading.Thread(</span>
<span id="cb39-98"><a href="#cb39-98" aria-hidden="true" tabindex="-1"></a>            target<span class="op">=</span>start_event_loop,</span>
<span id="cb39-99"><a href="#cb39-99" aria-hidden="true" tabindex="-1"></a>            args<span class="op">=</span>(args, protocol_class, <span class="op">*</span>protocol_args),</span>
<span id="cb39-100"><a href="#cb39-100" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb39-101"><a href="#cb39-101" aria-hidden="true" tabindex="-1"></a>        threads.append(thread)</span>
<span id="cb39-102"><a href="#cb39-102" aria-hidden="true" tabindex="-1"></a>        thread.start()</span>
<span id="cb39-103"><a href="#cb39-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-104"><a href="#cb39-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> thread <span class="kw">in</span> threads:</span>
<span id="cb39-105"><a href="#cb39-105" aria-hidden="true" tabindex="-1"></a>        thread.join()</span>
<span id="cb39-106"><a href="#cb39-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-107"><a href="#cb39-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-108"><a href="#cb39-108" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(args: Optional[argparse.Namespace] <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb39-109"><a href="#cb39-109" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-110"><a href="#cb39-110" aria-hidden="true" tabindex="-1"></a><span class="co">    Main entry point for parallelopedia.http.server module.</span></span>
<span id="cb39-111"><a href="#cb39-111" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-112"><a href="#cb39-112" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parse_arguments()</span>
<span id="cb39-113"><a href="#cb39-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-114"><a href="#cb39-114" aria-hidden="true" tabindex="-1"></a>    logging.basicConfig(</span>
<span id="cb39-115"><a href="#cb39-115" aria-hidden="true" tabindex="-1"></a>        level<span class="op">=</span><span class="bu">getattr</span>(logging, args.log_level),</span>
<span id="cb39-116"><a href="#cb39-116" aria-hidden="true" tabindex="-1"></a>        <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span>,</span>
<span id="cb39-117"><a href="#cb39-117" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-118"><a href="#cb39-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-119"><a href="#cb39-119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use multiple threads to load the application classes.</span></span>
<span id="cb39-120"><a href="#cb39-120" aria-hidden="true" tabindex="-1"></a>    app_classes <span class="op">=</span> get_classes_from_strings_parallel(</span>
<span id="cb39-121"><a href="#cb39-121" aria-hidden="true" tabindex="-1"></a>        args.app_classes,</span>
<span id="cb39-122"><a href="#cb39-122" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-123"><a href="#cb39-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-124"><a href="#cb39-124" aria-hidden="true" tabindex="-1"></a>    protocol_class <span class="op">=</span> get_class_from_string(args.protocol_class)</span>
<span id="cb39-125"><a href="#cb39-125" aria-hidden="true" tabindex="-1"></a>    protocol_args <span class="op">=</span> (app_classes,)</span>
<span id="cb39-126"><a href="#cb39-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-127"><a href="#cb39-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.threads <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb39-128"><a href="#cb39-128" aria-hidden="true" tabindex="-1"></a>        asyncio.run(</span>
<span id="cb39-129"><a href="#cb39-129" aria-hidden="true" tabindex="-1"></a>            main_async(</span>
<span id="cb39-130"><a href="#cb39-130" aria-hidden="true" tabindex="-1"></a>                args,</span>
<span id="cb39-131"><a href="#cb39-131" aria-hidden="true" tabindex="-1"></a>                protocol_class,</span>
<span id="cb39-132"><a href="#cb39-132" aria-hidden="true" tabindex="-1"></a>                <span class="op">*</span>protocol_args,</span>
<span id="cb39-133"><a href="#cb39-133" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb39-134"><a href="#cb39-134" aria-hidden="true" tabindex="-1"></a>            debug<span class="op">=</span>args.debug,</span>
<span id="cb39-135"><a href="#cb39-135" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb39-136"><a href="#cb39-136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-137"><a href="#cb39-137" aria-hidden="true" tabindex="-1"></a>        main_threaded_multi_accept(</span>
<span id="cb39-138"><a href="#cb39-138" aria-hidden="true" tabindex="-1"></a>            args,</span>
<span id="cb39-139"><a href="#cb39-139" aria-hidden="true" tabindex="-1"></a>            protocol_class,</span>
<span id="cb39-140"><a href="#cb39-140" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>protocol_args,</span>
<span id="cb39-141"><a href="#cb39-141" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb39-142"><a href="#cb39-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-143"><a href="#cb39-143" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb39-144"><a href="#cb39-144" aria-hidden="true" tabindex="-1"></a>    main()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="gpt2-http-app" class="level2">
<h2 class="anchored" data-anchor-id="gpt2-http-app">GPT2 HTTP App</h2>
<p>With the HTTP server scaffolding in place, we can now whip up a little <code>Gpt2App</code> class that has a <code>generate()</code> method. Incoming requests to the <code>/generate</code> endpoint will be routed to that routine by the server.</p>
<section id="synchronous-up-front-generation" class="level3">
<h3 class="anchored" data-anchor-id="synchronous-up-front-generation">Synchronous Up-Front Generation</h3>
<p>Now, we could take the simple approach, where the <code>Gpt2App.generate()</code> call goes off and calls <code>model.generate()</code> and then patiently waits for the entire response to be generated before sending anything back to the user.</p>
<p>That code would look something like this:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Gpt2App(HttpApp):</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">@route</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate(<span class="va">self</span>, request: Request,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                 <span class="op">*</span>args: List,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                 <span class="op">**</span>kwds: Dict) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>        prompt <span class="op">=</span> args[<span class="dv">0</span>]</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> get_model()</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> model.generate(prompt<span class="op">=</span>prompt)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>        respose <span class="op">=</span> text_response(request, result)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.server.send_response(response)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>But when have you ever interacted with an LLM via a web interface where it waits until it generates <em>all</em> of the response up-front before sending it back to you? Never; you can see it generate the response in real time, and that’s what we want to mimic here in this experiment.</p>
</section>
<section id="our-goals" class="level3">
<h3 class="anchored" data-anchor-id="our-goals">Our Goals</h3>
<p>The high-level goals for our solution are thus:</p>
<ol type="1">
<li><p>We want to send a generated token back to the user as soon as it becomes available.</p></li>
<li><p>We want to ensure the client receiving the token can display it as soon as they receive it—so we need to be cognizant of what HTTP transfer protocol we use to send bytes back. If we just used normal HTTP transfer encoding, the client would wait until we’ve sent <em>everything</em> before the user sees it, despite the fact that we’ve been trickling individual tokens to them the entire time.</p></li>
<li><p>We want to play nicely with the <code>asyncio</code> ecosystem upon which our hosting HTTP server is based—so we need to be cognizant of the current thread’s event loop, and make sure we don’t impede that thread’s ability to <em>concurrently</em> serve other clients that are being handled by the event loop.</p></li>
</ol>
<p>Thankfully, as we saw earlier with the implementation of the <code>GPT.generate()</code> routine, generating tokens in response to a prompt is inherently a <em>token-by-token</em> process. So the algorithm at least provides us with the means to obtain a single token at a time, which takes care of the first point.</p>
<p>Second, HTTP’s chunked-encoding transfer protocol will allow a HTTP client to immediately <em>“see”</em> the tokens we send back to it as soon as we send them, provided we enable <code>TCP_NODELAY</code> on the underlying socket to ensure the operating system sends the bytes out to the client as soon as we send them.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If we didn’t do this, the default behavior of <a href="https://en.wikipedia.org/wiki/Nagle%27s_algorithm">Nagle’s algorithm</a> would apply, and the operating system would delay sending individual bytes back when we request, in the hope that it can accumulate more bytes to send all at once at a slightly later point in time. This is advantageous for maximizing throughput, but it impedes latency, and in our case, we want the lower latency afforded by immediately sending the bytes back to the client as soon as we generate them.</p>
</div>
</div>
<p><a href="https://en.wikipedia.org/wiki/Chunked_transfer_encoding">Chunked-encoding</a> works by setting an HTTP response header <code>Transfer-Encoding: chunked</code>, and then in the body, each chunk is transmitted by its length and then the chunk itself. The server communicates to the client that the transfer has completed once a zero-length chunk is received.</p>
<p>So, as long as we send our tokens back via chunked-encoding, any HTTP/1.1 client will be able to reassemble them back into the generated text, giving the visual appearance of real time model generation. That will take care of the second point.</p>
<p>Lastly, in order to play nice within the greater <code>asyncio</code> ecosystem, we need to give control back to the underlying thread’s <code>asyncio</code> event loop after we generate a token and yield a decoded text fragment, which can thankfully be done via a simple call to <code>await asyncio.sleep(0)</code>, provided we’re generating text from the model from within an <code>async</code> callback.</p>
<p>This ensures multiple <em>concurrent</em> clients being handled by our thread’s event loop will be handled fairly; they’ll all receive generated tokens at the same rate.</p>
</section>
<section id="asynchronous-token-by-token-generation" class="level3">
<h3 class="anchored" data-anchor-id="asynchronous-token-by-token-generation">Asynchronous Token-by-Token Generation</h3>
<p>The first thing we need to do is to change our <code>Gpt2App.generate()</code> call into something that is <code>async</code> compatible, in anticipation of some later code that we write needing to issue an <code>await asyncio.sleep(0)</code>, which can only be done within a call frame of an asynchronous method.</p>
<p>When our <code>Gpt2App.generate()</code> routine is called, we’re still within the context of the <code>asyncio</code> protocol’s <code>data_received()</code> routine, which is a normal, synchronous method, <em>not</em> an enlightened <code>async</code> method that can participate in an <code>asyncio</code> event loop.</p>
<p>So, in order to transition from a synchronous callback to an asynchronous one, we can use the current event loop’s <code>create_task()</code> routine to enqueue an <code>async</code> method for execution.</p>
<section id="step-1-have-generate-enqueue-an-async-generate_response." class="level4">
<h4 class="anchored" data-anchor-id="step-1-have-generate-enqueue-an-async-generate_response.">Step 1: Have generate() enqueue an async generate_response().</h4>
<p>Thus, our <code>Gpt2App.generate()</code> call will look something like this:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Gpt2App(HttpApp):</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">@route</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate(<span class="va">self</span>, request: Request,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                 <span class="op">*</span>args: List,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                 <span class="op">**</span>kwds: Dict) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract the "prompt" provided in the incoming request.</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> args[<span class="dv">0</span>]</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Obtain the event loop and schedule the response</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># generation via our async generation coroutine.</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># We have to do it like this as at this point we're</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># still within the call frame of the data_received()</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># protocol callback, which isn't an async function.</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>        loop <span class="op">=</span> asyncio.get_running_loop()</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>        async_task <span class="op">=</span> <span class="va">self</span>.generate_response(request, text, <span class="op">**</span>kwds)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>        loop.create_task(async_task)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-2-implement-an-async-generate_response" class="level4">
<h4 class="anchored" data-anchor-id="step-2-implement-an-async-generate_response">Step 2: Implement an async generate_response()</h4>
<p>Our asynchronous <code>generate_response()</code> routine will be the bridge between generating tokens from the model, and sending those tokens back to the client via chunked-encoding.</p>
<p>It is responsible for preparing the response to use chunked-encoding, and then enabling <code>TCP_NODELAY</code> on the socket.</p>
<p>Then, assuming that our model has an <code>async_generate_for()</code> routine, which we’ll implement in the next step, we perform an <code>async for</code> loop over that routine in order to obtain individual <em>decoded</em> tokens. As soon as we receive a token, we can send it back to the client via the <code>response</code> object’s <code>send_chunk()</code> routine.</p>
<p>Once we’ve exhausted the async generator (i.e.&nbsp;it either generated the maximum number of requested tokens, or it encountered a stop token), we can re-enable <code>TCP_NODELAY</code>, and then return.</p>
<p>A simplified version of the Python code is presented below. I have omitted most of the error handling and query parameter parsing code for simplicity; see the expandable code block at the end for the full version.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Gpt2App(HttpApp):</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> generate_response(</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>, request: Request,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>        prompt: <span class="bu">str</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">**</span>kwds: Dict</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Prepare a chunked-encoding response.</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> request.response</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>        response.code <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>        response.message <span class="op">=</span> <span class="st">'OK'</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        response.chunked_response <span class="op">=</span> <span class="va">True</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>        response.content_type <span class="op">=</span> <span class="st">'text/plain'</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Obtain the model.</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> get_model()</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># We want to enable TCP_NODELAY for the duration of</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the response.  This ensures packets are sent</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># immediately without any internal buffering.</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>            response.enable_tcp_nodelay()</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>            enabled_nodelay <span class="op">=</span> <span class="va">True</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f'Error enabling TCP_NODELAY: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>            enabled_nodelay <span class="op">=</span> <span class="va">False</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Write the chunked header immediately.</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>        response_bytes <span class="op">=</span> <span class="bu">bytes</span>(response)</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.write(response_bytes):</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Encountered a disconnect, return.</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># N.B. From herein, all data must be transferred to</span></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">#      the client via chunked encoding with the</span></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>        <span class="co">#      `response.send_chunk()` routine.</span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send the initial prompt text.</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>        response.send_chunk(prompt)</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Obtain decoded tokens from the model one at a time</span></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># via an `async for` loop, sending the token back to</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the client as soon as it's available.</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">async</span> <span class="cf">for</span> decoded_token <span class="kw">in</span> model.generate_async_for(prompt):</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>            response.send_chunk(decoded_token)</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Terminate the chunked-encoding response.</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>        response.end_chunks()</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Disable TCP_NODELAY now that the response is complete.</span></span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># The reasoning behind this is that the client may have</span></span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># issued the HTTP request with a keep-alive header, and</span></span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># plans on reusing this connection for a different request</span></span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># next, which won't necessarily want `TCP_NODELAY` active.</span></span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> enabled_nodelay:</span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>            response.disable_tcp_nodelay()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="gpt2app-generate-response-full" class="callout callout-style-simple callout-note no-icon callout-titled" title="Full Code for async Gpt2App.generate_response()">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Full Code for async Gpt2App.generate_response()
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The actual code has more robust error-handling facilities and support for extracting the query string parameters from the incoming request URI and converting them into keyword arguments suitable for passing to the model.</p>
<p>Additionally, we haven’t touched on how we initialize or obtain instances of our models yet, so the model-related code won’t make much sense until later in the article.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Gpt2App(HttpApp):</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    routes <span class="op">=</span> make_routes()</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    route <span class="op">=</span> router(routes)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, server: HttpServer) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(server)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.printable <span class="op">=</span> PRINTABLE</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> is_connected(<span class="va">self</span>):</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># server.transport will be severed when the client</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># disconnects, so we can use this to determine if</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the client is still connected.</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>        server <span class="op">=</span> <span class="va">self</span>.server</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>        transport <span class="op">=</span> <span class="va">None</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>            transport <span class="op">=</span> server.transport</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">AttributeError</span>:</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> transport <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> write(<span class="va">self</span>, response_bytes):</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>        server <span class="op">=</span> <span class="va">self</span>.server</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>        transport <span class="op">=</span> <span class="va">None</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>            transport <span class="op">=</span> server.transport</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">AttributeError</span>:</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> transport <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>            transport.write(response_bytes)</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> generate_response(</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>, request: Request, prompt: <span class="bu">str</span>, <span class="op">**</span>kwds: Dict</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> request.response</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>        response.code <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>        response.message <span class="op">=</span> <span class="st">'OK'</span></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>        response.chunked_response <span class="op">=</span> <span class="va">True</span></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>        response.content_type <span class="op">=</span> <span class="st">'text/plain'</span></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kwds <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>            kwds <span class="op">=</span> {}</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>        max_length <span class="op">=</span> <span class="bu">min</span>(<span class="bu">int</span>(kwds.get(<span class="st">'max_length'</span>, <span class="dv">100</span>) <span class="kw">or</span> <span class="dv">100</span>), <span class="dv">1024</span>)</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>        top_k <span class="op">=</span> <span class="bu">min</span>(<span class="bu">int</span>(kwds.get(<span class="st">'top_k'</span>, <span class="dv">50</span>) <span class="kw">or</span> <span class="dv">50</span>), <span class="dv">50</span>)</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>        seed <span class="op">=</span> kwds.get(<span class="st">'seed'</span>, <span class="va">None</span>)</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> seed:</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>                seed <span class="op">=</span> <span class="bu">int</span>(seed)</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>                seed <span class="op">=</span> <span class="va">None</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> seed:</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>            seed <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="dv">2</span><span class="op">**</span><span class="dv">32</span> <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>        device <span class="op">=</span> kwds.get(<span class="st">'device'</span>, <span class="va">None</span>)</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>        model_name <span class="op">=</span> kwds.get(<span class="st">'model'</span>, <span class="va">None</span>)</span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model_name <span class="op">==</span> <span class="st">'gpt2-xl'</span>:</span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>            models <span class="op">=</span> PRETRAINED_MODELS</span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>            get_next <span class="op">=</span> get_next_pretrained_model</span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a>            model_name <span class="op">=</span> <span class="st">'gpt2'</span></span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a>            models <span class="op">=</span> MODELS</span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a>            get_next <span class="op">=</span> get_next_model</span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> <span class="va">None</span></span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> device <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> device <span class="op">==</span> <span class="st">'cpu'</span>:</span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a>                model <span class="op">=</span> models[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> device.startswith(<span class="st">'cuda:'</span>):</span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a>                    index <span class="op">=</span> <span class="bu">int</span>(device[<span class="dv">5</span>:])</span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a>                    index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> index <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> index <span class="op">&gt;=</span> NUM_GPUS:</span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a>                    index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb43-81"><a href="#cb43-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> index <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb43-82"><a href="#cb43-82" aria-hidden="true" tabindex="-1"></a>                    model <span class="op">=</span> models[index]</span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> device <span class="op">==</span> <span class="st">'cuda'</span>:</span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a>                model <span class="op">=</span> models[random.randint(<span class="dv">0</span>, NUM_GPUS <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb43-85"><a href="#cb43-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-86"><a href="#cb43-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> model:</span>
<span id="cb43-87"><a href="#cb43-87" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Get a model.  If there are multiple models available, e.g. if we</span></span>
<span id="cb43-88"><a href="#cb43-88" aria-hidden="true" tabindex="-1"></a>            <span class="co"># have multiple GPUs, this will balance the load a bit.</span></span>
<span id="cb43-89"><a href="#cb43-89" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> get_next()</span>
<span id="cb43-90"><a href="#cb43-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-91"><a href="#cb43-91" aria-hidden="true" tabindex="-1"></a>        expose_headers <span class="op">=</span> (</span>
<span id="cb43-92"><a href="#cb43-92" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Access-Control-Expose-Headers: '</span></span>
<span id="cb43-93"><a href="#cb43-93" aria-hidden="true" tabindex="-1"></a>            <span class="st">'X-Max-Length, '</span></span>
<span id="cb43-94"><a href="#cb43-94" aria-hidden="true" tabindex="-1"></a>            <span class="st">'X-Top-K, '</span></span>
<span id="cb43-95"><a href="#cb43-95" aria-hidden="true" tabindex="-1"></a>            <span class="st">'X-Seed, '</span></span>
<span id="cb43-96"><a href="#cb43-96" aria-hidden="true" tabindex="-1"></a>            <span class="st">'X-Model-Name, '</span></span>
<span id="cb43-97"><a href="#cb43-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">'X-Model-Device'</span></span>
<span id="cb43-98"><a href="#cb43-98" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb43-99"><a href="#cb43-99" aria-hidden="true" tabindex="-1"></a>        response.other_headers.extend([</span>
<span id="cb43-100"><a href="#cb43-100" aria-hidden="true" tabindex="-1"></a>            expose_headers,</span>
<span id="cb43-101"><a href="#cb43-101" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'X-Max-Length: </span><span class="sc">{</span>max_length<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb43-102"><a href="#cb43-102" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'X-Top-K: </span><span class="sc">{</span>top_k<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb43-103"><a href="#cb43-103" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'X-Seed: </span><span class="sc">{</span>seed<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb43-104"><a href="#cb43-104" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'X-Model-Name: </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb43-105"><a href="#cb43-105" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'X-Model-Device: </span><span class="sc">{</span>model<span class="sc">.</span>device<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb43-106"><a href="#cb43-106" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb43-107"><a href="#cb43-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-108"><a href="#cb43-108" aria-hidden="true" tabindex="-1"></a>        <span class="co"># We want to enable TCP_NODELAY for the duration of</span></span>
<span id="cb43-109"><a href="#cb43-109" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the response.  This ensures packets are sent</span></span>
<span id="cb43-110"><a href="#cb43-110" aria-hidden="true" tabindex="-1"></a>        <span class="co"># immediately without any internal buffering.</span></span>
<span id="cb43-111"><a href="#cb43-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb43-112"><a href="#cb43-112" aria-hidden="true" tabindex="-1"></a>            response.enable_tcp_nodelay()</span>
<span id="cb43-113"><a href="#cb43-113" aria-hidden="true" tabindex="-1"></a>            enabled_nodelay <span class="op">=</span> <span class="va">True</span></span>
<span id="cb43-114"><a href="#cb43-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb43-115"><a href="#cb43-115" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f'Error enabling TCP_NODELAY: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb43-116"><a href="#cb43-116" aria-hidden="true" tabindex="-1"></a>            enabled_nodelay <span class="op">=</span> <span class="va">False</span></span>
<span id="cb43-117"><a href="#cb43-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-118"><a href="#cb43-118" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Write the chunked header immediately.</span></span>
<span id="cb43-119"><a href="#cb43-119" aria-hidden="true" tabindex="-1"></a>        response_bytes <span class="op">=</span> <span class="bu">bytes</span>(response)</span>
<span id="cb43-120"><a href="#cb43-120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.write(response_bytes):</span>
<span id="cb43-121"><a href="#cb43-121" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Encountered a disconnect, return.</span></span>
<span id="cb43-122"><a href="#cb43-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb43-123"><a href="#cb43-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-124"><a href="#cb43-124" aria-hidden="true" tabindex="-1"></a>        <span class="co"># N.B. From herein, all data must be transferred to</span></span>
<span id="cb43-125"><a href="#cb43-125" aria-hidden="true" tabindex="-1"></a>        <span class="co">#      the client via chunked encoding with the</span></span>
<span id="cb43-126"><a href="#cb43-126" aria-hidden="true" tabindex="-1"></a>        <span class="co">#      `response.send_chunk()` routine.</span></span>
<span id="cb43-127"><a href="#cb43-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-128"><a href="#cb43-128" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send the initial prompt text.</span></span>
<span id="cb43-129"><a href="#cb43-129" aria-hidden="true" tabindex="-1"></a>        response.send_chunk(prompt)</span>
<span id="cb43-130"><a href="#cb43-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-131"><a href="#cb43-131" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Obtain an async generator instance to the model's</span></span>
<span id="cb43-132"><a href="#cb43-132" aria-hidden="true" tabindex="-1"></a>        <span class="co"># new async token generation routine.</span></span>
<span id="cb43-133"><a href="#cb43-133" aria-hidden="true" tabindex="-1"></a>        generate_tokens <span class="op">=</span> model.generate_async_for(</span>
<span id="cb43-134"><a href="#cb43-134" aria-hidden="true" tabindex="-1"></a>            prompt,</span>
<span id="cb43-135"><a href="#cb43-135" aria-hidden="true" tabindex="-1"></a>            max_length<span class="op">=</span>max_length,</span>
<span id="cb43-136"><a href="#cb43-136" aria-hidden="true" tabindex="-1"></a>            top_k<span class="op">=</span>top_k,</span>
<span id="cb43-137"><a href="#cb43-137" aria-hidden="true" tabindex="-1"></a>            seed<span class="op">=</span>seed,</span>
<span id="cb43-138"><a href="#cb43-138" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb43-139"><a href="#cb43-139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">async</span> <span class="cf">for</span> decoded_token <span class="kw">in</span> generate_tokens:</span>
<span id="cb43-140"><a href="#cb43-140" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> decoded_token <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb43-141"><a href="#cb43-141" aria-hidden="true" tabindex="-1"></a>                <span class="co"># A non-printable token was generated,</span></span>
<span id="cb43-142"><a href="#cb43-142" aria-hidden="true" tabindex="-1"></a>                <span class="co"># terminating generation.</span></span>
<span id="cb43-143"><a href="#cb43-143" aria-hidden="true" tabindex="-1"></a>                response.send_chunk(</span>
<span id="cb43-144"><a href="#cb43-144" aria-hidden="true" tabindex="-1"></a>                    OOPS_NON_PRINTABLE_ENCOUNTERED</span>
<span id="cb43-145"><a href="#cb43-145" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb43-146"><a href="#cb43-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb43-147"><a href="#cb43-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-148"><a href="#cb43-148" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If the client has forcibly disconnected,</span></span>
<span id="cb43-149"><a href="#cb43-149" aria-hidden="true" tabindex="-1"></a>            <span class="co"># terminate generation.</span></span>
<span id="cb43-150"><a href="#cb43-150" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.is_connected():</span>
<span id="cb43-151"><a href="#cb43-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb43-152"><a href="#cb43-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-153"><a href="#cb43-153" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Otherwise, send the decoded token to the client</span></span>
<span id="cb43-154"><a href="#cb43-154" aria-hidden="true" tabindex="-1"></a>            <span class="co"># via chunked encoding.</span></span>
<span id="cb43-155"><a href="#cb43-155" aria-hidden="true" tabindex="-1"></a>            response.send_chunk(decoded_token)</span>
<span id="cb43-156"><a href="#cb43-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-157"><a href="#cb43-157" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send the termination chunk.  This may fail at the</span></span>
<span id="cb43-158"><a href="#cb43-158" aria-hidden="true" tabindex="-1"></a>        <span class="co"># socket.send() level if the client has already</span></span>
<span id="cb43-159"><a href="#cb43-159" aria-hidden="true" tabindex="-1"></a>        <span class="co"># disconnected, which is harmless.</span></span>
<span id="cb43-160"><a href="#cb43-160" aria-hidden="true" tabindex="-1"></a>        response.end_chunks()</span>
<span id="cb43-161"><a href="#cb43-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-162"><a href="#cb43-162" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Disable TCP_NODELAY now that the response is complete.</span></span>
<span id="cb43-163"><a href="#cb43-163" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Again, this may fail at the socket level if the client</span></span>
<span id="cb43-164"><a href="#cb43-164" aria-hidden="true" tabindex="-1"></a>        <span class="co"># has already disconnected, which is harmless.</span></span>
<span id="cb43-165"><a href="#cb43-165" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> enabled_nodelay:</span>
<span id="cb43-166"><a href="#cb43-166" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb43-167"><a href="#cb43-167" aria-hidden="true" tabindex="-1"></a>                response.disable_tcp_nodelay()</span>
<span id="cb43-168"><a href="#cb43-168" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb43-169"><a href="#cb43-169" aria-hidden="true" tabindex="-1"></a>                msg <span class="op">=</span> <span class="ss">f'Error disabling TCP_NODELAY: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb43-170"><a href="#cb43-170" aria-hidden="true" tabindex="-1"></a>                logging.error(msg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-implement-an-async-gpt.async_generate_for" class="level4">
<h4 class="anchored" data-anchor-id="step-3-implement-an-async-gpt.async_generate_for">Step 3: Implement an async GPT.async_generate_for()</h4>
<p>In the code example above, we assumed the <code>GPT</code> model we’ve been using had grown a new <code>async</code> routine named <code>async_generate_for()</code>, which we’ll cover now.</p>
<p>This routine is essentially an <code>asyncio</code>-friendly version of the original <code>generate()</code> routine we wrote. It shares a lot of the same code, with a few notable tweaks in order to support the fact that it is being called from a callback that was enqueued on a thread’s <code>asyncio</code> event loop, and it is expected to yield a token as soon as it is available, and then pass control back to the event loop in order for it to service other clients before it continues with generating the next token.</p>
<p>It also has the notion of checking for <em>“printable”</em> characters. This came about when I was initially testing this code via <code>curl</code> which would sometimes balk and exit in the middle of streaming the response, citing that it encountered corrupted data or something like that.</p>
<p>After investigation, it turned out that sometimes, for whatever reason, the model just generates a junk, nonsensical token (like 65534, which is well outside the highest token number of 50384). I have no idea why it happens, although I’ll note it happens on the OpenAI GPT2 XL model available on HuggingFace (which we’ll discuss later) too, so, eh.</p>
<p>I deal with this by checking if we’ve generated a non-printable token after decoding it, and, if so, return -1 and terminate the loop. The <a href="#gpt2app-generate-response-full">full version</a> of the <code>Gpt2App.generate_response()</code> routine that we introduced above checks if we return -1, and if so, terminates generation with an oopsie message, e.g.:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>OOPS_NON_PRINTABLE_ENCOUNTERED <span class="op">=</span> (</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Oops! Non-printable token encountered.  Generation terminated.'</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="cf">for</span> decoded_token <span class="kw">in</span> generate_tokens:</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> decoded_token <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># A non-printable token was generated,</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># terminating generation.</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>        response.send_chunk(</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>            OOPS_NON_PRINTABLE_ENCOUNTERED</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After yielding a valid decoded token, we issue an <code>await asyncio.sleep(0)</code> call, which returns control back to the event loop for it to potentially handle other concurrent clients. If there are no other clients, or after it has handled all other enqueued work, generation resumes.</p>
<p>The full code follows, it is simple enough as-is that I didn’t feel the need to omit any details like in the prior example.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GPT:</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> generate_async_for(</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>, text: <span class="bu">str</span>, max_length: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1024</span>, top_k: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        seed: <span class="bu">int</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Asynchronously generate text from the model, yielding tokens</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co">        one at a time as soon as they are available.</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co">            text (str): Supplies the prompt.</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co">            max_length (int): Supplies the maximum total length,</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co">                including prompt.</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co">            top_k (int): Supplies the number of tokens to consider</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="co">                at each generation step.</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co">            seed (int): Optionally supplies the manual seed to use</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="co">                for the generator.  If None, the model's manual</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="co">                seed will be used.</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="co">        Yields:</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="co">            byte: The newly generated decoded token.  If -1, a</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="co">            non-printable token was generated, and generation</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="co">            was terminated.</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>        enc <span class="op">=</span> <span class="va">self</span>.enc</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>        stop_token <span class="op">=</span> <span class="va">self</span>.stop_token</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Encode the prompt -&gt; tensor of shape (1, T)</span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>        tokens <span class="op">=</span> enc.encode(text)</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.tensor(</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>            tokens, dtype<span class="op">=</span>torch.<span class="bu">long</span>, device<span class="op">=</span><span class="va">self</span>.device</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>        ).unsqueeze(<span class="dv">0</span>)</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>        sample_rng <span class="op">=</span> torch.Generator(device<span class="op">=</span><span class="va">self</span>.device)</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> seed <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>            seed <span class="op">=</span> <span class="va">self</span>.manual_seed</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>        sample_rng.manual_seed(seed)</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>        logging.debug(</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'[generate_async_for] Starting generation loop for </span><span class="sc">{</span>text<span class="sc">}</span><span class="ss"> '</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'with seed </span><span class="sc">{</span>seed<span class="sc">}</span><span class="ss">.'</span></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>        start_time <span class="op">=</span> time.perf_counter()</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> x.size(<span class="dv">1</span>) <span class="op">&lt;</span> max_length:</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>            count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> torch.no_grad():</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Forward pass, ignoring the returned loss.</span></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>                (logits, _) <span class="op">=</span> <span class="va">self</span>(x)</span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Take the logits at the last time-step (shape:</span></span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (1, vocab_size)).</span></span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>            logits <span class="op">=</span> logits[:, <span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Convert to probabilities.</span></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>            probs <span class="op">=</span> F.softmax(logits, dim<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Top-k sampling.</span></span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a>            topk_probs, topk_indices <span class="op">=</span> torch.topk(</span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a>                probs, k<span class="op">=</span>top_k, dim<span class="op">=-</span><span class="dv">1</span>,</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Sample the next token.</span></span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a>            next_idx <span class="op">=</span> torch.multinomial(</span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a>                topk_probs,</span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a>                num_samples<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a>                generator<span class="op">=</span>sample_rng,</span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a>            next_token <span class="op">=</span> torch.gather(topk_indices, <span class="op">-</span><span class="dv">1</span>, next_idx)</span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If the next token is the stop token, we're done.</span></span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a>            next_token_item <span class="op">=</span> next_token.item()</span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> next_token_item <span class="op">==</span> stop_token:</span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Append token to current sequence.  Although we only</span></span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a>            <span class="co"># yield a singular decoded token below, we still need</span></span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a>            <span class="co"># to keep track of the entire sequence for subsequent</span></span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a>            <span class="co"># generation steps.</span></span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> torch.cat((x, next_token), dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Decode the newly-generated token.  Note that a single</span></span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a>            <span class="co"># token will often be decoded to multiple characters.</span></span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a>            new_text_fragment <span class="op">=</span> enc.decode([next_token.item()])</span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If any of the characters in the decoded text</span></span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a>            <span class="co"># representation aren't printable, terminate</span></span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a>            <span class="co"># generation.</span></span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">all</span>(c <span class="kw">in</span> <span class="va">self</span>.printable <span class="cf">for</span> c <span class="kw">in</span> new_text_fragment):</span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb45-103"><a href="#cb45-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-104"><a href="#cb45-104" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> new_text_fragment</span>
<span id="cb45-105"><a href="#cb45-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-106"><a href="#cb45-106" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Yield control back to the event loop before continuing</span></span>
<span id="cb45-107"><a href="#cb45-107" aria-hidden="true" tabindex="-1"></a>            <span class="co"># generation.  If we didn't do this, this client would</span></span>
<span id="cb45-108"><a href="#cb45-108" aria-hidden="true" tabindex="-1"></a>            <span class="co"># hog the thread's event loop, preventing other clients</span></span>
<span id="cb45-109"><a href="#cb45-109" aria-hidden="true" tabindex="-1"></a>            <span class="co"># associated with the loop from getting serviced.  (As</span></span>
<span id="cb45-110"><a href="#cb45-110" aria-hidden="true" tabindex="-1"></a>            <span class="co"># we're now running multiple threads in parallel, other</span></span>
<span id="cb45-111"><a href="#cb45-111" aria-hidden="true" tabindex="-1"></a>            <span class="co"># clients associated with event loops on other threads</span></span>
<span id="cb45-112"><a href="#cb45-112" aria-hidden="true" tabindex="-1"></a>            <span class="co"># would not be impacted.)</span></span>
<span id="cb45-113"><a href="#cb45-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">await</span> asyncio.sleep(<span class="dv">0</span>)</span>
<span id="cb45-114"><a href="#cb45-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-115"><a href="#cb45-115" aria-hidden="true" tabindex="-1"></a>        elapsed <span class="op">=</span> time.perf_counter() <span class="op">-</span> start_time</span>
<span id="cb45-116"><a href="#cb45-116" aria-hidden="true" tabindex="-1"></a>        logging.debug(</span>
<span id="cb45-117"><a href="#cb45-117" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"[generate_async_for] Generated </span><span class="sc">{</span>count<span class="sc">}</span><span class="ss"> tokens in "</span></span>
<span id="cb45-118"><a href="#cb45-118" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"</span><span class="sc">{</span>elapsed<span class="sc">:.2f}</span><span class="ss"> seconds (~</span><span class="sc">{</span>count <span class="op">/</span> elapsed<span class="sc">:.2f}</span><span class="ss"> tok/s)"</span></span>
<span id="cb45-119"><a href="#cb45-119" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This routine was the last piece we needed to implement to satisfy <a href="#our-goals">our three goals</a> captured earlier, so, we’re now ready to test it out!</p>
</section>
</section>
</section>
<section id="test-drive" class="level2">
<h2 class="anchored" data-anchor-id="test-drive">Test Drive!</h2>
<section id="launching-the-http-server" class="level3">
<h3 class="anchored" data-anchor-id="launching-the-http-server">Launching the HTTP Server</h3>
<p>We can launch an instance of our multi-threaded HTTP web server with our new <code>Gpt2App</code> HTTP application via the command line as follows:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> python <span class="at">-Xgil</span><span class="op">=</span>0 <span class="at">-m</span> parallelopedia.http.server  <span class="dt">\</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">--threads</span> 40 <span class="at">--ip</span> 0.0.0.0 <span class="at">--port</span> 4444       <span class="dt">\</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--app-classes</span> parallelopedia.gpt2.Gpt2App   <span class="dt">\</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                  parallelopedia.http.server.PlaintextApp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This will start up a multi-threaded HTTP server listening on all interfaces on port 4444, with 40 threads, and two HTTP applications: our <code>Gpt2App</code>, which will service requests to the <code>/generate</code> endpoint, and a <code>PlaintextApp</code> that just returns “Hello, World!” to any incoming request received for the <code>/plaintext</code> endpoint.</p>
</section>
<section id="visualizing-chunked-encoding" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-chunked-encoding">Visualizing Chunked-Encoding</h3>
<p>Let’s visualize the generation response in a way that shows us the raw chunked-encoding, without doing any client-side reassembly. We can achieve that with <code>echo</code> and <code>netcat</code> (<code>nc</code>):</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> echo <span class="at">-en</span> <span class="dt">\</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'GET /generate/The%20quick%20brown%20fox?max_length=20&amp;device=cuda&amp;seed=42 '</span> <span class="dt">\</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'HTTP/1.1\r\nConnection: close\r\nHost: dgx\r\n\r\n'</span> <span class="kw">|</span> <span class="ex">nc</span> dgx 4444</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>That should yield the following raw output:</p>
<pre><code>HTTP/1.1 200 OK
Server: Parallelopedia Web Server v1.0
Date: Fri, 07 Feb 2025 23:32:02 GMT
Accept-Ranges: bytes
Content-Type: text/plain
Access-Control-Allow-Origin: *
Connection: close
Transfer-Encoding: chunked
Access-Control-Expose-Headers: X-Max-Length, X-Top-K, X-Seed, X-Model-Name, X-Model-Device
X-Max-Length: 20
X-Top-K: 50
X-Seed: 42
X-Model-Name: gpt2
X-Model-Device: cuda:0

13
The quick brown fox
3
 is
2
 a
4
 sub
7
species
5
 that
B
 originated
3
 in
9
 southern
9
 Scotland
3
 as
2
 a
8
 variety
3
 of
4
 fox
1
.
5
 This
0
</code></pre>
<p>As you can see, we’ve enabled chunked-encoding by way of the <code>Transfer-Encoding: chunked</code> header. And the body of the response is comprised of these <em>“chunks”</em>; specifically, each bit of decoded text is preceded by its length, in bytes, then followed by <code>\r\n</code>, then followed by the text itself.</p>
<p>The zero-length chunk at the end indicates completion of the transfer, and as we requested <code>Connection: close</code> in our headers, our HTTP server closes the connection once the generation has completed.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In HTTP/1.1, <em>“keep-alive”</em> is the default behavior—i.e., a server won’t close a connection unless the client specifically requests it. This is the opposite of HTTP/1.0 behavior, where the server will close a connection by default unless a client furnishes a <code>Connection: keep-alive</code> header.</p>
</div>
</div>
</section>
<section id="verifying-via-curl" class="level3">
<h3 class="anchored" data-anchor-id="verifying-via-curl">Verifying via Curl</h3>
<p>If we switch over to <code>curl</code> and run the same generation request, we’ll see the <em>reassembled</em> text, and, provided we supply the <code>--no-buffer</code> argument, <code>curl</code> will also display decoded text as soon as it receives it.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> curl <span class="at">--no-buffer</span> <span class="at">--verbose</span> <span class="dt">\</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'http://dgx:4444/generate/The%20quick%20brown%20fox?'</span> <span class="dt">\</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'max_length=20&amp;seed=42&amp;device=cuda'</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="ex">*</span>   Trying 10.0.132.48:4444...</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="ex">*</span> Connected to dgx <span class="er">(</span><span class="ex">10.0.132.48</span><span class="kw">)</span> <span class="ex">port</span> 4444 <span class="er">(</span><span class="co">#0)</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> GET <span class="ex">/generate/The%20quick%20brown%20fox?max_length=20</span><span class="kw">&amp;</span><span class="va">seed</span><span class="op">=</span>42<span class="kw">&amp;</span><span class="va">device</span><span class="op">=</span>cuda <span class="ex">HTTP/1.1</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> Host: <span class="ex">dgx:4444</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> User-Agent: <span class="ex">curl/7.81.0</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> Accept: <span class="ex">*/*</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="ex">*</span> Mark bundle as not supporting multiuse</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> HTTP/1.1 <span class="ex">200</span> OK</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> Server: <span class="ex">Parallelopedia</span> Web Server v1.0</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> Date: <span class="ex">Fri,</span> 07 Feb 2025 23:05:34 GMT</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> Accept-Ranges: <span class="ex">bytes</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> Content-Type: <span class="ex">text/plain</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> Access-Control-Allow-Origin: <span class="ex">*</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> Transfer-Encoding: <span class="ex">chunked</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> Access-Control-Expose-Headers: <span class="ex">X-Max-Length,</span> X-Top-K, X-Seed, X-Model-Name, X-Model-Device</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> X-Max-Length: <span class="ex">20</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> X-Top-K: <span class="ex">50</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> X-Seed: <span class="ex">42</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> X-Model-Name: <span class="ex">gpt2</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> X-Model-Device: <span class="ex">cuda:2</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span> </span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> quick brown fox is a subspecies that originated in southern Scotland as a variety of fox. This<span class="pp">*</span> Connection <span class="co">#0 to host dgx left intact</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="launching-the-react-bootstrap-ui" class="level3">
<h3 class="anchored" data-anchor-id="launching-the-react-bootstrap-ui">Launching the React Bootstrap UI</h3>
<p>The React Bootstrap UI can be launched as follows:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> cd <span class="va">$PARALLELOPEDIA_UI</span> <span class="co"># i.e. root of gh:tpn/parallelopedia-ui</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> conda activate py313t <span class="co"># or whatever has recent nodejs/npm</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> npm start run</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Full disclaimer: I’m not a web developer. I don’t know JavaScript, React, or Bootstrap, or anything else in the modern web stack. So like any good developer in 2025 when confronted with a task they have absolutely no business doing… I palmed it off to AI—either ChatGPT, local LLMs via <a href="https://lmstudio.ai/">LM Studio</a>, or, more recently, <a href="https://aider.chat">Aider</a>.</p>
<p>TL;DR: the web interface code probably sucks.</p>
</div>
</div>
<p>Running <code>npm start run</code> should open up a browser window pointing at <code>http://localhost:3000</code>. Ignore the <em>Wiki</em> tab—that’s for another article—and switch to the <em>GPT2</em> tab. You should see something similar to the GIF below, which is a demo of me using the interface to generate some text:</p>
<div id="parallelopedia-ui-gpt2-example" class="callout callout-style-simple callout-note no-icon callout-titled" title="Parallelopedia UI Demo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parallelopedia UI Demo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/parallelopedia-ui-example.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Parallelopedia UI Demo"><img src="images/parallelopedia-ui-example.gif" class="img-fluid figure-img" alt="Parallelopedia UI Demo"></a></p>
<figcaption>Parallelopedia UI Demo</figcaption>
</figure>
</div>
<p><a href="https://github.com/tpn/parallelopedia-ui/blob/main/src/GPT2.jsx">GPT2.jsx Code</a></p>
</div>
</div>
</div>
<p>Not too shabby! Granted, it’s a tad jarring seeing characters per second instead of tokens per second. If we wanted to display a live tokens/sec rate, some possible options might be:</p>
<ol type="1">
<li><p>Alter <code>GPT.async_generate_for()</code> to calculate how long it took to generate each token (whilst we’re in the main generation loop), convert that into a tokens/sec rate, and then change our API on both the server side and the JavaScript UI side such that each chunk that gets sent back is encoded with both the rate <em>and</em> the actual chunk. A drawback of this approach is that hitting the <code>/generate</code> endpoint with <code>curl</code> or <code>netcat</code> would look wacky, as you’d see token/sec floats in between each generated set of decoded characters.</p></li>
<li><p>Send the raw integer tokens back as they’re generated, instead of first decoding them. That would allow client-side JavaScript to calculate tokens/sec, but it would make it impossible to easily inspect the output with our command line tools like <code>curl</code> or <code>echo ... | nc</code>. It would also require adding a JavaScript decoding library on the client side (although that’s not such a big deal, I think you can just do <code>npm    install tiktoken</code> these days).</p></li>
<li><p>Have the JavaScript client re-encode the decoded characters received back into their GPT2-tokenizer token representation in order to determine actual underlying token count, and recalculate the rate based off that. This rate would differ from the tokens/sec rate observed on the server because it would also include network latency.</p></li>
<li><p>Do something more advanced with a separate WebSocket or something, where the live tokens/sec generation rate can be displayed independently to the generated decoded tokens.</p></li>
<li><p>Just YOLO it and have the JavaScript code divide the characters per second by, say, three, and pretend that’s roughly the tokens/sec rate (assuming that on average, one token represents three characters in any given response).</p></li>
</ol>
<p>I don’t want to do any of that! So characters per second it is, for now, however jarring it may be.</p>
</section>
</section>
<section id="parallel-generation" class="level2">
<h2 class="anchored" data-anchor-id="parallel-generation">Parallel Generation</h2>
<p>Alright, we’ve exercised the <code>/generate</code> endpoint a few different ways via a single client connection, and it looks like it’s behaving the way we hoped it would, albeit with a whopping simultaneous client count of, precisely, one.</p>
<p>Let’s look at introducing some simultaneous load by way of multiple machines all issuing <code>/generate</code> requests at the same time, first via the <code>echo ... | nc</code> approach, and then via <code>curl</code>.</p>
<p>I’ll leverage <code>tmux</code> and the <code>:setw synchronize-panes</code> command, which sends my console keystrokes to all active panes within a given <code>tmux</code> session window.</p>
<section id="netcat-example" class="level3">
<h3 class="anchored" data-anchor-id="netcat-example">Netcat Example</h3>
<p>I captured a 15 frames-per-second GIF of this in action, which you can view below. It shows terminal sessions to six machines, arranged vertically, all executing the same <code>echo ... | nc</code> command depicted above.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This might seem like a bit of a silly test, especially when it’s working correctly, because the output is pretty benign, and we don’t <em>really</em> know that these requests were actually being served simultaneously by different threads on the server side.</p>
<p>When I first tried it, though, it absolutely did <em>not</em> work correctly—one server would get correct output, another would get the HTTP headers in triplicate, whilst two other sessions just went straight into the chunked responses, with no preceding HTTP headers in sight. I had a bug in my HTTP routing code (that exists in the PyParallel code I wrote ten years ago upon which I based the new HTTP server on!) which was entirely to blame. With that code ripped out and <code>@route</code> reimplemented in a much simpler fashion, everything worked well.</p>
</div>
</div>
<div id="parallel-netcat-generation" class="callout callout-style-simple callout-note no-icon callout-titled" title="Parallel Netcat Generation">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parallel Netcat Generation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/parallelopedia-multi-threaded-gpu-inference-gpt2-nc.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Parallel Netcat Generation"><img src="images/parallelopedia-multi-threaded-gpu-inference-gpt2-nc.gif" class="img-fluid figure-img" alt="Parallel Netcat Generation"></a></p>
<figcaption>Parallel Netcat Generation</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>I extracted the last frame of the GIF, below, where you can see that at least there was some variance between which GPUs were selected:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/parallelopedia-multi-threaded-gpu-inference-gpt2-nc-last-frame-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Parallel Netcat Generation - Last Frame"><img src="images/parallelopedia-multi-threaded-gpu-inference-gpt2-nc-last-frame-2.png" class="img-fluid figure-img" alt="Parallel Netcat Generation - Last Frame"></a></p>
<figcaption>Parallel Netcat Generation - Last Frame</figcaption>
</figure>
</div>
</section>
<section id="curl-example" class="level3">
<h3 class="anchored" data-anchor-id="curl-example">Curl Example</h3>
<p>I did the same thing with the panes arranged horizontally, using <code>curl</code> instead and a <code>max_length=1000</code> and no seed, which helps in visualizing the parallel generation, as you can clearly see different clients are receiving completely different outputs.</p>
<div id="parallel-curl-generation" class="callout callout-style-simple callout-note no-icon callout-titled" title="Parallel Curl Generation">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parallel Curl Generation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/parallelopedia-multi-threaded-gpu-inference-gpt2-curl-1000.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Parallel Curl Generation"><img src="images/parallelopedia-multi-threaded-gpu-inference-gpt2-curl-1000.gif" class="img-fluid figure-img" alt="Parallel Curl Generation"></a></p>
<figcaption>Parallel Curl Generation</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="lets-load-test-this-sucker" class="level2">
<h2 class="anchored" data-anchor-id="lets-load-test-this-sucker">Let’s Load Test This Sucker!</h2>
<p>So far so good! Looks like we can absolutely do PyTorch model generation in parallel via multiple threads thanks to free-threaded Python.</p>
<p>Let’s ramp it up a notch and see what happens if we attempt to load test the <code>/generate</code> endpoint from a different server. The <code>leopard</code> server you see in the next example is an Intel(R) Xeon(R) W-2275 CPU @ 3.30GHz (14 cores, 28 threads) and is connected to the <code>dgx</code> box via a 10G Ethernet link.</p>
<p>Using the fork of <a href="https://github.com/tpn/wrk"><code>wrk</code></a> I hacked together some ten years ago or so whilst load testing PyParallel, let’s kick off a run with 14 threads for 30 seconds. There will be one connection per thread, and HTTP/1.1 will be used, so the implicit <em>keep-alive</em> behavior means that as soon as one <code>/generate</code> request completes, another one is immediately dispatched.</p>
<p>For posterity, the console command being used is as follows:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> time ./wrk <span class="at">-v</span> <span class="at">--latency</span> <span class="at">-c14</span> <span class="at">-t14</span> <span class="at">-d30s</span> <span class="dt">\</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'http://dgx:4444/generate/'</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'The%20quick%20brown%20fox?max_length=20&amp;device=cuda&amp;seed=42'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In the GIF below you’ll see two terminal windows. The smaller foreground window on the left is <code>leopard</code>, the session doing the <code>wrk</code> load test. The background window that takes up the rest of the screen is logged in to <code>dgx</code>, our server, and it’s running a GPU-enabled build of <a href="https://github.com/aristocratos/btop"><code>btop</code></a>, which is a beautiful console app for displaying resource usage. I particularly like <code>btop</code> in this example as it does a good job of conveying the CPU and GPU load that kicks in when the load test starts.</p>
<p>The 40 CPU cores can be seen in the top pane, and, as expected, about 14 of them whirr into life as soon as the load test begins, which tracks, as there are now 14 clients attempting to hammer our <code>/generate</code> end point.</p>
<p>Below that, you can see the four Tesla V100-DGXS-32GB GPUs also whirr into action, handling the generation between them with relative ease.</p>
<p>On the bottom right, I’ve filtered the process tree to just display our <code>python</code> HTTP server invocation. (I would love it if <code>btop</code> showed the individual threads and their load, as it would beautifully depict Python saturating cores in parallel now that there’s no GIL impeding execution, however, I don’t believe that’s currently possible with this version of <code>btop</code>.)</p>
<section id="parallel-load-testing-no-gil" class="level3">
<h3 class="anchored" data-anchor-id="parallel-load-testing-no-gil">Parallel Load Testing (No GIL)</h3>
<div id="parallel-generation-load-test-no-gil" class="callout callout-style-simple callout-note no-icon callout-titled" title="Parallel Generation Load Test: No GIL">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parallel Generation Load Test: No GIL
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/parallelopedia-multi-threaded-gpu-inference-gpt2-wrk-14.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Parallel Generation Load Test - No GIL"><img src="images/parallelopedia-multi-threaded-gpu-inference-gpt2-wrk-14.gif" class="img-fluid figure-img" alt="Parallel Generation Load Test - No GIL"></a></p>
<figcaption>Parallel Generation Load Test - No GIL</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>I’ve extracted the last frame, below, to allow closer inspection at the end of the run, without the annoyance of the GIF looping.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/parallelopedia-multi-threaded-gpu-inference-gpt2-wrk-14-last-frame-optimized.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Parallel Generation Load Test No GIL - Last Frame"><img src="images/parallelopedia-multi-threaded-gpu-inference-gpt2-wrk-14-last-frame-optimized.png" class="img-fluid figure-img" alt="Parallel Generation Load Test No GIL - Last Frame"></a></p>
<figcaption>Parallel Generation Load Test No GIL - Last Frame</figcaption>
</figure>
</div>
<p>The console output from <code>wrk</code> is captured in the callout below.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Console Output of wrk: No GIL">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Console Output of wrk: No GIL
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<pre><code>wrk 4.0.0 [epoll] Copyright (C) 2012 Will Glozer
Running 30s test @ http://dgx:4444/generate/The%20quick%20brown%20fox?max_length=20&amp;device=cuda&amp;seed=42
  14 threads and 14 connections
  Thread Stats   Min      Avg       Stdev     Max     +/- Stdev
    Latency   130.40ms  197.38ms   54.41ms 528.61ms   89.19%
    Req/Sec     1.00      5.63      2.32    10.00     67.76%
  Latency Distribution
      0%  130.40ms
      1%  139.79ms
      2%  143.50ms
      3%  145.78ms
      4%  147.53ms
      5%  149.78ms
      6%  151.18ms
      7%  152.43ms
      8%  153.42ms
      9%  155.29ms
     10%  156.15ms
     11%  157.29ms
     12%  158.27ms
     13%  158.90ms
     14%  159.70ms
     15%  160.73ms
     16%  161.64ms
     17%  162.32ms
     18%  163.09ms
     19%  163.60ms
     20%  164.41ms
     21%  165.17ms
     22%  165.61ms
     23%  166.08ms
     24%  166.75ms
     25%  167.36ms
     26%  167.93ms
     27%  168.51ms
     28%  169.05ms
     29%  169.49ms
     30%  170.23ms
     31%  170.92ms
     32%  171.54ms
     33%  172.10ms
     34%  172.66ms
     35%  173.29ms
     36%  173.98ms
     37%  174.39ms
     38%  174.96ms
     39%  175.47ms
     40%  176.17ms
     41%  176.80ms
     42%  177.24ms
     43%  177.75ms
     44%  178.49ms
     45%  178.92ms
     46%  179.57ms
     47%  180.15ms
     48%  180.62ms
     49%  181.31ms
     50%  182.00ms
     51%  182.60ms
     52%  183.22ms
     53%  184.14ms
     54%  185.01ms
     55%  185.53ms
     56%  186.21ms
     57%  187.30ms
     58%  188.03ms
     59%  188.66ms
     60%  189.14ms
     61%  190.47ms
     62%  191.13ms
     63%  191.69ms
     64%  192.34ms
     65%  193.06ms
     66%  193.87ms
     67%  194.51ms
     68%  195.63ms
     69%  196.68ms
     70%  197.67ms
     71%  198.34ms
     72%  199.90ms
     73%  201.43ms
     74%  202.66ms
     75%  203.56ms
     76%  205.00ms
     77%  206.48ms
     78%  207.76ms
     79%  209.30ms
     80%  210.53ms
     81%  212.11ms
     82%  213.30ms
     83%  215.90ms
     84%  218.09ms
     85%  220.16ms
     86%  224.57ms
     87%  227.99ms
     88%  230.93ms
     89%  234.77ms
     90%  241.08ms
     91%  252.68ms
     92%  302.34ms
     93%  321.04ms
     94%  335.47ms
     95%  339.80ms
     96%  358.81ms
     97%  369.67ms
     98%  379.52ms
     99%  397.66ms
    100%  411.36ms
  2128 requests in 30.06s, 1.17MB read
Requests/sec:     70.80
Transfer/sec:     39.75KB
</code></pre>
</div>
</div>
</div>
<p>A visualization of the latencies is presented below. All code for visualization is from the <a href="wrk-analysis-preview.html"><em>Data Visualization</em></a> Jupyter Notebook, which you can <a href="wrk-analysis.ipynb">preview here</a>, or access directly on <a href="https://github.com/tpn/website/blob/main/articles/pytorch-and-python-free-threading/wrk-analysis.ipynb">Github</a>.</p>
<div class="theme-light">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="wrk-01-no-gil.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Parallel Load Test Latency Distribution (No GIL)"><img src="wrk-01-no-gil.svg" class="img-fluid figure-img" alt="Parallel Load Test Latency Distribution (No GIL)"></a></p>
<figcaption>Parallel Load Test Latency Distribution (No GIL)</figcaption>
</figure>
</div>
</div>
<div class="theme-dark">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="wrk-01-no-gil-dark.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Parallel Load Test Latency Distribution (No GIL)"><img src="wrk-01-no-gil-dark.svg" class="img-fluid figure-img" alt="Parallel Load Test Latency Distribution (No GIL)"></a></p>
<figcaption>Parallel Load Test Latency Distribution (No GIL)</figcaption>
</figure>
</div>
</div>
</section>
<section id="ablation-test-re-enable-the-gil" class="level3">
<h3 class="anchored" data-anchor-id="ablation-test-re-enable-the-gil">Ablation Test: Re-enable the GIL</h3>
<p>Let’s see what happens if we re-enable the GIL. We should see poor resource utilization on the server side, as only one Python thread can run at a time, and the statistics reported on the client side should be equally dismal.</p>
<p>Expand the callout below to view the GIF. I have used another terminal window to launch the server with the <code>-Xgil=1</code> argument, which re-enables the GIL. I then switch back over to <code>leopard</code> and perform the <code>wrk</code> load test like before.</p>
<div id="parallel-load-test-gil" class="callout callout-style-simple callout-note no-icon callout-titled" title="Parallel Generation Load Test: GIL Enabled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parallel Generation Load Test: GIL Enabled
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/parallelopedia-multi-threaded-gpu-inference-gpt2-wrk-14-GIL-enabled.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Parallel Generation Load Test - GIL Enabled"><img src="images/parallelopedia-multi-threaded-gpu-inference-gpt2-wrk-14-GIL-enabled.gif" class="img-fluid figure-img" alt="Parallel Generation Load Test - GIL Enabled"></a></p>
<figcaption>Parallel Generation Load Test - GIL Enabled</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>As with before, I’ve extracted the last frame, below, to allow closer inspection at the end of the run, without the annoyance of the GIF looping.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/parallelopedia-multi-threaded-gpu-inference-gpt2-wrk-14-GIL-enabled-last-frame-optimized.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Parallel Generation Load Test - GIL Enabled - Last Frame"><img src="images/parallelopedia-multi-threaded-gpu-inference-gpt2-wrk-14-GIL-enabled-last-frame-optimized.png" class="img-fluid figure-img" alt="Parallel Generation Load Test - GIL Enabled - Last Frame"></a></p>
<figcaption>Parallel Generation Load Test - GIL Enabled - Last Frame</figcaption>
</figure>
</div>
<p>As we expected: re-enabling the GIL absolutely murders resource utilization.</p>
<p>The console output from <code>wrk</code> follows in the next callout.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Console Output of wrk: GIL Enabled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Console Output of wrk: GIL Enabled
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<pre><code>wrk 4.0.0 [epoll] Copyright (C) 2012 Will Glozer
Running 30s test @ http://dgx:4444/generate/The%20quick%20brown%20fox?max_length=20&amp;device=cuda&amp;seed=42
  14 threads and 14 connections
  Thread Stats   Min      Avg       Stdev     Max     +/- Stdev
    Latency     1.11s     1.46s    92.76ms   1.82s    84.47%
    Req/Sec     0.00      0.00      0.00     0.00    100.00%
  Latency Distribution
      0%    1.11s
      1%    1.16s
      2%    1.22s
      3%    1.24s
      4%    1.29s
      5%    1.36s
      6%    1.37s
      7%    1.37s
      8%    1.37s
      9%    1.38s
     10%    1.38s
     11%    1.39s
     12%    1.39s
     13%    1.39s
     14%    1.40s
     15%    1.40s
     16%    1.40s
     17%    1.41s
     18%    1.41s
     19%    1.41s
     20%    1.41s
     21%    1.41s
     22%    1.41s
     23%    1.42s
     24%    1.42s
     25%    1.42s
     26%    1.42s
     27%    1.42s
     28%    1.42s
     29%    1.42s
     30%    1.42s
     31%    1.43s
     32%    1.43s
     33%    1.43s
     34%    1.43s
     35%    1.43s
     36%    1.43s
     37%    1.43s
     38%    1.44s
     39%    1.44s
     40%    1.44s
     41%    1.44s
     42%    1.44s
     43%    1.45s
     44%    1.45s
     45%    1.45s
     46%    1.45s
     47%    1.45s
     48%    1.45s
     49%    1.45s
     50%    1.46s
     51%    1.46s
     52%    1.46s
     53%    1.46s
     54%    1.46s
     55%    1.47s
     56%    1.47s
     57%    1.47s
     58%    1.47s
     59%    1.47s
     60%    1.47s
     61%    1.48s
     62%    1.48s
     63%    1.48s
     64%    1.48s
     65%    1.48s
     66%    1.49s
     67%    1.49s
     68%    1.49s
     69%    1.49s
     70%    1.49s
     71%    1.49s
     72%    1.49s
     73%    1.50s
     74%    1.50s
     75%    1.50s
     76%    1.50s
     77%    1.50s
     78%    1.51s
     79%    1.51s
     80%    1.51s
     81%    1.51s
     82%    1.51s
     83%    1.51s
     84%    1.52s
     85%    1.52s
     86%    1.52s
     87%    1.53s
     88%    1.53s
     89%    1.53s
     90%    1.54s
     91%    1.55s
     92%    1.56s
     93%    1.56s
     94%    1.59s
     95%    1.59s
     96%    1.60s
     97%    1.70s
     98%    1.75s
     99%    1.77s
    100%    1.82s
  221 requests in 30.07s, 129.42KB read
  Socket errors: connect 0, read 0, write 0, timeout 60
Requests/sec:      7.35
Transfer/sec:      4.30KB
</code></pre>
</div>
</div>
</div>
<p>And a visualization of the latencies follows. Note that there were 60 socket timeouts in this case, whereas no timeouts were encountered in the prior run with the GIL disabled.</p>
<div class="theme-light">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="wrk-01-gil.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Parallel Load Test Latency Distribution (GIL Enabled)"><img src="wrk-01-gil.svg" class="img-fluid figure-img" alt="Parallel Load Test Latency Distribution (GIL Enabled)"></a></p>
<figcaption>Parallel Load Test Latency Distribution (GIL Enabled)</figcaption>
</figure>
</div>
</div>
<div class="theme-dark">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="wrk-01-gil-dark.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Parallel Load Test Latency Distribution (GIL Enabled)"><img src="wrk-01-gil-dark.svg" class="img-fluid figure-img" alt="Parallel Load Test Latency Distribution (GIL Enabled)"></a></p>
<figcaption>Parallel Load Test Latency Distribution (GIL Enabled)</figcaption>
</figure>
</div>
</div>
</section>
<section id="parallel-load-testing-no-gil-vs-gil" class="level3">
<h3 class="anchored" data-anchor-id="parallel-load-testing-no-gil-vs-gil">Parallel Load Testing: No GIL vs GIL</h3>
<p>Viewing them side by side:</p>
<div class="theme-light">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="wrk-01-combined.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Parallel Load Test Latency Distribution (No GIL &amp; GIL Enabled Combined)"><img src="wrk-01-combined.svg" class="img-fluid figure-img" alt="Parallel Load Test Latency Distribution (No GIL &amp; GIL Enabled Combined)"></a></p>
<figcaption>Parallel Load Test Latency Distribution (No GIL &amp; GIL Enabled Combined)</figcaption>
</figure>
</div>
</div>
<div class="theme-dark">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="wrk-01-combined-dark.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Parallel Load Test Latency Distribution (No GIL &amp; GIL Enabled Combined)"><img src="wrk-01-combined-dark.svg" class="img-fluid figure-img" alt="Parallel Load Test Latency Distribution (No GIL &amp; GIL Enabled Combined)"></a></p>
<figcaption>Parallel Load Test Latency Distribution (No GIL &amp; GIL Enabled Combined)</figcaption>
</figure>
</div>
</div>
<p>Remember to keep in mind that the No GIL vs GIL requests/sec was 70.80 vs 7.35, nearly a ten-fold increase:</p>
<div class="theme-light">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="wrk-01-rps-combined.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Parallel Load Test Requests/sec (No GIL vs GIL)"><img src="wrk-01-rps-combined.svg" class="img-fluid figure-img" alt="Parallel Load Test Requests/sec (No GIL vs GIL)"></a></p>
<figcaption>Parallel Load Test Requests/sec (No GIL vs GIL)</figcaption>
</figure>
</div>
</div>
<div class="theme-dark">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="wrk-01-rps-combined-dark.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Parallel Load Test Requests/sec (No GIL vs GIL)"><img src="wrk-01-rps-combined-dark.svg" class="img-fluid figure-img" alt="Parallel Load Test Requests/sec (No GIL vs GIL)"></a></p>
<figcaption>Parallel Load Test Requests/sec (No GIL vs GIL)</figcaption>
</figure>
</div>
</div>
</section>
<section id="parallel-load-testing-how-does-plaintext-fare" class="level3">
<h3 class="anchored" data-anchor-id="parallel-load-testing-how-does-plaintext-fare">Parallel Load Testing: How does Plaintext Fare?</h3>
<p>As we launched our HTTP server invocation earlier with the <code>PlaintextApp</code> class, which simply responds to the <code>/plaintext</code> endpoint with <code>b'Hello World\n'</code>, let’s throw some load at that too.</p>
<p>This doesn’t have anything to do with PyTorch; it’s an orthogonal load test that’s fun because it depicts the stark difference between GIL vs no GIL.</p>
<p>The console command was issued on <code>leopard</code>, like last time, as follows:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> time ./wrk <span class="at">-v</span> <span class="at">--latency</span> <span class="at">-c14</span> <span class="at">-t14</span> <span class="at">-d30s</span> <span class="st">'http://dgx:4444/plaintext'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Console outputs for both tests follow.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Console Output of wrk Plaintext: No GIL">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Console Output of wrk Plaintext: No GIL
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<pre><code>wrk 4.0.0 [epoll] Copyright (C) 2012 Will Glozer
Running 30s test @ http://dgx:4444/plaintext
  14 threads and 14 connections
  Thread Stats   Min      Avg       Stdev     Max     +/- Stdev
    Latency   127.00us   11.68ms   55.98ms 818.74ms   94.91%
    Req/Sec    20.00      4.89k     1.46k    6.43k    87.86%
  Latency Distribution
      0%  127.00us
      1%  148.00us
      2%  150.00us
      3%  152.00us
      4%  153.00us
      5%  154.00us
      6%  155.00us
      7%  156.00us
      8%  157.00us
      9%  157.00us
     10%  158.00us
     11%  159.00us
     12%  159.00us
     13%  160.00us
     14%  161.00us
     15%  161.00us
     16%  162.00us
     17%  162.00us
     18%  163.00us
     19%  163.00us
     20%  164.00us
     21%  165.00us
     22%  165.00us
     23%  166.00us
     24%  166.00us
     25%  167.00us
     26%  167.00us
     27%  168.00us
     28%  168.00us
     29%  169.00us
     30%  169.00us
     31%  170.00us
     32%  170.00us
     33%  171.00us
     34%  171.00us
     35%  172.00us
     36%  172.00us
     37%  173.00us
     38%  173.00us
     39%  174.00us
     40%  174.00us
     41%  175.00us
     42%  175.00us
     43%  176.00us
     44%  176.00us
     45%  177.00us
     46%  178.00us
     47%  178.00us
     48%  179.00us
     49%  179.00us
     50%  180.00us
     51%  181.00us
     52%  181.00us
     53%  182.00us
     54%  183.00us
     55%  183.00us
     56%  184.00us
     57%  185.00us
     58%  186.00us
     59%  186.00us
     60%  187.00us
     61%  188.00us
     62%  189.00us
     63%  190.00us
     64%  191.00us
     65%  192.00us
     66%  193.00us
     67%  194.00us
     68%  195.00us
     69%  196.00us
     70%  197.00us
     71%  198.00us
     72%  199.00us
     73%  200.00us
     74%  202.00us
     75%  203.00us
     76%  205.00us
     77%  207.00us
     78%  208.00us
     79%  211.00us
     80%  213.00us
     81%  216.00us
     82%  219.00us
     83%  223.00us
     84%  229.00us
     85%  236.00us
     86%  246.00us
     87%  263.00us
     88%  308.00us
     89%  599.00us
     90%    8.77ms
     91%   19.48ms
     92%   30.74ms
     93%   42.55ms
     94%   54.97ms
     95%   68.92ms
     96%   85.23ms
     97%  106.42ms
     98%  139.96ms
     99%  282.83ms
    100%  462.36ms
  1970103 requests in 30.01s, 420.86MB read
Requests/sec:  65652.68
Transfer/sec:     14.02MB
</code></pre>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Console Output of wrk Plaintext: GIL Enabled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Console Output of wrk Plaintext: GIL Enabled
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<pre><code>wrk 4.0.0 [epoll] Copyright (C) 2012 Will Glozer
Running 30s test @ http://dgx:4444/plaintext
  14 threads and 14 connections
  Thread Stats   Min      Avg       Stdev     Max     +/- Stdev
    Latency   187.00us    4.81ms   19.24ms 295.28ms   97.89%
    Req/Sec     4.00    442.80    133.07   666.00     66.01%
  Latency Distribution
      0%  187.00us
      1%  577.00us
      2%  645.00us
      3%  670.00us
      4%  684.00us
      5%  698.00us
      6%  712.00us
      7%  724.00us
      8%  735.00us
      9%  745.00us
     10%  755.00us
     11%  763.00us
     12%  770.00us
     13%  778.00us
     14%  789.00us
     15%  801.00us
     16%  814.00us
     17%  831.00us
     18%    0.85ms
     19%    0.88ms
     20%    0.95ms
     21%    1.19ms
     22%    1.25ms
     23%    1.27ms
     24%    1.29ms
     25%    1.31ms
     26%    1.33ms
     27%    1.34ms
     28%    1.36ms
     29%    1.37ms
     30%    1.38ms
     31%    1.40ms
     32%    1.42ms
     33%    1.43ms
     34%    1.46ms
     35%    1.48ms
     36%    1.52ms
     37%    1.63ms
     38%    1.80ms
     39%    1.84ms
     40%    1.87ms
     41%    1.89ms
     42%    1.90ms
     43%    1.92ms
     44%    1.93ms
     45%    1.95ms
     46%    1.96ms
     47%    1.97ms
     48%    1.99ms
     49%    2.01ms
     50%    2.02ms
     51%    2.05ms
     52%    2.07ms
     53%    2.11ms
     54%    2.17ms
     55%    2.31ms
     56%    2.39ms
     57%    2.44ms
     58%    2.48ms
     59%    2.50ms
     60%    2.53ms
     61%    2.55ms
     62%    2.57ms
     63%    2.59ms
     64%    2.61ms
     65%    2.64ms
     66%    2.66ms
     67%    2.69ms
     68%    2.73ms
     69%    2.77ms
     70%    2.84ms
     71%    2.96ms
     72%    3.04ms
     73%    3.09ms
     74%    3.12ms
     75%    3.15ms
     76%    3.18ms
     77%    3.22ms
     78%    3.26ms
     79%    3.31ms
     80%    3.38ms
     81%    3.51ms
     82%    3.65ms
     83%    3.74ms
     84%    3.82ms
     85%    3.90ms
     86%    4.01ms
     87%    4.21ms
     88%    4.33ms
     89%    4.41ms
     90%    4.48ms
     91%    4.58ms
     92%    4.82ms
     93%    5.03ms
     94%    5.30ms
     95%    5.72ms
     96%    6.34ms
     97%    7.54ms
     98%   31.73ms
     99%  116.44ms
    100%  169.73ms
  183217 requests in 30.02s, 39.14MB read
Requests/sec:   6102.29
Transfer/sec:      1.30MB
</code></pre>
</div>
</div>
</div>
<p>Combined requests/sec visualization depicts a similar 10x improvement:</p>
<div class="theme-light">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="wrk-02-rps-combined.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Plaintext Parallel Load Test Requests/sec (No GIL vs GIL)"><img src="wrk-02-rps-combined.svg" class="img-fluid figure-img" alt="Plaintext Parallel Load Test Requests/sec (No GIL vs GIL)"></a></p>
<figcaption>Plaintext Parallel Load Test Requests/sec (No GIL vs GIL)</figcaption>
</figure>
</div>
</div>
<div class="theme-dark">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="wrk-02-rps-combined-dark.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Plaintext Parallel Load Test Requests/sec (No GIL vs GIL)"><img src="wrk-02-rps-combined-dark.svg" class="img-fluid figure-img" alt="Plaintext Parallel Load Test Requests/sec (No GIL vs GIL)"></a></p>
<figcaption>Plaintext Parallel Load Test Requests/sec (No GIL vs GIL)</figcaption>
</figure>
</div>
</div>
<p>The latencies are a bit misleading when viewed in isolation, as you can see the tail end of the <em>No GIL</em> run incur higher latencies compared to the <em>GIL</em> run—however, as can be seen above, the <em>No GIL</em> run was doing 10x more requests/sec.</p>
<div class="theme-light">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="wrk-02-combined.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Plaintext Parallel Load Test Latency Distribution (No GIL vs GIL)"><img src="wrk-02-combined.svg" class="img-fluid figure-img" alt="Plaintext Parallel Load Test Latency Distribution (No GIL vs GIL)"></a></p>
<figcaption>Plaintext Parallel Load Test Latency Distribution (No GIL vs GIL)</figcaption>
</figure>
</div>
</div>
<div class="theme-dark">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="wrk-02-combined-dark.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Plaintext Parallel Load Test Latency Distribution (No GIL vs GIL)"><img src="wrk-02-combined-dark.svg" class="img-fluid figure-img" alt="Plaintext Parallel Load Test Latency Distribution (No GIL vs GIL)"></a></p>
<figcaption>Plaintext Parallel Load Test Latency Distribution (No GIL vs GIL)</figcaption>
</figure>
</div>
</div>
</section>
<section id="parallel-load-test-summary" class="level3">
<h3 class="anchored" data-anchor-id="parallel-load-test-summary">Parallel Load Test Summary</h3>
<p>I think it’s safe to say we’ve achieved our original goals in a satisfactory manner. We can absolutely now do parallel model inference in a single Python process, thanks to free-threading, and the whole thing works great when wrapped around an <code>asyncio</code>-based HTTP server that yields tokens one-by-one as soon as they’re generated, which is a closer representation of what you’d want in the real world if you were to deploy such a thing.</p>
<p>My takeaway from all of this: free-threading kicks ass. Having devoted so much time toward a parallel Python solution with <a href="https://pyparallel.org">PyParallel</a> over a decade ago, it makes me incredibly happy to see a working, performant solution finally getting mainlined into the core Python language.</p>
<p>It’s important to consider how many other things are simultaneously unlocked by Python free-threading. The HTTP server we’ve demonstrated above also has directory/file-serving behavior built-in, so it also functions like a normal web server would. In a separate article, I’ll introduce the <em>Wiki</em> server component, which features a <code>WikiApp</code> HTTP app that loads a 56GB XML file, plus about 12GB of supporting index structures (by way of <code>datrie</code> digital search tries, and NumPy arrays). This app happily loads in the same single Python process as our existing <code>Gpt2App</code>—demonstrating the power of accessing huge data structures in parallel by multiple threads, something that couldn’t be done with <code>multiprocessing</code> without paying for the cost to replicate that memory overhead in every process.</p>
</section>
</section>
</section>
<section id="finishing-up" class="level1">
<h1>Finishing Up</h1>
<p>I’ll tackle two more topics before we conclude this post. First, I want to briefly touch on a handful of the changes I made to the GPT-2 implementation after the version we introduced in the <a href="#initial-implementation">Initial Implementation</a> section.</p>
<p>Second, let’s see what happens if we throw the new graph compilation optimizations in PyTorch 2.0 at our solution; specifically, can we still use <code>model = torch.compile(model)</code> in our free-threading solution?</p>
<section id="reviewing-initial-implementation" class="level2">
<h2 class="anchored" data-anchor-id="reviewing-initial-implementation">Reviewing Initial Implementation</h2>
<section id="skipping-weight-initialization" class="level3">
<h3 class="anchored" data-anchor-id="skipping-weight-initialization">Skipping Weight Initialization</h3>
<p>The first version of the <code>GPT</code> class we introduced <a href="#initial-model-setup-code">here</a> looked like this:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GPT(nn.Module):</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, config, device):</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.config <span class="op">=</span> config</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.device <span class="op">=</span> device</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.manual_seed <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.transformer <span class="op">=</span> nn.ModuleDict(</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>                wte<span class="op">=</span>nn.Embedding(config.vocab_size, config.n_embd),</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>                wpe<span class="op">=</span>nn.Embedding(config.block_size, config.n_embd),</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>                h<span class="op">=</span>nn.ModuleList(</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>                    [Block(config) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(config.n_layer)]</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>                ln_f<span class="op">=</span>nn.LayerNorm(config.n_embd),</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lm_head <span class="op">=</span> nn.Linear(</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>            config.n_embd, config.vocab_size, bias<span class="op">=</span><span class="va">False</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.transformer.wte.weight <span class="op">=</span> <span class="va">self</span>.lm_head.weight</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.<span class="bu">apply</span>(<span class="va">self</span>._init_weights)</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _init_weights(<span class="va">self</span>, module):</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(module, nn.Linear):</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>            std <span class="op">=</span> <span class="fl">0.02</span></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">hasattr</span>(module, <span class="st">"NANOGPT_SCALE_INIT"</span>):</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>                std <span class="op">*=</span> (<span class="dv">2</span> <span class="op">*</span> <span class="va">self</span>.config.n_layer) <span class="op">**</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>            torch.nn.init.normal_(module.weight, mean<span class="op">=</span><span class="fl">0.0</span>, std<span class="op">=</span>std)</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> module.bias <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>                torch.nn.init.zeros_(module.bias)</span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="bu">isinstance</span>(module, nn.Embedding):</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>            torch.nn.init.normal_(module.weight, mean<span class="op">=</span><span class="fl">0.0</span>, std<span class="op">=</span><span class="fl">0.02</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As I mentioned earlier, I ripped that almost verbatim from Andrej’s <code>train_gpt2.py</code> code. For about two weeks during development of this work, I was using a local free-threaded build of PyTorch, but had forgotten that I had built it in <em>debug</em> configuration.</p>
<p>Everything was dog slow, but I had no frame of reference for how long things <em>should</em> have been taking, having had no real prior experience with PyTorch, but I was getting annoyed enough at how long it seemed to take to load the model—which I was doing frequently during development—so I added a bunch of timing code around things to try and bisect where the overhead was being introduced.</p>
<p>Looking at the <code>__init__()</code> code above, though, I was thoroughly perplexed by the <code>_init_weights(self, module)</code> function. Why would we be initializing weights at the end of the <code>GPT</code> constructor if we were just about to override them with the weights we were loading from the checkpoint?</p>
<p>Eliminating the call to <code>_init_weights()</code> entirely shaved off 15 seconds from the time it took to simply create an <em>“empty”</em> <code>GPT()</code> instance—i.e. before we’d even loaded the weights. However, it was still taking 15 seconds just to execute this block of code:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.transformer <span class="op">=</span> nn.ModuleDict(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">dict</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>            wte<span class="op">=</span>nn.Embedding(config.vocab_size, config.n_embd),</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>            wpe<span class="op">=</span>nn.Embedding(config.block_size, config.n_embd),</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>            h<span class="op">=</span>nn.ModuleList(</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                [Block(config) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(config.n_layer)]</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>            ln_f<span class="op">=</span>nn.LayerNorm(config.n_embd),</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.lm_head <span class="op">=</span> nn.Linear(</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>        config.n_embd, config.vocab_size, bias<span class="op">=</span><span class="va">False</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>I hoisted that code out into a separate <code>_init_transformer()</code> routine and surrounded it with some optional <code>torch.profiler.profile()</code> glue:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    timer <span class="op">=</span> ElapsedTimer()</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> timer:</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.torch_profile_activities:</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._init_transformer()</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> torch.profiler.profile(</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>                activities<span class="op">=</span><span class="va">self</span>.torch_profile_activities,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>                with_stack<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>            ) <span class="im">as</span> prof:</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>._init_transformer()</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.torch_profile_init_transformer <span class="op">=</span> prof</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    msg <span class="op">=</span> <span class="ss">f'Initialized GPT model in </span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    logging.info(msg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The profiling data yielded some interesting insight:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="bu">print</span>(model.torch_profile_init_transformer.key_averages().table(sort_by<span class="op">=</span><span class="st">'cpu_time_total'</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="op">-------------------------</span>  <span class="op">------------</span>  <span class="op">------------</span>  <span class="op">------------</span>  <span class="op">------------</span>  <span class="op">------------</span>  <span class="op">------------</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                     Name    Self CPU <span class="op">%</span>      Self CPU   CPU total <span class="op">%</span>     CPU total  CPU time avg    <span class="co"># of Calls</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="op">-------------------------</span>  <span class="op">------------</span>  <span class="op">------------</span>  <span class="op">------------</span>  <span class="op">------------</span>  <span class="op">------------</span>  <span class="op">------------</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>           aten::uniform_        <span class="fl">74.31</span><span class="op">%</span>       <span class="fl">10.861</span><span class="er">s</span>        <span class="fl">74.31</span><span class="op">%</span>       <span class="fl">10.861</span><span class="er">s</span>     <span class="fl">111.966</span><span class="er">ms</span>            <span class="dv">97</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>            aten::normal_        <span class="fl">25.64</span><span class="op">%</span>        <span class="fl">3.747</span><span class="er">s</span>        <span class="fl">25.64</span><span class="op">%</span>        <span class="fl">3.747</span><span class="er">s</span>        <span class="fl">1.873</span><span class="er">s</span>             <span class="dv">2</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>             aten::detach         <span class="fl">0.01</span><span class="op">%</span>       <span class="fl">1.408</span><span class="er">ms</span>         <span class="fl">0.03</span><span class="op">%</span>       <span class="fl">3.712</span><span class="er">ms</span>      <span class="fl">24.914</span><span class="er">us</span>           <span class="dv">149</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>              aten::empty         <span class="fl">0.02</span><span class="op">%</span>       <span class="fl">2.570</span><span class="er">ms</span>         <span class="fl">0.02</span><span class="op">%</span>       <span class="fl">2.570</span><span class="er">ms</span>      <span class="fl">17.247</span><span class="er">us</span>           <span class="dv">149</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>                   detach         <span class="fl">0.02</span><span class="op">%</span>       <span class="fl">2.304</span><span class="er">ms</span>         <span class="fl">0.02</span><span class="op">%</span>       <span class="fl">2.304</span><span class="er">ms</span>      <span class="fl">15.464</span><span class="er">us</span>           <span class="dv">149</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>              aten::fill_         <span class="fl">0.01</span><span class="op">%</span>       <span class="fl">1.013</span><span class="er">ms</span>         <span class="fl">0.01</span><span class="op">%</span>       <span class="fl">1.013</span><span class="er">ms</span>      <span class="fl">40.500</span><span class="er">us</span>            <span class="dv">25</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>              aten::zero_         <span class="fl">0.00</span><span class="op">%</span>     <span class="fl">305.888</span><span class="er">us</span>         <span class="fl">0.00</span><span class="op">%</span>     <span class="fl">305.888</span><span class="er">us</span>      <span class="fl">12.236</span><span class="er">us</span>            <span class="dv">25</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    cudaDeviceSynchronize         <span class="fl">0.00</span><span class="op">%</span>      <span class="fl">16.073</span><span class="er">us</span>         <span class="fl">0.00</span><span class="op">%</span>      <span class="fl">16.073</span><span class="er">us</span>      <span class="fl">16.073</span><span class="er">us</span>             <span class="dv">1</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="op">-------------------------</span>  <span class="op">------------</span>  <span class="op">------------</span>  <span class="op">------------</span>  <span class="op">------------</span>  <span class="op">------------</span>  <span class="op">------------</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>Self CPU time total: <span class="fl">14.615</span><span class="er">s</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>So <code>aten::uniform_</code> and <code>aten::normal_</code> were taking up, <em>literally</em>, 99.95% of the time during the transformer <em>initialization</em>. That also seemed bananas for the exact same reason calling <code>_init_weights()</code> seemed bananas: why was so much time and effort being spent initializing distributions when we were going to immediately overwrite all the weights when we load the model from the checkpoint?</p>
<p>Now, granted, had I not been using a debug build of PyTorch, those 14.597 seconds spent on weight initialization would be more like unnoticeable milliseconds at best. But I didn’t know that at the time, so after a bit of digging, I found out I could subclass my <code>Embedding</code> and <code>Linear</code> layers (which were the ones contributing to the uniform and normal distribution setup time overhead) in such a way that weight initialization would be skipped entirely.</p>
<p>So, if you look at the <a href="https://github.com/tpn/parallelopedia/blob/main/src/parallelopedia/gpt2.py#L535"><code>gpt2.py</code></a> implementation on Github, you’ll see that I’m using a bunch of <code>NoInit</code> classes, as follows:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==============================================================</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Classes</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==============================================================</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># N.B. We have simple "no-init" overrides for nn.Embedding and</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co">#      nn.Linear which skip the default initialization routines,</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co">#      significantly reducing the time to load the model by</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co">#      avoiding uniform and random distribution initialization.</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co">#      As we immediately load all the weights from the model</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co">#      checkpoint straight after creating the model, we don't</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co">#      need the default initialization routines.</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NoInitEmbedding(nn.Embedding):</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reset_parameters(<span class="va">self</span>):</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Skip default uniform initialization.</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NoInitLinear(nn.Linear):</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reset_parameters(<span class="va">self</span>):</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Skip default Kaiming initialization.</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CausalSelfAttention(nn.Module):</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, config):</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> config.n_embd <span class="op">%</span> config.n_head <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Key, query, value projections for all heads, but in a batch.</span></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_attn <span class="op">=</span> NoInitLinear(config.n_embd, <span class="dv">3</span> <span class="op">*</span> config.n_embd)</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Output projection.</span></span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_proj <span class="op">=</span> NoInitLinear(config.n_embd, config.n_embd)</span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_proj.NANOGPT_SCALE_INIT <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Regularization.</span></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n_head <span class="op">=</span> config.n_head</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n_embd <span class="op">=</span> config.n_embd</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MLP(nn.Module):</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, config):</span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_fc <span class="op">=</span> NoInitLinear(config.n_embd, <span class="dv">4</span> <span class="op">*</span> config.n_embd)</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.gelu <span class="op">=</span> nn.GELU(approximate<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_proj <span class="op">=</span> NoInitLinear(<span class="dv">4</span> <span class="op">*</span> config.n_embd, config.n_embd)</span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_proj.NANOGPT_SCALE_INIT <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GPT:</span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb61-57"><a href="#cb61-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-58"><a href="#cb61-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _init_transformer(<span class="va">self</span>):</span>
<span id="cb61-59"><a href="#cb61-59" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb61-60"><a href="#cb61-60" aria-hidden="true" tabindex="-1"></a><span class="co">        Initialize the transformer.</span></span>
<span id="cb61-61"><a href="#cb61-61" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb61-62"><a href="#cb61-62" aria-hidden="true" tabindex="-1"></a>        config <span class="op">=</span> <span class="va">self</span>.config</span>
<span id="cb61-63"><a href="#cb61-63" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.transformer <span class="op">=</span> nn.ModuleDict(</span>
<span id="cb61-64"><a href="#cb61-64" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(</span>
<span id="cb61-65"><a href="#cb61-65" aria-hidden="true" tabindex="-1"></a>                wte<span class="op">=</span>NoInitEmbedding(config.vocab_size, config.n_embd),</span>
<span id="cb61-66"><a href="#cb61-66" aria-hidden="true" tabindex="-1"></a>                wpe<span class="op">=</span>NoInitEmbedding(config.block_size, config.n_embd),</span>
<span id="cb61-67"><a href="#cb61-67" aria-hidden="true" tabindex="-1"></a>                h<span class="op">=</span>nn.ModuleList(</span>
<span id="cb61-68"><a href="#cb61-68" aria-hidden="true" tabindex="-1"></a>                    [Block(config) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(config.n_layer)]</span>
<span id="cb61-69"><a href="#cb61-69" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb61-70"><a href="#cb61-70" aria-hidden="true" tabindex="-1"></a>                ln_f<span class="op">=</span>nn.LayerNorm(config.n_embd),</span>
<span id="cb61-71"><a href="#cb61-71" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb61-72"><a href="#cb61-72" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb61-73"><a href="#cb61-73" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lm_head <span class="op">=</span> NoInitLinear(</span>
<span id="cb61-74"><a href="#cb61-74" aria-hidden="true" tabindex="-1"></a>            config.n_embd,</span>
<span id="cb61-75"><a href="#cb61-75" aria-hidden="true" tabindex="-1"></a>            config.vocab_size,</span>
<span id="cb61-76"><a href="#cb61-76" aria-hidden="true" tabindex="-1"></a>            bias<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb61-77"><a href="#cb61-77" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb61-78"><a href="#cb61-78" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.transformer.wte.weight <span class="op">=</span> <span class="va">self</span>.lm_head.weight</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A few weeks after I’d put this code in, I came across this HuggingFace article on <a href="https://huggingface.co/docs/accelerate/en/usage_guides/big_modeling">Big Model Inference</a> where they discuss the very problem I was hitting, which is problematic on much larger models even when you’re using a release build of PyTorch—not just pip-squeak GPT2 models with a debug build—and they have a decorator-oriented solution:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> accelerate <span class="im">import</span> init_empty_weights</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> init_empty_weights():</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    my_model <span class="op">=</span> ModelClass(...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Granted, I couldn’t use <code>accelerate</code> because it depends on packages that are not available for free-threaded builds yet, but I wanted to include the information here for future reference.</p>
</section>
<section id="can-we-load-other-checkpoints" class="level3">
<h3 class="anchored" data-anchor-id="can-we-load-other-checkpoints">Can We Load Other Checkpoints?</h3>
<p>GPT2 was the last model where OpenAI made the weights publicly available. So, in theory, I should be able to download their largest GPT2 model—<a href="https://huggingface.co/openai-community/gpt2-xl">GPT2 XL</a>—figure out how to extract the weights, and then load them into our janky little <code>GPT</code> class instead of the ones from the locally-trained checkpoint.</p>
<p>Turns out downloading it is easy via <code>huggingface-cli</code> (again, not something that works with free-threading, so you’ll need to activate the <code>py313</code> environment and <code>pip install -U "huggingface_hub[cli]"</code> per <a href="https://huggingface.co/docs/huggingface_hub/en/guides/cli">these</a> instructions):</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> huggingface-cli download openai-community/gpt2-xl</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># That should download the model into the following directory.</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> cd ~/.cache/huggingface/hub/models--openai-community--gpt2-xl</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> tree <span class="at">-h</span> .</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="ex">tree</span> <span class="at">-h</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="ex">[4.0K]</span>  .</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> <span class="pp">[</span><span class="ss">4.0K</span><span class="pp">]</span>  blobs</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── [ 124]  057e43033439e068b325f32af95dde9efc9552ae</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── <span class="pp">[</span><span class="ss">6.0G</span><span class="pp">]</span>  0f8b28eb05a8075f48b61b6f35332978c74fc7763fa9fb4051a1c30511736a6a</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── <span class="pp">[</span><span class="ss">1018K</span><span class="pp">]</span>  1f1d9aaca301414e7f6c9396df506798ff4eb9a6</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── <span class="pp">[</span><span class="ss">446K</span><span class="pp">]</span>  226b0752cac7789c48f0cb3ec53eda48b7be36cc</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── [ 12K]  34f1cc31333e001c3047539dd604123dafd37346</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── <span class="pp">[</span><span class="ss">5.8G</span><span class="pp">]</span>  47d4a280f9274f015e8dd1e7e2e1066415fc1f37030ec30d00615973e750e578</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── <span class="pp">[</span><span class="ss">1.3M</span><span class="pp">]</span>  4b988bccc9dc5adacd403c00b4704976196548f8</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── [ 445]  602b71f15d40ed68c5f96330e3f3175a76a32126</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── <span class="pp">[</span><span class="ss">6.3G</span><span class="pp">]</span>  7b92a55d852494754e2856681833ee0ff05580ee32c1d8d60a1177bbf1f4703a</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── [ 689]  932bdee9f4b3878f7f285187564b46f256243aff</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── [  26]  be4d21d94f3b4687e5a54d84bf6ab46ed0f8defd</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── [ 165]  c791c4d01fc484a57262ee57c878dd5b35863fe7</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── <span class="pp">[</span><span class="ss">6.0G</span><span class="pp">]</span>  cd2a29e31040ef64d9362cb96801969c9f67b9e0bdbd6e00b9dda57cdbe17435</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> └── <span class="pp">[</span><span class="ss">5.8G</span><span class="pp">]</span>  fbc167e52fa30c56fbed46e8b45c25893c4afb165ef666864abc0e70d5c117a4</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> <span class="pp">[</span><span class="ss">4.0K</span><span class="pp">]</span>  refs</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> └── [  40]  main</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="ex">└──</span> <span class="pp">[</span><span class="ss">4.0K</span><span class="pp">]</span>  snapshots</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    <span class="ex">└──</span> <span class="pp">[</span><span class="ss">4.0K</span><span class="pp">]</span>  15ea56dee5df4983c59b2538573817e1667135e2</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>        <span class="ex">├──</span> [  52]  config.json <span class="at">-</span><span class="op">&gt;</span> ../../blobs/932bdee9f4b3878f7f285187564b46f256243aff</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>        <span class="ex">├──</span> [  76]  flax_model.msgpack <span class="at">-</span><span class="op">&gt;</span> ../../blobs/fbc167e52fa30c56fbed46e8b45c25893c4afb165ef666864abc0e70d5c117a4</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>        <span class="ex">├──</span> [  52]  generation_config_for_text_generation.json <span class="at">-</span><span class="op">&gt;</span> ../../blobs/c791c4d01fc484a57262ee57c878dd5b35863fe7</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>        <span class="ex">├──</span> [  52]  generation_config.json <span class="at">-</span><span class="op">&gt;</span> ../../blobs/057e43033439e068b325f32af95dde9efc9552ae</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>        <span class="ex">├──</span> [  52]  merges.txt <span class="at">-</span><span class="op">&gt;</span> ../../blobs/226b0752cac7789c48f0cb3ec53eda48b7be36cc</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>        <span class="ex">├──</span> [  76]  model.safetensors <span class="at">-</span><span class="op">&gt;</span> ../../blobs/0f8b28eb05a8075f48b61b6f35332978c74fc7763fa9fb4051a1c30511736a6a</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>        <span class="ex">├──</span> [  76]  pytorch_model.bin <span class="at">-</span><span class="op">&gt;</span> ../../blobs/cd2a29e31040ef64d9362cb96801969c9f67b9e0bdbd6e00b9dda57cdbe17435</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>        <span class="ex">├──</span> [  52]  README.md <span class="at">-</span><span class="op">&gt;</span> ../../blobs/34f1cc31333e001c3047539dd604123dafd37346</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>        <span class="ex">├──</span> [  76]  rust_model.ot <span class="at">-</span><span class="op">&gt;</span> ../../blobs/7b92a55d852494754e2856681833ee0ff05580ee32c1d8d60a1177bbf1f4703a</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>        <span class="ex">├──</span> [  76]  tf_model.h5 <span class="at">-</span><span class="op">&gt;</span> ../../blobs/47d4a280f9274f015e8dd1e7e2e1066415fc1f37030ec30d00615973e750e578</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>        <span class="ex">├──</span> [  52]  tokenizer_config.json <span class="at">-</span><span class="op">&gt;</span> ../../blobs/be4d21d94f3b4687e5a54d84bf6ab46ed0f8defd</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>        <span class="ex">├──</span> [  52]  tokenizer.json <span class="at">-</span><span class="op">&gt;</span> ../../blobs/4b988bccc9dc5adacd403c00b4704976196548f8</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>        <span class="ex">└──</span> [  52]  vocab.json <span class="at">-</span><span class="op">&gt;</span> ../../blobs/1f1d9aaca301414e7f6c9396df506798ff4eb9a6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Well that’s pretty neat, if not a tad duplicative, given the 1.5B parameter model is shipped in five different ~6GB encodings:</p>
<pre><code>│&nbsp;&nbsp; ├── [6.0G]  model.safetensors   (0f8b28...)
│&nbsp;&nbsp; ├── [5.8G]  tf_model.h5         (47d4a2...)
│&nbsp;&nbsp; ├── [6.3G]  rust_model.ot       (7b92a5...)
│&nbsp;&nbsp; ├── [6.0G]  pytorch_model.bin   (cd2a29...)
│&nbsp;&nbsp; └── [5.8G]  flax_model.msgpack  (fbc167...)</code></pre>
<p>The <code>pytorch_model.bin</code> one is a pickled <code>dict</code> of tensors obtained from a <code>torch.save()</code> call—i.e.&nbsp;basically equivalent to the checkpoint we’d been using for the locally trained GPT2 model we used. For whatever reason, that one didn’t interest me much, but <code>model.safetensors</code> did.</p>
<p>Thankfully, I could <code>pip install safetensors</code> in the free-threaded <code>py313t</code> environment, so I wrote some <a href="https://github.com/tpn/parallelopedia/blob/main/src/parallelopedia/util.py#L178">helper glue</a> to give me back a <code>HuggingFaceModel</code> with the tensors accessible via a <code>safetensors</code> attribute if I passed it the appropriate model name, e.g.:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HuggingFaceModel:</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    name: <span class="bu">str</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    config: <span class="bu">dict</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    safetensors: <span class="st">"safetensors.safe_open"</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    tokenizer: <span class="bu">dict</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    tokenizer_config: <span class="bu">dict</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    vocab: <span class="bu">dict</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_huggingface_model(model_name: <span class="bu">str</span>) <span class="op">-&gt;</span> HuggingFaceModel:</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns a Hugging Face model object for the given model name.</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="co">        model_name (str): Supplies the name of the Hugging Face model.  This</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="co">            should be in the format of `namespace/model`, e.g. for GPT2 XL:</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a><span class="co">            `openai-community/gpt2-xl`.  This will be expanded out to the</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a><span class="co">            following directory:</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="co">                `~/.cache/huggingface/hub/models--openai-community--gpt2-xl`</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a><span class="co">        HuggingFaceModel: Returns a HuggingFaceModel object containing the</span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a><span class="co">            model name, configuration, and SafeTensors object.</span></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>    base <span class="op">=</span> os.path.expanduser(<span class="st">'~/.cache/huggingface/hub/models--'</span>)</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>    (namespace, model) <span class="op">=</span> model_name.split(<span class="st">'/'</span>)</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>    base_path <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>base<span class="sc">}{</span>namespace<span class="sc">}</span><span class="ss">--</span><span class="sc">{</span>model<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>    ref_path <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>base_path<span class="sc">}</span><span class="ss">/refs/main'</span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(ref_path, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>        ref <span class="op">=</span> f.read().strip()</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>    snapshots_dir <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>base_path<span class="sc">}</span><span class="ss">/snapshots/</span><span class="sc">{</span>ref<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>    safetensors_path <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>snapshots_dir<span class="sc">}</span><span class="ss">/model.safetensors'</span></span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> safetensors</span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>    timer <span class="op">=</span> ElapsedTimer()</span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>    logging.debug(<span class="ss">f'About to load safetensors from </span><span class="sc">{</span>safetensors_path<span class="sc">}</span><span class="ss">...'</span>)</span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> timer:</span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>        st <span class="op">=</span> safetensors.safe_open(</span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>            safetensors_path,</span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>            framework<span class="op">=</span><span class="st">"pt"</span>,</span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>            device<span class="op">=</span><span class="st">"cpu"</span>,</span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>    msg <span class="op">=</span> (</span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f'Loaded safetensors from </span><span class="sc">{</span>safetensors_path<span class="sc">}</span><span class="ss"> '</span></span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f'in </span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.4f}</span><span class="ss"> seconds.'</span></span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>    logging.info(msg)</span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>    config_path <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>snapshots_dir<span class="sc">}</span><span class="ss">/config.json'</span></span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(config_path, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a>        config <span class="op">=</span> json.load(f)</span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>    tokenizer_path <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>snapshots_dir<span class="sc">}</span><span class="ss">/tokenizer.json'</span></span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(tokenizer_path, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a>        tokenizer <span class="op">=</span> json.load(f)</span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a>    tokenizer_config_path <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>snapshots_dir<span class="sc">}</span><span class="ss">/tokenizer_config.json'</span></span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(tokenizer_config_path, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a>        tokenizer_config <span class="op">=</span> json.load(f)</span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a>    vocab_path <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>snapshots_dir<span class="sc">}</span><span class="ss">/vocab.json'</span></span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(vocab_path, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a>        vocab <span class="op">=</span> json.load(f)</span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-66"><a href="#cb65-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> HuggingFaceModel(</span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a>        model_name,</span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a>        config,</span>
<span id="cb65-69"><a href="#cb65-69" aria-hidden="true" tabindex="-1"></a>        st,</span>
<span id="cb65-70"><a href="#cb65-70" aria-hidden="true" tabindex="-1"></a>        tokenizer,</span>
<span id="cb65-71"><a href="#cb65-71" aria-hidden="true" tabindex="-1"></a>        tokenizer_config,</span>
<span id="cb65-72"><a href="#cb65-72" aria-hidden="true" tabindex="-1"></a>        vocab,</span>
<span id="cb65-73"><a href="#cb65-73" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now, I remember Andrej had a <a href="https://github.com/karpathy/build-nanogpt/blob/master/train_gpt2.py#L130"><code>GPT.from_pretrained()</code></a> routine that was geared toward loading the GPT2 models via the <code>transformers</code> Python package along the following lines:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> GPT2LMHeadModel</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>hf_model <span class="op">=</span> GPT2LMHeadModel.from_pretrained(<span class="st">'gpt2-xl'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The technique he used to prime is local <code>GPT</code> class from the larger model loaded from HuggingFace piqued my interest. I’ve reproduced the applicable code below, with some formatting tweaks only.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a from-scratch initialized minGPT model</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> GPTConfig(<span class="op">**</span>config_args)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GPT(config)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>sd <span class="op">=</span> model.state_dict()</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>sd_keys <span class="op">=</span> sd.keys()</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># discard this mask / buffer, not a param</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>sd_keys <span class="op">=</span> [</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    key <span class="cf">for</span> key <span class="kw">in</span> sd_keys <span class="cf">if</span> <span class="kw">not</span> key.endswith(<span class="st">'.attn.bias'</span>)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co"># init a huggingface/transformers model</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>model_hf <span class="op">=</span> GPT2LMHeadModel.from_pretrained(model_type)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>sd_hf <span class="op">=</span> model_hf.state_dict()</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="co"># copy while ensuring all of the parameters are aligned</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co"># and match in names and shapes</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>sd_keys_hf <span class="op">=</span> sd_hf.keys()</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ignore `.attn.masked_bias`; just a buffer</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>sd_keys_hf <span class="op">=</span> [</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    key <span class="cf">for</span> key <span class="kw">in</span> sd_keys_hf</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> k.endswith(<span class="st">'.attn.masked_bias'</span>)</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a><span class="co"># ditto; ignore `.attn.bias`, just the mask (buffer)</span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>sd_keys_hf <span class="op">=</span> [</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>    key <span class="cf">for</span> key <span class="kw">in</span> sd_keys_hf</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> key.endswith(<span class="st">'.attn.bias'</span>)</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>transposed <span class="op">=</span> [</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'attn.c_attn.weight'</span>,</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'attn.c_proj.weight'</span>,</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mlp.c_fc.weight'</span>,</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mlp.c_proj.weight'</span>,</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a><span class="co"># basically the openai checkpoints use a "Conv1D" module,</span></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a><span class="co"># but we only want to use a vanilla Linear, this means</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a><span class="co"># that we have to transpose these weights when we import them</span></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(sd_keys_hf) <span class="op">==</span> <span class="bu">len</span>(sd_keys), (</span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"mismatched keys: </span><span class="sc">{</span><span class="bu">len</span>(sd_keys_hf)<span class="sc">}</span><span class="ss"> != </span><span class="sc">{</span><span class="bu">len</span>(sd_keys)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> sd_keys_hf:</span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">any</span>(k.endswith(w) <span class="cf">for</span> w <span class="kw">in</span> transposed):</span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># special treatment for the Conv1D weights</span></span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># we need to transpose</span></span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> sd_hf[k].shape[::<span class="op">-</span><span class="dv">1</span>] <span class="op">==</span> sd[k].shape</span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a>            sd[k].copy_(sd_hf[k].t())</span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># vanilla copy over the other parameters</span></span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> sd_hf[k].shape <span class="op">==</span> sd[k].shape</span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true" tabindex="-1"></a>            sd[k].copy_(sd_hf[k])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Do all of that fiddling and <em>et voilà</em>, you’ve just primed your <code>GPT</code> model with the OpenAI weights!</p>
<p>The reason Andrej’s approach piqued my interest—in combination with poking around at a <code>safetensors</code> instance and realizing I could easily extract all 147-or-so tensors by name—was that it may allow us to copy the tensors from the model read from disk into <em>our</em> model in parallel, using multiple threads.</p>
<p>So I hacked together a variant of Andrej’s <code>GPT.from_pretrained()</code> that looked as follows:</p>
<div class="sourceCode" id="annotated-cell-27"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-27-1"><a href="#annotated-cell-27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GPT:</span>
<span id="annotated-cell-27-2"><a href="#annotated-cell-27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-3"><a href="#annotated-cell-27-3" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="annotated-cell-27-4"><a href="#annotated-cell-27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-5"><a href="#annotated-cell-27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="annotated-cell-27-6"><a href="#annotated-cell-27-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> from_pretrained(cls,</span>
<span id="annotated-cell-27-7"><a href="#annotated-cell-27-7" aria-hidden="true" tabindex="-1"></a>                        model_name: <span class="bu">str</span>,</span>
<span id="annotated-cell-27-8"><a href="#annotated-cell-27-8" aria-hidden="true" tabindex="-1"></a>                        map_location: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span>,</span>
<span id="annotated-cell-27-9"><a href="#annotated-cell-27-9" aria-hidden="true" tabindex="-1"></a>                        manual_seed: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span>,</span>
<span id="annotated-cell-27-10"><a href="#annotated-cell-27-10" aria-hidden="true" tabindex="-1"></a>                        torch_profile_activities: Optional[List[<span class="bu">type</span>]] <span class="op">=</span> <span class="va">None</span>,</span>
<span id="annotated-cell-27-11"><a href="#annotated-cell-27-11" aria-hidden="true" tabindex="-1"></a>                        ) <span class="op">-&gt;</span> <span class="st">"GPT"</span>:</span>
<span id="annotated-cell-27-12"><a href="#annotated-cell-27-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="annotated-cell-27-13"><a href="#annotated-cell-27-13" aria-hidden="true" tabindex="-1"></a><span class="co">        Load a GPT model from a pretrained model.</span></span>
<span id="annotated-cell-27-14"><a href="#annotated-cell-27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-15"><a href="#annotated-cell-27-15" aria-hidden="true" tabindex="-1"></a><span class="co">        Arguments:</span></span>
<span id="annotated-cell-27-16"><a href="#annotated-cell-27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-17"><a href="#annotated-cell-27-17" aria-hidden="true" tabindex="-1"></a><span class="co">            model_name (str): Supplies the model name to use.  See the</span></span>
<span id="annotated-cell-27-18"><a href="#annotated-cell-27-18" aria-hidden="true" tabindex="-1"></a><span class="co">                docstring for `.util.get_huggingface_safetensors()` for</span></span>
<span id="annotated-cell-27-19"><a href="#annotated-cell-27-19" aria-hidden="true" tabindex="-1"></a><span class="co">                more information about the format.</span></span>
<span id="annotated-cell-27-20"><a href="#annotated-cell-27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-21"><a href="#annotated-cell-27-21" aria-hidden="true" tabindex="-1"></a><span class="co">            map_location (str): Optionally supplies the device to map the</span></span>
<span id="annotated-cell-27-22"><a href="#annotated-cell-27-22" aria-hidden="true" tabindex="-1"></a><span class="co">                loaded tensor parameters to.  If None, "cuda" will be used</span></span>
<span id="annotated-cell-27-23"><a href="#annotated-cell-27-23" aria-hidden="true" tabindex="-1"></a><span class="co">                if available, otherwise "cpu".</span></span>
<span id="annotated-cell-27-24"><a href="#annotated-cell-27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-25"><a href="#annotated-cell-27-25" aria-hidden="true" tabindex="-1"></a><span class="co">            manual_seed (int): Optionally supplies the manual seed to use for</span></span>
<span id="annotated-cell-27-26"><a href="#annotated-cell-27-26" aria-hidden="true" tabindex="-1"></a><span class="co">                the model.  If None, a random seed will be used.</span></span>
<span id="annotated-cell-27-27"><a href="#annotated-cell-27-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-28"><a href="#annotated-cell-27-28" aria-hidden="true" tabindex="-1"></a><span class="co">            torch_profile_activities (list): Optionally supplies a list of</span></span>
<span id="annotated-cell-27-29"><a href="#annotated-cell-27-29" aria-hidden="true" tabindex="-1"></a><span class="co">                torch.profiler.ProfilerActivity to profile.</span></span>
<span id="annotated-cell-27-30"><a href="#annotated-cell-27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-31"><a href="#annotated-cell-27-31" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="annotated-cell-27-32"><a href="#annotated-cell-27-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> manual_seed <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="annotated-cell-27-33"><a href="#annotated-cell-27-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Use a random seed.</span></span>
<span id="annotated-cell-27-34"><a href="#annotated-cell-27-34" aria-hidden="true" tabindex="-1"></a>            manual_seed <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="dv">2</span><span class="op">**</span><span class="dv">32</span> <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="annotated-cell-27-35"><a href="#annotated-cell-27-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-36"><a href="#annotated-cell-27-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> map_location <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="annotated-cell-27-37"><a href="#annotated-cell-27-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> torch.cuda.is_available():</span>
<span id="annotated-cell-27-38"><a href="#annotated-cell-27-38" aria-hidden="true" tabindex="-1"></a>                map_location <span class="op">=</span> <span class="st">"cuda"</span></span>
<span id="annotated-cell-27-39"><a href="#annotated-cell-27-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="annotated-cell-27-40"><a href="#annotated-cell-27-40" aria-hidden="true" tabindex="-1"></a>                map_location <span class="op">=</span> <span class="st">"cpu"</span></span>
<span id="annotated-cell-27-41"><a href="#annotated-cell-27-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-42"><a href="#annotated-cell-27-42" aria-hidden="true" tabindex="-1"></a>        timer <span class="op">=</span> ElapsedTimer()</span>
<span id="annotated-cell-27-43"><a href="#annotated-cell-27-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> timer:</span>
<span id="annotated-cell-27-44"><a href="#annotated-cell-27-44" aria-hidden="true" tabindex="-1"></a>            hf_model <span class="op">=</span> get_huggingface_model(model_name)</span>
<span id="annotated-cell-27-45"><a href="#annotated-cell-27-45" aria-hidden="true" tabindex="-1"></a>        msg <span class="op">=</span> (</span>
<span id="annotated-cell-27-46"><a href="#annotated-cell-27-46" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'Loaded HuggingFace model </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss"> in '</span></span>
<span id="annotated-cell-27-47"><a href="#annotated-cell-27-47" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'</span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span></span>
<span id="annotated-cell-27-48"><a href="#annotated-cell-27-48" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="annotated-cell-27-49"><a href="#annotated-cell-27-49" aria-hidden="true" tabindex="-1"></a>        logging.info(msg)</span>
<span id="annotated-cell-27-50"><a href="#annotated-cell-27-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-51"><a href="#annotated-cell-27-51" aria-hidden="true" tabindex="-1"></a>        config <span class="op">=</span> GPTConfig(<span class="op">**</span>{</span>
<span id="annotated-cell-27-52"><a href="#annotated-cell-27-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">'block_size'</span>: hf_model.config[<span class="st">'n_ctx'</span>],</span>
<span id="annotated-cell-27-53"><a href="#annotated-cell-27-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">'vocab_size'</span>: hf_model.config[<span class="st">'vocab_size'</span>],</span>
<span id="annotated-cell-27-54"><a href="#annotated-cell-27-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">'n_layer'</span>: hf_model.config[<span class="st">'n_layer'</span>],</span>
<span id="annotated-cell-27-55"><a href="#annotated-cell-27-55" aria-hidden="true" tabindex="-1"></a>            <span class="st">'n_head'</span>: hf_model.config[<span class="st">'n_head'</span>],</span>
<span id="annotated-cell-27-56"><a href="#annotated-cell-27-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">'n_embd'</span>: hf_model.config[<span class="st">'n_embd'</span>],</span>
<span id="annotated-cell-27-57"><a href="#annotated-cell-27-57" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="annotated-cell-27-58"><a href="#annotated-cell-27-58" aria-hidden="true" tabindex="-1"></a>        checkpoint <span class="op">=</span> GPTCheckpoint(<span class="op">**</span>{</span>
<span id="annotated-cell-27-59"><a href="#annotated-cell-27-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">'model'</span>: <span class="va">None</span>,</span>
<span id="annotated-cell-27-60"><a href="#annotated-cell-27-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">'step'</span>: <span class="dv">0</span>,</span>
<span id="annotated-cell-27-61"><a href="#annotated-cell-27-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">'val_loss'</span>: <span class="fl">0.0</span>,</span>
<span id="annotated-cell-27-62"><a href="#annotated-cell-27-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">'config'</span>: config,</span>
<span id="annotated-cell-27-63"><a href="#annotated-cell-27-63" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="annotated-cell-27-64"><a href="#annotated-cell-27-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-65"><a href="#annotated-cell-27-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> timer:</span>
<span id="annotated-cell-27-66"><a href="#annotated-cell-27-66" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> cls(</span>
<span id="annotated-cell-27-67"><a href="#annotated-cell-27-67" aria-hidden="true" tabindex="-1"></a>                checkpoint<span class="op">=</span>checkpoint,</span>
<span id="annotated-cell-27-68"><a href="#annotated-cell-27-68" aria-hidden="true" tabindex="-1"></a>                device<span class="op">=</span>map_location,</span>
<span id="annotated-cell-27-69"><a href="#annotated-cell-27-69" aria-hidden="true" tabindex="-1"></a>                manual_seed<span class="op">=</span>manual_seed,</span>
<span id="annotated-cell-27-70"><a href="#annotated-cell-27-70" aria-hidden="true" tabindex="-1"></a>                torch_profile_activities<span class="op">=</span>torch_profile_activities,</span>
<span id="annotated-cell-27-71"><a href="#annotated-cell-27-71" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="annotated-cell-27-72"><a href="#annotated-cell-27-72" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f'Created GPT model in </span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span>)</span>
<span id="annotated-cell-27-73"><a href="#annotated-cell-27-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-74"><a href="#annotated-cell-27-74" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This logic is based heavily off build-nanogpt's `train_gpt2.py`;</span></span>
<span id="annotated-cell-27-75"><a href="#annotated-cell-27-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># specifically: GPT.from_pretrained().</span></span>
<span id="annotated-cell-27-76"><a href="#annotated-cell-27-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-77"><a href="#annotated-cell-27-77" aria-hidden="true" tabindex="-1"></a>        exclude <span class="op">=</span> (<span class="st">'.attn.bias'</span>, <span class="st">'.attn.masked_bias'</span>, <span class="st">'lm_head.weight'</span>)</span>
<span id="annotated-cell-27-78"><a href="#annotated-cell-27-78" aria-hidden="true" tabindex="-1"></a>        transpose <span class="op">=</span> (</span>
<span id="annotated-cell-27-79"><a href="#annotated-cell-27-79" aria-hidden="true" tabindex="-1"></a>            <span class="st">'attn.c_attn.weight'</span>,</span>
<span id="annotated-cell-27-80"><a href="#annotated-cell-27-80" aria-hidden="true" tabindex="-1"></a>            <span class="st">'attn.c_proj.weight'</span>,</span>
<span id="annotated-cell-27-81"><a href="#annotated-cell-27-81" aria-hidden="true" tabindex="-1"></a>            <span class="st">'mlp.c_fc.weight'</span>,</span>
<span id="annotated-cell-27-82"><a href="#annotated-cell-27-82" aria-hidden="true" tabindex="-1"></a>            <span class="st">'mlp.c_proj.weight'</span>,</span>
<span id="annotated-cell-27-83"><a href="#annotated-cell-27-83" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="annotated-cell-27-84"><a href="#annotated-cell-27-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-85"><a href="#annotated-cell-27-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Identify the HuggingFace keys we're interested in.</span></span>
<span id="annotated-cell-27-86"><a href="#annotated-cell-27-86" aria-hidden="true" tabindex="-1"></a>        st <span class="op">=</span> hf_model.safetensors</span>
<span id="annotated-cell-27-87"><a href="#annotated-cell-27-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-88"><a href="#annotated-cell-27-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Identify our model keys we're interested in.</span></span>
<span id="annotated-cell-27-89"><a href="#annotated-cell-27-89" aria-hidden="true" tabindex="-1"></a>        sd <span class="op">=</span> model.state_dict()</span>
<span id="annotated-cell-27-90"><a href="#annotated-cell-27-90" aria-hidden="true" tabindex="-1"></a>        sd_keys <span class="op">=</span> [k <span class="cf">for</span> k <span class="kw">in</span> sd.keys() <span class="cf">if</span> <span class="kw">not</span> k.endswith(exclude)]</span>
<span id="annotated-cell-27-91"><a href="#annotated-cell-27-91" aria-hidden="true" tabindex="-1"></a>        hf_keys <span class="op">=</span> [k.replace(<span class="st">'transformer.'</span>, <span class="st">''</span>) <span class="cf">for</span> k <span class="kw">in</span> sd_keys]</span>
<span id="annotated-cell-27-92"><a href="#annotated-cell-27-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-93"><a href="#annotated-cell-27-93" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Copying tensors in parallel yields decent speedups,</span></span>
<span id="annotated-cell-27-94"><a href="#annotated-cell-27-94" aria-hidden="true" tabindex="-1"></a>        <span class="co"># at least on my V100s which have five concurrent copy</span></span>
<span id="annotated-cell-27-95"><a href="#annotated-cell-27-95" aria-hidden="true" tabindex="-1"></a>        <span class="co"># engines.</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-27" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-27-96" class="code-annotation-target"><a href="#annotated-cell-27-96" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> copy_tensor(hf_key, sd_key):</span>
<span id="annotated-cell-27-97"><a href="#annotated-cell-27-97" aria-hidden="true" tabindex="-1"></a>            hf_tensor <span class="op">=</span> st.get_tensor(hf_key)</span>
<span id="annotated-cell-27-98"><a href="#annotated-cell-27-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> hf_key.endswith(transpose):</span>
<span id="annotated-cell-27-99"><a href="#annotated-cell-27-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">assert</span> hf_tensor.shape[::<span class="op">-</span><span class="dv">1</span>] <span class="op">==</span> sd[sd_key].shape</span>
<span id="annotated-cell-27-100"><a href="#annotated-cell-27-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> torch.no_grad():</span>
<span id="annotated-cell-27-101"><a href="#annotated-cell-27-101" aria-hidden="true" tabindex="-1"></a>                    sd[sd_key].copy_(hf_tensor.t())</span>
<span id="annotated-cell-27-102"><a href="#annotated-cell-27-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="annotated-cell-27-103"><a href="#annotated-cell-27-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">assert</span> hf_tensor.shape <span class="op">==</span> sd[sd_key].shape</span>
<span id="annotated-cell-27-104"><a href="#annotated-cell-27-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> torch.no_grad():</span>
<span id="annotated-cell-27-105"><a href="#annotated-cell-27-105" aria-hidden="true" tabindex="-1"></a>                    sd[sd_key].copy_(hf_tensor)</span>
<span id="annotated-cell-27-106"><a href="#annotated-cell-27-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-107"><a href="#annotated-cell-27-107" aria-hidden="true" tabindex="-1"></a>        keys <span class="op">=</span> <span class="bu">zip</span>(hf_keys, sd_keys)</span>
<span id="annotated-cell-27-108"><a href="#annotated-cell-27-108" aria-hidden="true" tabindex="-1"></a>        max_workers <span class="op">=</span> <span class="bu">min</span>(os.cpu_count(), <span class="bu">len</span>(sd_keys))</span>
<span id="annotated-cell-27-109"><a href="#annotated-cell-27-109" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> timer:</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-27" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-27-110" class="code-annotation-target"><a href="#annotated-cell-27-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> ThreadPoolExecutor(</span>
<span id="annotated-cell-27-111"><a href="#annotated-cell-27-111" aria-hidden="true" tabindex="-1"></a>                max_workers<span class="op">=</span>max_workers</span>
<span id="annotated-cell-27-112"><a href="#annotated-cell-27-112" aria-hidden="true" tabindex="-1"></a>            ) <span class="im">as</span> executor:</span>
<span id="annotated-cell-27-113"><a href="#annotated-cell-27-113" aria-hidden="true" tabindex="-1"></a>                futures <span class="op">=</span> {</span>
<span id="annotated-cell-27-114"><a href="#annotated-cell-27-114" aria-hidden="true" tabindex="-1"></a>                    executor.submit(copy_tensor, hf_key, sd_key):</span>
<span id="annotated-cell-27-115"><a href="#annotated-cell-27-115" aria-hidden="true" tabindex="-1"></a>                        (hf_key, sd_key)</span>
<span id="annotated-cell-27-116"><a href="#annotated-cell-27-116" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">for</span> (hf_key, sd_key) <span class="kw">in</span> keys</span>
<span id="annotated-cell-27-117"><a href="#annotated-cell-27-117" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="annotated-cell-27-118"><a href="#annotated-cell-27-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> future <span class="kw">in</span> as_completed(futures):</span>
<span id="annotated-cell-27-119"><a href="#annotated-cell-27-119" aria-hidden="true" tabindex="-1"></a>                    future.result()</span>
<span id="annotated-cell-27-120"><a href="#annotated-cell-27-120" aria-hidden="true" tabindex="-1"></a>        logging.info(</span>
<span id="annotated-cell-27-121"><a href="#annotated-cell-27-121" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'Copied weights with </span><span class="sc">{</span>max_workers<span class="sc">}</span><span class="ss"> thread(s) '</span></span>
<span id="annotated-cell-27-122"><a href="#annotated-cell-27-122" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'in </span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span></span>
<span id="annotated-cell-27-123"><a href="#annotated-cell-27-123" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="annotated-cell-27-124"><a href="#annotated-cell-27-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-125"><a href="#annotated-cell-27-125" aria-hidden="true" tabindex="-1"></a>        device <span class="op">=</span> map_location</span>
<span id="annotated-cell-27-126"><a href="#annotated-cell-27-126" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> timer:</span>
<span id="annotated-cell-27-127"><a href="#annotated-cell-27-127" aria-hidden="true" tabindex="-1"></a>            model.to(device)</span>
<span id="annotated-cell-27-128"><a href="#annotated-cell-27-128" aria-hidden="true" tabindex="-1"></a>        msg <span class="op">=</span> <span class="ss">f'Moved model to </span><span class="sc">{</span>device<span class="sc">}</span><span class="ss"> in </span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span></span>
<span id="annotated-cell-27-129"><a href="#annotated-cell-27-129" aria-hidden="true" tabindex="-1"></a>        logging.info(msg)</span>
<span id="annotated-cell-27-130"><a href="#annotated-cell-27-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-27-131"><a href="#annotated-cell-27-131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> model</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-27" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-27" data-code-lines="96,97,98,99,100,101,102,103,104,105" data-code-annotation="1">Define a <code>copy_tensor</code> function that is provided with the name of a tensor key as it appears in the HuggingFace model (<code>hf_key</code>) and as it appears in our <code>state_dict</code> model (<code>sd_key</code>). The <code>sd</code> state dict is accessible to all threads, so they can simply copy their tensor via <code>sd[sd_key].copy_(hf_tensor)</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-27" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-27" data-code-lines="110,111,112,113,114,115,116,117,118,119" data-code-annotation="2">Use a <code>ThreadPoolExecutor()</code> to dispatch the <code>copy_tensor</code> operations in parallel. In this case I’m using workers equivalent to the number of CPU cores, <em>or</em> number of tensors, whichever is fewer.</span>
</dd>
</dl>
<p>So that all worked pretty well, free-threading can absolutely be used to speed up things like loading tensors.</p>
<p>Additionally, if you play around with this locally, the <code>gpt2-xl</code> model will be available to select from the drop-down in the UI and also can be used via the command line (<code>--model gpt2-xl</code>) or in the REST <code>/generate</code> endpoint as a query parameter (<code>/generate/foo...?model=gpt2-xl</code>).</p>
</section>
<section id="multi-gpu-support" class="level3">
<h3 class="anchored" data-anchor-id="multi-gpu-support">Multi-GPU Support</h3>
<p>The final big change I introduced was multi-GPU support plus some very rudimentary round-robin-esque behavior that could be used from the <code>generate()</code> routines to obtain a reference to a model depending on the incoming user’s request.</p>
<p>The <code>generate()</code> routine now obtains a model by the following:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> get_next_model()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The implementation for which is <a href="https://github.com/tpn/parallelopedia/blob/main/src/parallelopedia/gpt2.py#L103">here</a>, reproduced in part below:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>NUM_GPUS <span class="op">=</span> torch.cuda.device_count()</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a CPU version at the end.</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>TOTAL_MODELS <span class="op">=</span> NUM_GPUS <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>MODELS <span class="op">=</span> [<span class="va">None</span>] <span class="op">*</span> TOTAL_MODELS</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>MODELS_ROUND_ROBIN <span class="op">=</span> itertools.cycle(<span class="bu">range</span>(TOTAL_MODELS))</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_next_model_random():</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Randomly select a GPU to use.</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> MODELS[random.randint(<span class="dv">0</span>, TOTAL_MODELS <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_next_model_round_robin():</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> MODELS_LOCK:</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>        index <span class="op">=</span> <span class="bu">next</span>(MODELS_ROUND_ROBIN)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> MODELS[index]</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>get_next_model <span class="op">=</span> get_next_model_round_robin</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_models():</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> MODELS</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>    max_workers <span class="op">=</span> <span class="bu">min</span>(TOTAL_MODELS, os.cpu_count())</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>    timer <span class="op">=</span> ElapsedTimer()</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> timer:</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> ThreadPoolExecutor(max_workers<span class="op">=</span>max_workers) <span class="im">as</span> executor:</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>            futures <span class="op">=</span> {</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>                executor.submit(</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>                    GPT.from_local_pretrained,</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>                    model_path<span class="op">=</span>MODEL_CHECKPOINT,</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>                    map_location<span class="op">=</span><span class="ss">f'cuda:</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>                    torch_profile_activities<span class="op">=</span>TORCH_PROFILE_ACTIVITIES,</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>                ): i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(NUM_GPUS)</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Add the CPU model.</span></span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>            futures[executor.submit(</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>                GPT.from_local_pretrained,</span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a>                model_path<span class="op">=</span>MODEL_CHECKPOINT,</span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>                map_location<span class="op">=</span><span class="st">'cpu'</span>,</span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>                torch_profile_activities<span class="op">=</span>TORCH_PROFILE_ACTIVITIES,</span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>            )] <span class="op">=</span> NUM_GPUS</span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> future <span class="kw">in</span> as_completed(futures):</span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a>                i <span class="op">=</span> futures[future]</span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a>                model <span class="op">=</span> future.result()</span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a>                MODELS[i] <span class="op">=</span> model</span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a>    msg <span class="op">=</span> (</span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f'Loaded model on </span><span class="sc">{</span>NUM_GPUS<span class="sc">}</span><span class="ss"> GPU(s) and 1 CPU in '</span></span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f'</span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span></span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a>    logging.info(msg)</span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a>PRETRAINED_MODELS <span class="op">=</span> [<span class="va">None</span>] <span class="op">*</span> TOTAL_MODELS</span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a>PRETRAINED_MODELS_ROUND_ROBIN <span class="op">=</span> itertools.cycle(<span class="bu">range</span>(TOTAL_MODELS))</span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_next_pretrained_model_random():</span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Randomly select a GPU to use.</span></span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> PRETRAINED_MODELS[random.randint(<span class="dv">0</span>, TOTAL_MODELS <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_next_pretrained_model_round_robin():</span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> PRETRAINED_MODELS_LOCK:</span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true" tabindex="-1"></a>        index <span class="op">=</span> <span class="bu">next</span>(PRETRAINED_MODELS_ROUND_ROBIN)</span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> PRETRAINED_MODELS[index]</span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true" tabindex="-1"></a>get_next_pretrained_model <span class="op">=</span> get_next_pretrained_model_round_robin</span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_pretrained_models():</span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> PRETRAINED_MODELS</span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true" tabindex="-1"></a>    max_workers <span class="op">=</span> <span class="bu">min</span>(TOTAL_MODELS, os.cpu_count())</span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true" tabindex="-1"></a>    timer <span class="op">=</span> ElapsedTimer()</span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> timer:</span>
<span id="cb69-68"><a href="#cb69-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> ThreadPoolExecutor(max_workers<span class="op">=</span>max_workers) <span class="im">as</span> executor:</span>
<span id="cb69-69"><a href="#cb69-69" aria-hidden="true" tabindex="-1"></a>            futures <span class="op">=</span> {</span>
<span id="cb69-70"><a href="#cb69-70" aria-hidden="true" tabindex="-1"></a>                executor.submit(</span>
<span id="cb69-71"><a href="#cb69-71" aria-hidden="true" tabindex="-1"></a>                    GPT.from_pretrained,</span>
<span id="cb69-72"><a href="#cb69-72" aria-hidden="true" tabindex="-1"></a>                    model_name<span class="op">=</span><span class="st">'openai-community/gpt2-xl'</span>,</span>
<span id="cb69-73"><a href="#cb69-73" aria-hidden="true" tabindex="-1"></a>                    map_location<span class="op">=</span><span class="ss">f'cuda:</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb69-74"><a href="#cb69-74" aria-hidden="true" tabindex="-1"></a>                    torch_profile_activities<span class="op">=</span>TORCH_PROFILE_ACTIVITIES,</span>
<span id="cb69-75"><a href="#cb69-75" aria-hidden="true" tabindex="-1"></a>                ): i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(NUM_GPUS)</span>
<span id="cb69-76"><a href="#cb69-76" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb69-77"><a href="#cb69-77" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Add the CPU model.</span></span>
<span id="cb69-78"><a href="#cb69-78" aria-hidden="true" tabindex="-1"></a>            futures[executor.submit(</span>
<span id="cb69-79"><a href="#cb69-79" aria-hidden="true" tabindex="-1"></a>                GPT.from_pretrained,</span>
<span id="cb69-80"><a href="#cb69-80" aria-hidden="true" tabindex="-1"></a>                model_name<span class="op">=</span><span class="st">'openai-community/gpt2-xl'</span>,</span>
<span id="cb69-81"><a href="#cb69-81" aria-hidden="true" tabindex="-1"></a>                map_location<span class="op">=</span><span class="st">'cpu'</span>,</span>
<span id="cb69-82"><a href="#cb69-82" aria-hidden="true" tabindex="-1"></a>                torch_profile_activities<span class="op">=</span>TORCH_PROFILE_ACTIVITIES,</span>
<span id="cb69-83"><a href="#cb69-83" aria-hidden="true" tabindex="-1"></a>            )] <span class="op">=</span> NUM_GPUS</span>
<span id="cb69-84"><a href="#cb69-84" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> future <span class="kw">in</span> as_completed(futures):</span>
<span id="cb69-85"><a href="#cb69-85" aria-hidden="true" tabindex="-1"></a>                i <span class="op">=</span> futures[future]</span>
<span id="cb69-86"><a href="#cb69-86" aria-hidden="true" tabindex="-1"></a>                model <span class="op">=</span> future.result()</span>
<span id="cb69-87"><a href="#cb69-87" aria-hidden="true" tabindex="-1"></a>                PRETRAINED_MODELS[i] <span class="op">=</span> model</span>
<span id="cb69-88"><a href="#cb69-88" aria-hidden="true" tabindex="-1"></a>    msg <span class="op">=</span> (</span>
<span id="cb69-89"><a href="#cb69-89" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f'Loaded gpt2-xl model on </span><span class="sc">{</span>NUM_GPUS<span class="sc">}</span><span class="ss"> GPU(s) and 1 CPU in '</span></span>
<span id="cb69-90"><a href="#cb69-90" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f'</span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span></span>
<span id="cb69-91"><a href="#cb69-91" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb69-92"><a href="#cb69-92" aria-hidden="true" tabindex="-1"></a>    logging.info(msg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="model-optimization" class="level2">
<h2 class="anchored" data-anchor-id="model-optimization">Model Optimization</h2>
<p>Two facilities are available to speed up your model in PyTorch: <a href="https://pytorch.org/docs/stable/jit.html">TorchScript</a>, and <a href="https://pytorch.org/docs/stable/torch.compiler_dynamo_overview.html">Torch Dynamo</a>, with the latter being a newer approach than the former.</p>
<p>In our <a href="https://github.com/tpn/parallelopedia/blob/main/src/parallelopedia/gpt2.py">parallelopedia.gpt2</a> module, our <code>Gpt2App</code> class has a <code>classmethod</code> named <code>init_once()</code>, which, as you can probably guess, gets called once by the HTTP server when starting up. This is where you stash expensive setup code like loading and compiling models.</p>
<p>The code looks similar to the following. We have two globals, <code>TORCH_JIT_COMPILE</code> and <code>TORCH_DYNAMO_COMPILE</code> that, when set, will attempt to optimize the models using the selected method.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Gpt2App(HttpApp):</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> init_once(cls):</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>        load_models()</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>        load_pretrained_models()</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">global</span> MODELS, PRETRAINED_MODELS</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This doesn't work because torch.jit doesn't handle our</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># async generator.</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">global</span> TRY_JIT_COMPILE</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> TRY_JIT_COMPILE:</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (i, model) <span class="kw">in</span> <span class="bu">enumerate</span>(MODELS):</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>                model.config <span class="op">=</span> dataclasses.asdict(model.config)</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>                timer <span class="op">=</span> ElapsedTimer()</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> timer:</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>                    model <span class="op">=</span> torch.jit.script(model)</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>                    MODELS[i] <span class="op">=</span> model</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>                logging.info(</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f'JIT compiled model </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> in </span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">global</span> TRY_TORCH_COMPILE</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> TRY_TORCH_COMPILE:</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (i, model) <span class="kw">in</span> <span class="bu">enumerate</span>(MODELS):</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>                model.config <span class="op">=</span> dataclasses.asdict(model.config)</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>                timer <span class="op">=</span> ElapsedTimer()</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> timer:</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>                    model <span class="op">=</span> torch.<span class="bu">compile</span>(model)</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>                    MODELS[i] <span class="op">=</span> model</span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>                logging.info(</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f'torch.compiled model </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> in '</span></span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f'</span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span></span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (i, model) <span class="kw">in</span> <span class="bu">enumerate</span>(PRETRAINED_MODELS):</span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>                model.config <span class="op">=</span> dataclasses.asdict(model.config)</span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>                timer <span class="op">=</span> ElapsedTimer()</span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> timer:</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>                    model <span class="op">=</span> torch.<span class="bu">compile</span>(model)</span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>                    PRETRAINED_MODELS[i] <span class="op">=</span> model</span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>                logging.info(</span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f'torch.compiled pretrained model </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> in '</span></span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f'</span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span></span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="torchscript" class="level3">
<h3 class="anchored" data-anchor-id="torchscript">TorchScript</h3>
<p>TorchScript doesn’t work at all for our model—it balks on the <code>async def generate_async_for()</code> routine that is the workhorse of our asynchronous token-by-token generation.</p>
<p>And that ended my TorchScript experiment :-)</p>
</section>
<section id="torch-dynamo-torch.compile" class="level3">
<h3 class="anchored" data-anchor-id="torch-dynamo-torch.compile">Torch Dynamo (torch.compile)</h3>
<p>Torch Dynamo is a new feature that was introduced by PyTorch 2.0 that hooks into the Python interpreter and traces model execution and then builds optimized kernels based on the information observed during runtime tracing.</p>
<p>When it works, it works really well, and you can get significant speedups both in training and inference with literally a single line:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> torch.<span class="bu">compile</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The first problem we hit with Dynamo is that it’s explicitly not supported by PyTorch on free-threaded builds:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> model <span class="op">=</span> torch.<span class="bu">compile</span>(model)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="op">---------------------------------------------------------------------------</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="pp">RuntimeError</span>                              Traceback (most recent call last)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>Cell In[<span class="dv">3</span>], line <span class="dv">1</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="op">----&gt;</span> <span class="dv">1</span> model <span class="op">=</span> torch.<span class="bu">compile</span>(model)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>File <span class="op">~/</span>mambaforge<span class="op">/</span>envs<span class="op">/</span>py313t<span class="op">/</span>lib<span class="op">/</span>python3<span class="fl">.13</span><span class="er">t</span><span class="op">/</span>site<span class="op">-</span>packages<span class="op">/</span>torch<span class="op">/</span><span class="fu">__init__</span>.py:<span class="dv">2526</span>, <span class="kw">in</span> <span class="bu">compile</span>(model, fullgraph, dynamic, backend, mode, options, disable)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2524</span>     <span class="cf">raise</span> <span class="pp">RuntimeError</span>(<span class="st">"torch.compile is not supported on Python 3.14+"</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2525</span> <span class="cf">elif</span> sysconfig.get_config_var(<span class="st">"Py_GIL_DISABLED"</span>) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="op">-&gt;</span> <span class="dv">2526</span>     <span class="cf">raise</span> <span class="pp">RuntimeError</span>(</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2527</span>         <span class="st">"torch.compile is not supported on Python built with GIL disabled"</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2528</span>     )</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2530</span> <span class="co"># Decorator mode</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2531</span> <span class="cf">if</span> model <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="pp">RuntimeError</span>: torch.<span class="bu">compile</span> <span class="kw">is</span> <span class="kw">not</span> supported on Python built <span class="cf">with</span> GIL disabled</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let’s hack that <code>torch/__init__.py</code> file as follows and try again.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode diff code-with-copy"><code class="sourceCode diff"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">--- __init__.py.orig    2025-02-09 13:28:27.892979258 -0800</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="dt">+++ __init__.py 2025-02-09 13:30:13.879909529 -0800</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="dt">@@ -2523,9 +2523,7 @@</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>     if sys.version_info &gt;= (3, 14):</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>         raise RuntimeError("torch.compile is not supported on Python 3.14+")</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>     elif sysconfig.get_config_var("Py_GIL_DISABLED") == 1:</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="st">-        raise RuntimeError(</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="st">-            "torch.compile is not supported on Python built with GIL disabled"</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="st">-        )</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="va">+        print("torch.__init__: Ignoring unsupported torch.compile() with no GIL unsupported")</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>     # Decorator mode</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>     if model is None:</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> model <span class="op">=</span> torch.<span class="bu">compile</span>(model)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>torch.<span class="fu">__init__</span>: Ignoring unsupported torch.<span class="bu">compile</span>() <span class="cf">with</span> no GIL unsupported</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="op">---------------------------------------------------------------------------</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="pp">RuntimeError</span>                              Traceback (most recent call last)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>Cell In[<span class="dv">3</span>], line <span class="dv">1</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="op">----&gt;</span> <span class="dv">1</span> model <span class="op">=</span> torch.<span class="bu">compile</span>(model)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>File <span class="op">~/</span>mambaforge<span class="op">/</span>envs<span class="op">/</span>py313t<span class="op">/</span>lib<span class="op">/</span>python3<span class="fl">.13</span><span class="er">t</span><span class="op">/</span>site<span class="op">-</span>packages<span class="op">/</span>torch<span class="op">/</span><span class="fu">__init__</span>.py:<span class="dv">2563</span>, <span class="kw">in</span> <span class="bu">compile</span>(model, fullgraph, dynamic, backend, mode, options, disable)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2560</span> <span class="cf">else</span>:</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2561</span>     backend <span class="op">=</span> _TorchCompileWrapper(backend, mode, options, dynamic)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="op">-&gt;</span> <span class="dv">2563</span> <span class="cf">return</span> torch._dynamo.optimize(</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2564</span>     backend<span class="op">=</span>backend,</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2565</span>     nopython<span class="op">=</span>fullgraph,</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2566</span>     dynamic<span class="op">=</span>dynamic,</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2567</span>     disable<span class="op">=</span>disable,</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2568</span> )(model)</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>File <span class="op">~/</span>mambaforge<span class="op">/</span>envs<span class="op">/</span>py313t<span class="op">/</span>lib<span class="op">/</span>python3<span class="fl">.13</span><span class="er">t</span><span class="op">/</span>site<span class="op">-</span>packages<span class="op">/</span>torch<span class="op">/</span>_dynamo<span class="op">/</span>eval_frame.py:<span class="dv">842</span>, <span class="kw">in</span> optimize(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>    <span class="dv">839</span>         kwargs[<span class="st">"nopython"</span>] <span class="op">=</span> ca_kwargs_override[<span class="st">"fullgraph"</span>]</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>    <span class="dv">840</span>     <span class="cf">return</span> optimize(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a><span class="op">--&gt;</span> <span class="dv">842</span> <span class="cf">return</span> _optimize(rebuild_ctx, <span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>File <span class="op">~/</span>mambaforge<span class="op">/</span>envs<span class="op">/</span>py313t<span class="op">/</span>lib<span class="op">/</span>python3<span class="fl">.13</span><span class="er">t</span><span class="op">/</span>site<span class="op">-</span>packages<span class="op">/</span>torch<span class="op">/</span>_dynamo<span class="op">/</span>eval_frame.py:<span class="dv">881</span>, <span class="kw">in</span> _optimize(rebuild_ctx, backend, nopython, guard_export_fn, guard_fail_fn, disable, dynamic)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>    <span class="dv">845</span> <span class="kw">def</span> _optimize(</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>    <span class="dv">846</span>     rebuild_ctx: Callable[[], Union[OptimizeContext, _NullDecorator]],</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>    <span class="dv">847</span>     backend<span class="op">=</span><span class="st">"inductor"</span>,</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>   (...)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>    <span class="dv">853</span>     dynamic<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>    <span class="dv">854</span> ) <span class="op">-&gt;</span> Union[OptimizeContext, _NullDecorator]:</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>    <span class="dv">855</span>     <span class="st">"""</span></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a><span class="st">    856     The main entrypoint of TorchDynamo.  Do graph capture and call</span></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a><span class="st">    857     backend() to optimize extracted graphs.</span></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a><span class="st">   (...)</span></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a><span class="st">    879             ...</span></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a><span class="st">    880     """</span></span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a><span class="op">--&gt;</span> <span class="dv">881</span>     check_if_dynamo_supported()</span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a>    <span class="dv">882</span>     <span class="co"># Note: The hooks object could be global instead of passed around, *however* that would make</span></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a>    <span class="dv">883</span>     <span class="co"># for a confusing API usage and plumbing story wherein we nest multiple .optimize calls.</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>    <span class="dv">884</span>     <span class="co"># There is some prior art around this, w/r/t nesting backend calls are enforced to be the same</span></span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>    <span class="dv">885</span>     <span class="co"># compiler, however, this feels onerous for callback and hooks, and it feels better to give our users an</span></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>    <span class="dv">886</span>     <span class="co"># easier to understand UX at the cost of a little more plumbing on our end.</span></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>    <span class="dv">887</span>     hooks <span class="op">=</span> Hooks(guard_export_fn<span class="op">=</span>guard_export_fn, guard_fail_fn<span class="op">=</span>guard_fail_fn)</span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>File <span class="op">~/</span>mambaforge<span class="op">/</span>envs<span class="op">/</span>py313t<span class="op">/</span>lib<span class="op">/</span>python3<span class="fl">.13</span><span class="er">t</span><span class="op">/</span>site<span class="op">-</span>packages<span class="op">/</span>torch<span class="op">/</span>_dynamo<span class="op">/</span>eval_frame.py:<span class="dv">805</span>, <span class="kw">in</span> check_if_dynamo_supported()</span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a>    <span class="dv">803</span>     <span class="cf">raise</span> <span class="pp">RuntimeError</span>(<span class="st">"Python 3.14+ not yet supported for torch.compile"</span>)</span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a>    <span class="dv">804</span> <span class="cf">elif</span> sysconfig.get_config_var(<span class="st">"Py_GIL_DISABLED"</span>) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a><span class="op">--&gt;</span> <span class="dv">805</span>     <span class="cf">raise</span> <span class="pp">RuntimeError</span>(</span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a>    <span class="dv">806</span>         <span class="st">"torch.compile is not supported on Python built with GIL disabled"</span></span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>    <span class="dv">807</span>     )</span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a><span class="pp">RuntimeError</span>: torch.<span class="bu">compile</span> <span class="kw">is</span> <span class="kw">not</span> supported on Python built <span class="cf">with</span> GIL disabled</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let’s hack <code>torch/_dynamo/eval_frame.py</code> too:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode diff code-with-copy"><code class="sourceCode diff"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">--- eval_frame.py.orig  2025-02-09 13:32:18.266470283 -0800</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="dt">+++ eval_frame.py       2025-02-09 13:32:32.746291774 -0800</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="dt">@@ -802,9 +802,7 @@</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>     if sys.version_info &gt;= (3, 14):</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>         raise RuntimeError("Python 3.14+ not yet supported for torch.compile")</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>     elif sysconfig.get_config_var("Py_GIL_DISABLED") == 1:</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="st">-        raise RuntimeError(</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="st">-            "torch.compile is not supported on Python built with GIL disabled"</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="st">-        )</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="va">+        print("torch._dynamo.eval_frame: Ignoring unsupported torch.compile() with no GIL unsupported")</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a> def is_dynamo_supported():</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now let’s try again:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> model <span class="op">=</span> torch.<span class="bu">compile</span>(model)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>torch.<span class="fu">__init__</span>: Ignoring unsupported torch.<span class="bu">compile</span>() <span class="cf">with</span> no GIL unsupported</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>torch._dynamo.eval_frame: Ignoring unsupported torch.<span class="bu">compile</span>() <span class="cf">with</span> no GIL unsupported</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>So, we can forcibly coerce PyTorch Dynamo to compile our model even if we’re in free-threaded mode.</p>
<p>But does it work? And is it faster? Let’s investigate.</p>
<p>We can invoke our <a href="https://github.com/tpn/parallelopedia/blob/main/src/parallelopedia/gpt2.py"><code>parallelopedia.gpt2</code></a> module directly with various command line arguments to test out generation performance. The accompanying <code>--help</code> is furnished below for reference:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> python <span class="at">-m</span> parallelopedia.gpt2 <span class="at">--help</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="ex">usage:</span> gpt2.py <span class="pp">[-</span><span class="ss">h</span><span class="pp">]</span> [--log-level <span class="dt">{DEBUG</span><span class="op">,</span><span class="dt">INFO</span><span class="op">,</span><span class="dt">WARNING</span><span class="op">,</span><span class="dt">ERROR</span><span class="op">,</span><span class="dt">CRITICAL}</span>] [--model <span class="dt">{gpt2</span><span class="op">,</span><span class="dt">gpt2-xl}</span>] [--device DEVICE]</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>               <span class="ex">[--max-length</span> MAX_LENGTH] [--top-k TOP_K] [--seed SEED] [--prompt PROMPT] <span class="pp">[--</span><span class="ss">torch</span><span class="pp">-</span><span class="ss">compile</span><span class="pp">]</span> <span class="pp">[--</span><span class="ss">torch</span><span class="pp">-</span><span class="ss">jit</span><span class="pp">]</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>               <span class="ex">[--torch-compile-fullgraph]</span> <span class="pp">[--</span><span class="ss">torch</span><span class="pp">-</span><span class="ss">compile</span><span class="pp">-</span><span class="ss">reduce</span><span class="pp">-</span><span class="ss">overhead</span><span class="pp">]</span> <span class="pp">[--</span><span class="ss">torch</span><span class="pp">-</span><span class="ss">compile</span><span class="pp">-</span><span class="ss">max</span><span class="pp">-</span><span class="ss">autotune</span><span class="pp">]</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>               <span class="ex">[--generate-slim]</span> [--rounds ROUNDS] [--wrap WRAP] [--note NOTE]</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="ex">Run</span> the GPT2 module.</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="ex">options:</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="ex">-h,</span> <span class="at">--help</span>            show this help message and exit</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--log-level</span> <span class="dt">{DEBUG</span><span class="op">,</span><span class="dt">INFO</span><span class="op">,</span><span class="dt">WARNING</span><span class="op">,</span><span class="dt">ERROR</span><span class="op">,</span><span class="dt">CRITICAL}</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>                        <span class="ex">Set</span> the logging level.</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--model</span> <span class="dt">{gpt2</span><span class="op">,</span><span class="dt">gpt2-xl}</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>                        <span class="ex">Select</span> the model to use.</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--device</span> DEVICE       Select the device to use.</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--max-length</span> MAX_LENGTH</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>                        <span class="ex">Set</span> the maximum length of the generated text.</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--top-k</span> TOP_K         Set the top-k value for sampling.</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--seed</span> SEED           Set the random seed for generation.</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--prompt</span> PROMPT       Set the prompt for generation.</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--torch-compile</span>       Compile the models using torch.compile<span class="er">(</span><span class="kw">)</span><span class="bu">.</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--torch-jit</span>           Compile the models using torch.jit.script<span class="er">(</span><span class="kw">)</span><span class="bu">.</span></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--torch-compile-fullgraph</span></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>                        <span class="ex">Compile</span> the models using torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> fullgraph=True.</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--torch-compile-reduce-overhead</span></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>                        <span class="ex">Compile</span> the models using torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> mode=<span class="st">"reduce-overhead"</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--torch-compile-max-autotune</span></span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>                        <span class="ex">Compile</span> the models using torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> mode=<span class="st">"max_autotune"</span>.</span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--generate-slim</span>       Use the generate_slim<span class="er">(</span><span class="kw">)</span> <span class="ex">method</span> for generation.</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--rounds</span> ROUNDS       Set the number of rounds for generation.</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--wrap</span> WRAP           Set the wrap width for text output.</span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a>  <span class="ex">--note</span> NOTE           Set a note to include in the JSON output.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The full source code for the module’s <code>main()</code> function follows. Based on the command line parameters furnished, we can test various generation variants, such as no <code>torch.compile()</code>, <code>torch.compile()</code> and nothing else, and more advanced permutations such as the following:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>kwds <span class="op">=</span> {</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'fullgraph'</span>: <span class="va">True</span>,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'model'</span>: <span class="st">'max-autotune'</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> torch.<span class="bu">compile</span>(model, <span class="op">**</span>kwds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Full Source Code for parallelopedia.gpt2.main()">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Full Source Code for parallelopedia.gpt2.main()
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Main entry point for the parallelopedia.gpt2 module.</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parse_arguments()</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>    logging.basicConfig(</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>        level<span class="op">=</span><span class="bu">getattr</span>(logging, args.log_level),</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span>,</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    start_time <span class="op">=</span> time.time()</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>    start_timestamp <span class="op">=</span> datetime.datetime.now().isoformat()</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>    timer <span class="op">=</span> ElapsedTimer()</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> timer:</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> args.model <span class="op">==</span> <span class="st">'gpt2-xl'</span>:</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> GPT.from_pretrained(</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>                model_name<span class="op">=</span><span class="st">'openai-community/gpt2-xl'</span>,</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>                map_location<span class="op">=</span>args.device,</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> GPT.from_local_pretrained(</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>                model_path<span class="op">=</span>MODEL_CHECKPOINT,</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>                map_location<span class="op">=</span>args.device,</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>                manual_seed<span class="op">=</span>args.seed,</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>    logging.info(</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f'Loaded </span><span class="sc">{</span>args<span class="sc">.</span>model<span class="sc">}</span><span class="ss"> on </span><span class="sc">{</span>args<span class="sc">.</span>device<span class="sc">}</span><span class="ss"> '</span></span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f'in </span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.torch_compile:</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> args.torch_jit:</span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>            msg <span class="op">=</span> <span class="st">'Cannot specify both --torch-compile and --torch-jit.'</span></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(msg)</span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a>        model.config <span class="op">=</span> dataclasses.asdict(model.config)</span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a>        kwds <span class="op">=</span> {}</span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> args.torch_compile_fullgraph:</span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a>            kwds[<span class="st">'fullgraph'</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> args.torch_compile_reduce_overhead:</span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> args.torch_compile_max_autotune:</span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a>                msg <span class="op">=</span> (</span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Cannot specify both --torch-compile-reduce-overhead '</span></span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'and --torch-compile-max-autotune.'</span></span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">raise</span> <span class="pp">ValueError</span>(msg)</span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a>            kwds[<span class="st">'mode'</span>] <span class="op">=</span> <span class="st">'reduce-overhead'</span></span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> args.torch_compile_max_autotune:</span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a>            kwds[<span class="st">'mode'</span>] <span class="op">=</span> <span class="st">'max-autotune'</span></span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> timer:</span>
<span id="cb79-52"><a href="#cb79-52" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> torch.<span class="bu">compile</span>(model, <span class="op">**</span>kwds)</span>
<span id="cb79-53"><a href="#cb79-53" aria-hidden="true" tabindex="-1"></a>        msg <span class="op">=</span> <span class="ss">f'torch.compiled model in </span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span></span>
<span id="cb79-54"><a href="#cb79-54" aria-hidden="true" tabindex="-1"></a>        logging.info(msg)</span>
<span id="cb79-55"><a href="#cb79-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> args.torch_jit:</span>
<span id="cb79-56"><a href="#cb79-56" aria-hidden="true" tabindex="-1"></a>        model.config <span class="op">=</span> dataclasses.asdict(model.config)</span>
<span id="cb79-57"><a href="#cb79-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> timer:</span>
<span id="cb79-58"><a href="#cb79-58" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> torch.jit.script(model)</span>
<span id="cb79-59"><a href="#cb79-59" aria-hidden="true" tabindex="-1"></a>        msg <span class="op">=</span> <span class="ss">f'JIT compiled model in </span><span class="sc">{</span>timer<span class="sc">.</span>elapsed<span class="sc">:.3f}</span><span class="ss"> seconds.'</span>)</span>
<span id="cb79-60"><a href="#cb79-60" aria-hidden="true" tabindex="-1"></a>        logging.info(msg)</span>
<span id="cb79-61"><a href="#cb79-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-62"><a href="#cb79-62" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">=</span> args.seed</span>
<span id="cb79-63"><a href="#cb79-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> seed <span class="kw">is</span> <span class="va">None</span> <span class="kw">or</span> seed <span class="op">==</span> <span class="st">''</span>:</span>
<span id="cb79-64"><a href="#cb79-64" aria-hidden="true" tabindex="-1"></a>        seed <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="dv">2</span><span class="op">**</span><span class="dv">32</span> <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb79-65"><a href="#cb79-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-66"><a href="#cb79-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.generate_slim:</span>
<span id="cb79-67"><a href="#cb79-67" aria-hidden="true" tabindex="-1"></a>        text_tokens <span class="op">=</span> model.enc.encode(args.prompt)</span>
<span id="cb79-68"><a href="#cb79-68" aria-hidden="true" tabindex="-1"></a>        prompt_token_length <span class="op">=</span> <span class="bu">len</span>(text_tokens)</span>
<span id="cb79-69"><a href="#cb79-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-70"><a href="#cb79-70" aria-hidden="true" tabindex="-1"></a>    rates <span class="op">=</span> []</span>
<span id="cb79-71"><a href="#cb79-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(args.rounds):</span>
<span id="cb79-72"><a href="#cb79-72" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f'Round </span><span class="sc">{</span>i <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>args<span class="sc">.</span>rounds<span class="sc">}</span><span class="ss">.'</span>)</span>
<span id="cb79-73"><a href="#cb79-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> args.generate_slim:</span>
<span id="cb79-74"><a href="#cb79-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> timer:</span>
<span id="cb79-75"><a href="#cb79-75" aria-hidden="true" tabindex="-1"></a>                x <span class="op">=</span> model.generate_slim(</span>
<span id="cb79-76"><a href="#cb79-76" aria-hidden="true" tabindex="-1"></a>                    text_tokens,</span>
<span id="cb79-77"><a href="#cb79-77" aria-hidden="true" tabindex="-1"></a>                    max_length<span class="op">=</span>args.max_length,</span>
<span id="cb79-78"><a href="#cb79-78" aria-hidden="true" tabindex="-1"></a>                    top_k<span class="op">=</span>args.top_k,</span>
<span id="cb79-79"><a href="#cb79-79" aria-hidden="true" tabindex="-1"></a>                    seed<span class="op">=</span>seed,</span>
<span id="cb79-80"><a href="#cb79-80" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb79-81"><a href="#cb79-81" aria-hidden="true" tabindex="-1"></a>            elapsed <span class="op">=</span> timer.elapsed</span>
<span id="cb79-82"><a href="#cb79-82" aria-hidden="true" tabindex="-1"></a>            count <span class="op">=</span> x.size(<span class="dv">1</span>) <span class="op">-</span> prompt_token_length</span>
<span id="cb79-83"><a href="#cb79-83" aria-hidden="true" tabindex="-1"></a>            tokens_per_sec <span class="op">=</span> count <span class="op">/</span> elapsed</span>
<span id="cb79-84"><a href="#cb79-84" aria-hidden="true" tabindex="-1"></a>            rates.append(tokens_per_sec)</span>
<span id="cb79-85"><a href="#cb79-85" aria-hidden="true" tabindex="-1"></a>            logging.info(</span>
<span id="cb79-86"><a href="#cb79-86" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'Generated </span><span class="sc">{</span>count<span class="sc">}</span><span class="ss"> tokens in </span><span class="sc">{</span>elapsed<span class="sc">:.2f}</span><span class="ss"> seconds '</span></span>
<span id="cb79-87"><a href="#cb79-87" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'(</span><span class="sc">{</span>tokens_per_sec<span class="sc">:.2f}</span><span class="ss"> tokens/sec)'</span></span>
<span id="cb79-88"><a href="#cb79-88" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb79-89"><a href="#cb79-89" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> model.enc.decode(x[<span class="dv">0</span>].tolist())</span>
<span id="cb79-90"><a href="#cb79-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb79-91"><a href="#cb79-91" aria-hidden="true" tabindex="-1"></a>            save_rate <span class="op">=</span> <span class="kw">lambda</span> x: rates.append(x)</span>
<span id="cb79-92"><a href="#cb79-92" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> model.generate(</span>
<span id="cb79-93"><a href="#cb79-93" aria-hidden="true" tabindex="-1"></a>                args.prompt,</span>
<span id="cb79-94"><a href="#cb79-94" aria-hidden="true" tabindex="-1"></a>                max_length<span class="op">=</span>args.max_length,</span>
<span id="cb79-95"><a href="#cb79-95" aria-hidden="true" tabindex="-1"></a>                top_k<span class="op">=</span>args.top_k,</span>
<span id="cb79-96"><a href="#cb79-96" aria-hidden="true" tabindex="-1"></a>                seed<span class="op">=</span>seed,</span>
<span id="cb79-97"><a href="#cb79-97" aria-hidden="true" tabindex="-1"></a>                save_rate<span class="op">=</span>save_rate,</span>
<span id="cb79-98"><a href="#cb79-98" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb79-99"><a href="#cb79-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-100"><a href="#cb79-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> args.wrap:</span>
<span id="cb79-101"><a href="#cb79-101" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> textwrap.fill(output, width<span class="op">=</span>args.wrap)</span>
<span id="cb79-102"><a href="#cb79-102" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f'Output:</span><span class="ch">\n</span><span class="sc">{</span>output<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb79-103"><a href="#cb79-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-104"><a href="#cb79-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The filename is of the form:</span></span>
<span id="cb79-105"><a href="#cb79-105" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   `gpt2-rates-&lt;yyyy-mm-dd-hh-ss-mm.sss&gt;-[optional].json`</span></span>
<span id="cb79-106"><a href="#cb79-106" aria-hidden="true" tabindex="-1"></a>    now <span class="op">=</span> datetime.datetime.now()</span>
<span id="cb79-107"><a href="#cb79-107" aria-hidden="true" tabindex="-1"></a>    timestamp <span class="op">=</span> now.strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">-%H-%M-%S-</span><span class="sc">%f</span><span class="st">'</span>)</span>
<span id="cb79-108"><a href="#cb79-108" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">=</span> <span class="ss">f"gpt2-rates-</span><span class="sc">{</span>timestamp<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb79-109"><a href="#cb79-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.torch_compile:</span>
<span id="cb79-110"><a href="#cb79-110" aria-hidden="true" tabindex="-1"></a>        filename <span class="op">+=</span> <span class="st">'-torch-compile'</span></span>
<span id="cb79-111"><a href="#cb79-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> args.torch_compile_reduce_overhead:</span>
<span id="cb79-112"><a href="#cb79-112" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">+=</span> <span class="st">'-reduce-overhead'</span></span>
<span id="cb79-113"><a href="#cb79-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> args.torch_compile_max_autotune:</span>
<span id="cb79-114"><a href="#cb79-114" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">+=</span> <span class="st">'-max-autotune'</span></span>
<span id="cb79-115"><a href="#cb79-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> args.torch_compile_fullgraph:</span>
<span id="cb79-116"><a href="#cb79-116" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">+=</span> <span class="st">'-fullgraph'</span></span>
<span id="cb79-117"><a href="#cb79-117" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.generate_slim:</span>
<span id="cb79-118"><a href="#cb79-118" aria-hidden="true" tabindex="-1"></a>        filename <span class="op">+=</span> <span class="st">'-generate-slim'</span></span>
<span id="cb79-119"><a href="#cb79-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-120"><a href="#cb79-120" aria-hidden="true" tabindex="-1"></a>    conda_env_name <span class="op">=</span> os.environ.get(<span class="st">'CONDA_DEFAULT_ENV'</span>, <span class="st">'Unknown'</span>)</span>
<span id="cb79-121"><a href="#cb79-121" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">+=</span> <span class="ss">f'-</span><span class="sc">{</span>conda_env_name<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb79-122"><a href="#cb79-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-123"><a href="#cb79-123" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">+=</span> <span class="st">'.json'</span></span>
<span id="cb79-124"><a href="#cb79-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-125"><a href="#cb79-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(model.config, <span class="bu">dict</span>):</span>
<span id="cb79-126"><a href="#cb79-126" aria-hidden="true" tabindex="-1"></a>        model_config <span class="op">=</span> dataclasses.asdict(model.config)</span>
<span id="cb79-127"><a href="#cb79-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb79-128"><a href="#cb79-128" aria-hidden="true" tabindex="-1"></a>        model_config <span class="op">=</span> model.config</span>
<span id="cb79-129"><a href="#cb79-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-130"><a href="#cb79-130" aria-hidden="true" tabindex="-1"></a>    end_time <span class="op">=</span> time.time()</span>
<span id="cb79-131"><a href="#cb79-131" aria-hidden="true" tabindex="-1"></a>    end_timestamp <span class="op">=</span> datetime.datetime.now().isoformat()</span>
<span id="cb79-132"><a href="#cb79-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-133"><a href="#cb79-133" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.device.startswith(<span class="st">'cuda'</span>):</span>
<span id="cb79-134"><a href="#cb79-134" aria-hidden="true" tabindex="-1"></a>        ix <span class="op">=</span> args.device.find(<span class="st">':'</span>)</span>
<span id="cb79-135"><a href="#cb79-135" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> ix <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb79-136"><a href="#cb79-136" aria-hidden="true" tabindex="-1"></a>            device_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb79-137"><a href="#cb79-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb79-138"><a href="#cb79-138" aria-hidden="true" tabindex="-1"></a>            device_index <span class="op">=</span> <span class="bu">int</span>(args.device[ix<span class="op">+</span><span class="dv">1</span>:])</span>
<span id="cb79-139"><a href="#cb79-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-140"><a href="#cb79-140" aria-hidden="true" tabindex="-1"></a>        device_name <span class="op">=</span> torch.cuda.get_device_name(device_index)</span>
<span id="cb79-141"><a href="#cb79-141" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb79-142"><a href="#cb79-142" aria-hidden="true" tabindex="-1"></a>        device_name <span class="op">=</span> <span class="st">'CPU'</span></span>
<span id="cb79-143"><a href="#cb79-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-144"><a href="#cb79-144" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb79-145"><a href="#cb79-145" aria-hidden="true" tabindex="-1"></a>        is_gil_enabled <span class="op">=</span> sys._is_gil_enabled()</span>
<span id="cb79-146"><a href="#cb79-146" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">AttributeError</span>:</span>
<span id="cb79-147"><a href="#cb79-147" aria-hidden="true" tabindex="-1"></a>        is_gil_enabled <span class="op">=</span> <span class="va">False</span></span>
<span id="cb79-148"><a href="#cb79-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-149"><a href="#cb79-149" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prepare a dictionary with the details to save.</span></span>
<span id="cb79-150"><a href="#cb79-150" aria-hidden="true" tabindex="-1"></a>    run_details <span class="op">=</span> {</span>
<span id="cb79-151"><a href="#cb79-151" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rates"</span>: rates,</span>
<span id="cb79-152"><a href="#cb79-152" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model_config"</span>: model_config,</span>
<span id="cb79-153"><a href="#cb79-153" aria-hidden="true" tabindex="-1"></a>        <span class="st">"args"</span>: <span class="bu">vars</span>(args),</span>
<span id="cb79-154"><a href="#cb79-154" aria-hidden="true" tabindex="-1"></a>        <span class="st">"start_timestamp"</span>: start_timestamp,</span>
<span id="cb79-155"><a href="#cb79-155" aria-hidden="true" tabindex="-1"></a>        <span class="st">"end_timestamp"</span>: end_timestamp,</span>
<span id="cb79-156"><a href="#cb79-156" aria-hidden="true" tabindex="-1"></a>        <span class="st">"elapsed"</span>: <span class="ss">f'</span><span class="sc">{</span>end_time <span class="op">-</span> start_time<span class="sc">:.3f}</span><span class="ss">'</span>,</span>
<span id="cb79-157"><a href="#cb79-157" aria-hidden="true" tabindex="-1"></a>        <span class="st">"device_name"</span>: device_name,</span>
<span id="cb79-158"><a href="#cb79-158" aria-hidden="true" tabindex="-1"></a>        <span class="st">"conda_env_name"</span>: conda_env_name,</span>
<span id="cb79-159"><a href="#cb79-159" aria-hidden="true" tabindex="-1"></a>        <span class="st">"is_gil_enabled"</span>: is_gil_enabled,</span>
<span id="cb79-160"><a href="#cb79-160" aria-hidden="true" tabindex="-1"></a>        <span class="st">"note"</span>: args.note,</span>
<span id="cb79-161"><a href="#cb79-161" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb79-162"><a href="#cb79-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-163"><a href="#cb79-163" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Write the JSON file.</span></span>
<span id="cb79-164"><a href="#cb79-164" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">"w"</span>) <span class="im">as</span> json_file:</span>
<span id="cb79-165"><a href="#cb79-165" aria-hidden="true" tabindex="-1"></a>        json.dump(run_details, json_file, indent<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb79-166"><a href="#cb79-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-167"><a href="#cb79-167" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Run details saved to </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Let’s take a look at whether or not <code>torch.compile()</code> improves performance in our <code>py313t</code> free-threaded environment, first.</p>
<section id="performance-comparison" class="level4">
<h4 class="anchored" data-anchor-id="performance-comparison">Performance Comparison</h4>
<p>I wrote a <code>bash</code> script <a href="https://github.com/tpn/website/blob/main/articles/pytorch-and-python-free-threading/run-py313t-gpt2-compile-tests.sh"><code>run-py313t-gpt2-compile-tests.sh</code></a>, reproduced below, that ran various permutations of generation with different <code>torch.compile()</code> options.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure our environment name is `py313t`.</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="st">"</span><span class="va">$CONDA_DEFAULT_ENV</span><span class="st">"</span> <span class="ot">!=</span> <span class="st">"py313t"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">"Error: Conda environment is not 'py313t'."</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="bu">exit</span> 1</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure PARALLELOPEDIA_ROOT is set.</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="st">"</span><span class="va">$PARALLELOPEDIA_ROOT</span><span class="st">"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">"Error: PARALLELOPEDIA_ROOT is not set."</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="bu">exit</span> 1</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="va">SEED</span><span class="op">=</span>42</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a><span class="va">DEVICE</span><span class="op">=</span><span class="st">"cuda:3"</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="va">ROUNDS</span><span class="op">=</span>20</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a><span class="va">OPTIONS</span><span class="op">=</span><span class="va">(</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"--torch-compile"</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"--torch-compile --torch-compile-fullgraph"</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"--torch-compile --torch-compile-reduce-overhead"</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"--torch-compile --torch-compile-reduce-overhead --torch-compile-fullgraph"</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"--torch-compile --torch-compile-reduce-overhead --torch-compile-fullgraph"</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"--torch-compile --torch-compile-max-autotune"</span></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"--torch-compile --torch-compile-max-autotune --torch-compile-fullgraph"</span></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a><span class="va">)</span></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"GPT.generate() variants"</span></span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a><span class="bu">time</span> python <span class="at">-Xgil</span><span class="op">=</span>0 <span class="at">-m</span> parallelopedia.gpt2    <span class="dt">\</span></span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">--seed</span><span class="op">=</span><span class="va">$SEED</span>                              <span class="dt">\</span></span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">--rounds</span><span class="op">=</span><span class="va">$ROUNDS</span>                          <span class="dt">\</span></span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">--device</span><span class="op">=</span><span class="va">$DEVICE</span></span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> opt <span class="kw">in</span> <span class="st">"</span><span class="va">${OPTIONS</span><span class="op">[@]</span><span class="va">}</span><span class="st">"</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split opt into separate arguments.</span></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>    <span class="bu">eval</span> set <span class="at">--</span> <span class="va">$opt</span></span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a>    <span class="bu">time</span> python <span class="at">-Xgil</span><span class="op">=</span>0 <span class="at">-m</span> parallelopedia.gpt2    <span class="dt">\</span></span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">--seed</span><span class="op">=</span><span class="va">$SEED</span>                              <span class="dt">\</span></span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">--rounds</span><span class="op">=</span><span class="va">$ROUNDS</span>                          <span class="dt">\</span></span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">--device</span><span class="op">=</span><span class="va">$DEVICE</span>                          <span class="dt">\</span></span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">"</span><span class="va">$@</span><span class="st">"</span></span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The full log file for the run is captured in the callout below.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="run-py313t-gpt2-compile-tests.log">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
run-py313t-gpt2-compile-tests.log
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb81"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">GPT.generate()</span> <span class="ex">variants</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:17,958 <span class="at">-</span> INFO <span class="at">-</span> Loaded /mnt/raid1/trent/src/parallelopedia/data/model_19072.pt checkpoint in 0.463 seconds.</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:17,965 <span class="at">-</span> INFO <span class="at">-</span> Initialized GPT model in 0.007 seconds.</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:18,191 <span class="at">-</span> INFO <span class="at">-</span> Loaded model weights in 0.226 seconds.</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>frozen <span class="ex">importlib._bootstrap</span><span class="op">&gt;</span>:488: RuntimeWarning: The global interpreter lock <span class="er">(</span><span class="ex">GIL</span><span class="kw">)</span> <span class="ex">has</span> been enabled to load module <span class="st">'triton._C.libtriton'</span>, which has not declared that it can run safely without the GIL. To override this behavior and keep the GIL disabled <span class="er">(</span><span class="ex">at</span> your own risk<span class="kw">)</span><span class="ex">,</span> run with PYTHON_GIL=0 or <span class="at">-Xgil</span><span class="op">=</span>0.</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:18,558 <span class="at">-</span> INFO <span class="at">-</span> Created GPT model in 0.600 seconds.</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:18,642 <span class="at">-</span> INFO <span class="at">-</span> Moved model to cuda:3 in 0.083 seconds.</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:18,642 <span class="at">-</span> INFO <span class="at">-</span> Loaded model from step 19072, val_loss 3.0519702434539795</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:18,642 <span class="at">-</span> INFO <span class="at">-</span> Loaded gpt2 on cuda:3 in 1.148 seconds.</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:18,642 <span class="at">-</span> INFO <span class="at">-</span> Round 1 of 20.</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:19,454 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.81 seconds <span class="er">(</span><span class="ex">112.32</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:19,454 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:19,454 <span class="at">-</span> INFO <span class="at">-</span> Round 2 of 20.</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:20,091 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.89</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:20,092 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:20,092 <span class="at">-</span> INFO <span class="at">-</span> Round 3 of 20.</span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:20,731 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.49</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:20,731 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:20,731 <span class="at">-</span> INFO <span class="at">-</span> Round 4 of 20.</span>
<span id="cb81-44"><a href="#cb81-44" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:21,366 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.47</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-45"><a href="#cb81-45" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:21,366 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-46"><a href="#cb81-46" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-47"><a href="#cb81-47" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-48"><a href="#cb81-48" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-49"><a href="#cb81-49" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-50"><a href="#cb81-50" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-51"><a href="#cb81-51" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-52"><a href="#cb81-52" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-53"><a href="#cb81-53" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-54"><a href="#cb81-54" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:21,366 <span class="at">-</span> INFO <span class="at">-</span> Round 5 of 20.</span>
<span id="cb81-55"><a href="#cb81-55" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:22,000 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.62</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-56"><a href="#cb81-56" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:22,000 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-57"><a href="#cb81-57" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-58"><a href="#cb81-58" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-59"><a href="#cb81-59" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-60"><a href="#cb81-60" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-61"><a href="#cb81-61" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-62"><a href="#cb81-62" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-63"><a href="#cb81-63" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-64"><a href="#cb81-64" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-65"><a href="#cb81-65" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:22,000 <span class="at">-</span> INFO <span class="at">-</span> Round 6 of 20.</span>
<span id="cb81-66"><a href="#cb81-66" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:22,634 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.62</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-67"><a href="#cb81-67" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:22,635 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-68"><a href="#cb81-68" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-69"><a href="#cb81-69" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-70"><a href="#cb81-70" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-71"><a href="#cb81-71" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-72"><a href="#cb81-72" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-73"><a href="#cb81-73" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-74"><a href="#cb81-74" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-75"><a href="#cb81-75" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-76"><a href="#cb81-76" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:22,635 <span class="at">-</span> INFO <span class="at">-</span> Round 7 of 20.</span>
<span id="cb81-77"><a href="#cb81-77" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:23,270 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">143.25</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-78"><a href="#cb81-78" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:23,271 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-79"><a href="#cb81-79" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-80"><a href="#cb81-80" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-81"><a href="#cb81-81" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-82"><a href="#cb81-82" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-83"><a href="#cb81-83" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-84"><a href="#cb81-84" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-85"><a href="#cb81-85" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-86"><a href="#cb81-86" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-87"><a href="#cb81-87" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:23,271 <span class="at">-</span> INFO <span class="at">-</span> Round 8 of 20.</span>
<span id="cb81-88"><a href="#cb81-88" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:23,904 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.67</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-89"><a href="#cb81-89" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:23,905 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-90"><a href="#cb81-90" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-91"><a href="#cb81-91" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-92"><a href="#cb81-92" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-93"><a href="#cb81-93" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-94"><a href="#cb81-94" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-95"><a href="#cb81-95" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-96"><a href="#cb81-96" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-97"><a href="#cb81-97" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-98"><a href="#cb81-98" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:23,905 <span class="at">-</span> INFO <span class="at">-</span> Round 9 of 20.</span>
<span id="cb81-99"><a href="#cb81-99" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:24,539 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.56</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-100"><a href="#cb81-100" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:24,539 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-101"><a href="#cb81-101" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-102"><a href="#cb81-102" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-103"><a href="#cb81-103" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-104"><a href="#cb81-104" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-105"><a href="#cb81-105" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-106"><a href="#cb81-106" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-107"><a href="#cb81-107" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-108"><a href="#cb81-108" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-109"><a href="#cb81-109" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:24,539 <span class="at">-</span> INFO <span class="at">-</span> Round 10 of 20.</span>
<span id="cb81-110"><a href="#cb81-110" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:25,174 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.56</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-111"><a href="#cb81-111" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:25,174 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-112"><a href="#cb81-112" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-113"><a href="#cb81-113" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-114"><a href="#cb81-114" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-115"><a href="#cb81-115" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-116"><a href="#cb81-116" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-117"><a href="#cb81-117" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-118"><a href="#cb81-118" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-119"><a href="#cb81-119" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-120"><a href="#cb81-120" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:25,174 <span class="at">-</span> INFO <span class="at">-</span> Round 11 of 20.</span>
<span id="cb81-121"><a href="#cb81-121" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:25,812 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.78</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-122"><a href="#cb81-122" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:25,812 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-123"><a href="#cb81-123" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-124"><a href="#cb81-124" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-125"><a href="#cb81-125" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-126"><a href="#cb81-126" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-127"><a href="#cb81-127" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-128"><a href="#cb81-128" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-129"><a href="#cb81-129" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-130"><a href="#cb81-130" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-131"><a href="#cb81-131" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:25,812 <span class="at">-</span> INFO <span class="at">-</span> Round 12 of 20.</span>
<span id="cb81-132"><a href="#cb81-132" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:26,444 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.92</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-133"><a href="#cb81-133" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:26,445 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-134"><a href="#cb81-134" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-135"><a href="#cb81-135" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-136"><a href="#cb81-136" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-137"><a href="#cb81-137" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-138"><a href="#cb81-138" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-139"><a href="#cb81-139" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-140"><a href="#cb81-140" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-141"><a href="#cb81-141" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-142"><a href="#cb81-142" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:26,445 <span class="at">-</span> INFO <span class="at">-</span> Round 13 of 20.</span>
<span id="cb81-143"><a href="#cb81-143" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:27,080 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.34</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-144"><a href="#cb81-144" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:27,080 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-145"><a href="#cb81-145" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-146"><a href="#cb81-146" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-147"><a href="#cb81-147" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-148"><a href="#cb81-148" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-149"><a href="#cb81-149" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-150"><a href="#cb81-150" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-151"><a href="#cb81-151" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-152"><a href="#cb81-152" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-153"><a href="#cb81-153" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:27,081 <span class="at">-</span> INFO <span class="at">-</span> Round 14 of 20.</span>
<span id="cb81-154"><a href="#cb81-154" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:27,716 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.34</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-155"><a href="#cb81-155" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:27,716 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-156"><a href="#cb81-156" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-157"><a href="#cb81-157" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-158"><a href="#cb81-158" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-159"><a href="#cb81-159" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-160"><a href="#cb81-160" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-161"><a href="#cb81-161" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-162"><a href="#cb81-162" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-163"><a href="#cb81-163" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-164"><a href="#cb81-164" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:27,716 <span class="at">-</span> INFO <span class="at">-</span> Round 15 of 20.</span>
<span id="cb81-165"><a href="#cb81-165" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:28,350 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.65</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-166"><a href="#cb81-166" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:28,350 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-167"><a href="#cb81-167" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-168"><a href="#cb81-168" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-169"><a href="#cb81-169" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-170"><a href="#cb81-170" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-171"><a href="#cb81-171" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-172"><a href="#cb81-172" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-173"><a href="#cb81-173" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-174"><a href="#cb81-174" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-175"><a href="#cb81-175" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:28,350 <span class="at">-</span> INFO <span class="at">-</span> Round 16 of 20.</span>
<span id="cb81-176"><a href="#cb81-176" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:28,984 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.73</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-177"><a href="#cb81-177" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:28,984 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-178"><a href="#cb81-178" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-179"><a href="#cb81-179" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-180"><a href="#cb81-180" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-181"><a href="#cb81-181" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-182"><a href="#cb81-182" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-183"><a href="#cb81-183" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-184"><a href="#cb81-184" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-185"><a href="#cb81-185" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-186"><a href="#cb81-186" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:28,984 <span class="at">-</span> INFO <span class="at">-</span> Round 17 of 20.</span>
<span id="cb81-187"><a href="#cb81-187" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:29,617 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.79</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-188"><a href="#cb81-188" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:29,618 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-189"><a href="#cb81-189" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-190"><a href="#cb81-190" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-191"><a href="#cb81-191" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-192"><a href="#cb81-192" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-193"><a href="#cb81-193" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-194"><a href="#cb81-194" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-195"><a href="#cb81-195" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-196"><a href="#cb81-196" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-197"><a href="#cb81-197" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:29,618 <span class="at">-</span> INFO <span class="at">-</span> Round 18 of 20.</span>
<span id="cb81-198"><a href="#cb81-198" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:30,260 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.71</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-199"><a href="#cb81-199" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:30,261 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-200"><a href="#cb81-200" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-201"><a href="#cb81-201" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-202"><a href="#cb81-202" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-203"><a href="#cb81-203" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-204"><a href="#cb81-204" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-205"><a href="#cb81-205" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-206"><a href="#cb81-206" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-207"><a href="#cb81-207" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-208"><a href="#cb81-208" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:30,261 <span class="at">-</span> INFO <span class="at">-</span> Round 19 of 20.</span>
<span id="cb81-209"><a href="#cb81-209" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:30,896 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.36</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-210"><a href="#cb81-210" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:30,896 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-211"><a href="#cb81-211" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-212"><a href="#cb81-212" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-213"><a href="#cb81-213" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-214"><a href="#cb81-214" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-215"><a href="#cb81-215" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-216"><a href="#cb81-216" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-217"><a href="#cb81-217" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-218"><a href="#cb81-218" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-219"><a href="#cb81-219" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:30,896 <span class="at">-</span> INFO <span class="at">-</span> Round 20 of 20.</span>
<span id="cb81-220"><a href="#cb81-220" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:31,530 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">143.55</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-221"><a href="#cb81-221" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:31,531 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-222"><a href="#cb81-222" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-223"><a href="#cb81-223" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-224"><a href="#cb81-224" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-225"><a href="#cb81-225" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-226"><a href="#cb81-226" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-227"><a href="#cb81-227" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-228"><a href="#cb81-228" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-229"><a href="#cb81-229" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-230"><a href="#cb81-230" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:31,531 <span class="at">-</span> INFO <span class="at">-</span> Run details saved to gpt2-rates-2025-02-10-20-47-31-531204-py313t.json.</span>
<span id="cb81-231"><a href="#cb81-231" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-232"><a href="#cb81-232" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-233"><a href="#cb81-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-234"><a href="#cb81-234" aria-hidden="true" tabindex="-1"></a><span class="ex">real</span>    0m19.736s</span>
<span id="cb81-235"><a href="#cb81-235" aria-hidden="true" tabindex="-1"></a><span class="ex">user</span>    0m22.944s</span>
<span id="cb81-236"><a href="#cb81-236" aria-hidden="true" tabindex="-1"></a><span class="ex">sys</span> 0m1.382s</span>
<span id="cb81-237"><a href="#cb81-237" aria-hidden="true" tabindex="-1"></a><span class="ex">Exception</span> ignored in: <span class="op">&lt;</span>_io.BufferedWriter name=41<span class="op">&gt;</span></span>
<span id="cb81-238"><a href="#cb81-238" aria-hidden="true" tabindex="-1"></a><span class="ex">BrokenPipeError:</span> [Errno 32] Broken pipe</span>
<span id="cb81-239"><a href="#cb81-239" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:37,663 <span class="at">-</span> INFO <span class="at">-</span> Loaded /mnt/raid1/trent/src/parallelopedia/data/model_19072.pt checkpoint in 0.484 seconds.</span>
<span id="cb81-240"><a href="#cb81-240" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:37,670 <span class="at">-</span> INFO <span class="at">-</span> Initialized GPT model in 0.006 seconds.</span>
<span id="cb81-241"><a href="#cb81-241" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:37,896 <span class="at">-</span> INFO <span class="at">-</span> Loaded model weights in 0.226 seconds.</span>
<span id="cb81-242"><a href="#cb81-242" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>frozen <span class="ex">importlib._bootstrap</span><span class="op">&gt;</span>:488: RuntimeWarning: The global interpreter lock <span class="er">(</span><span class="ex">GIL</span><span class="kw">)</span> <span class="ex">has</span> been enabled to load module <span class="st">'triton._C.libtriton'</span>, which has not declared that it can run safely without the GIL. To override this behavior and keep the GIL disabled <span class="er">(</span><span class="ex">at</span> your own risk<span class="kw">)</span><span class="ex">,</span> run with PYTHON_GIL=0 or <span class="at">-Xgil</span><span class="op">=</span>0.</span>
<span id="cb81-243"><a href="#cb81-243" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:38,263 <span class="at">-</span> INFO <span class="at">-</span> Created GPT model in 0.600 seconds.</span>
<span id="cb81-244"><a href="#cb81-244" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:38,347 <span class="at">-</span> INFO <span class="at">-</span> Moved model to cuda:3 in 0.083 seconds.</span>
<span id="cb81-245"><a href="#cb81-245" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:38,347 <span class="at">-</span> INFO <span class="at">-</span> Loaded model from step 19072, val_loss 3.0519702434539795</span>
<span id="cb81-246"><a href="#cb81-246" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:38,347 <span class="at">-</span> INFO <span class="at">-</span> Loaded gpt2 on cuda:3 in 1.168 seconds.</span>
<span id="cb81-247"><a href="#cb81-247" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:38,349 <span class="at">-</span> INFO <span class="at">-</span> torch.compiled model in 0.002 seconds.</span>
<span id="cb81-248"><a href="#cb81-248" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:38,349 <span class="at">-</span> INFO <span class="at">-</span> Round 1 of 20.</span>
<span id="cb81-249"><a href="#cb81-249" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:39,174 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.82 seconds <span class="er">(</span><span class="ex">110.47</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-250"><a href="#cb81-250" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:39,174 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-251"><a href="#cb81-251" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-252"><a href="#cb81-252" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-253"><a href="#cb81-253" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-254"><a href="#cb81-254" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-255"><a href="#cb81-255" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-256"><a href="#cb81-256" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-257"><a href="#cb81-257" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-258"><a href="#cb81-258" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-259"><a href="#cb81-259" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:39,174 <span class="at">-</span> INFO <span class="at">-</span> Round 2 of 20.</span>
<span id="cb81-260"><a href="#cb81-260" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:39,828 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.24</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-261"><a href="#cb81-261" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:39,829 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-262"><a href="#cb81-262" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-263"><a href="#cb81-263" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-264"><a href="#cb81-264" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-265"><a href="#cb81-265" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-266"><a href="#cb81-266" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-267"><a href="#cb81-267" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-268"><a href="#cb81-268" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-269"><a href="#cb81-269" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-270"><a href="#cb81-270" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:39,829 <span class="at">-</span> INFO <span class="at">-</span> Round 3 of 20.</span>
<span id="cb81-271"><a href="#cb81-271" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:40,483 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.04</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-272"><a href="#cb81-272" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:40,484 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-273"><a href="#cb81-273" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-274"><a href="#cb81-274" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-275"><a href="#cb81-275" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-276"><a href="#cb81-276" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-277"><a href="#cb81-277" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-278"><a href="#cb81-278" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-279"><a href="#cb81-279" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-280"><a href="#cb81-280" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-281"><a href="#cb81-281" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:40,484 <span class="at">-</span> INFO <span class="at">-</span> Round 4 of 20.</span>
<span id="cb81-282"><a href="#cb81-282" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:41,138 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.23</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-283"><a href="#cb81-283" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:41,138 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-284"><a href="#cb81-284" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-285"><a href="#cb81-285" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-286"><a href="#cb81-286" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-287"><a href="#cb81-287" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-288"><a href="#cb81-288" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-289"><a href="#cb81-289" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-290"><a href="#cb81-290" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-291"><a href="#cb81-291" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-292"><a href="#cb81-292" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:41,138 <span class="at">-</span> INFO <span class="at">-</span> Round 5 of 20.</span>
<span id="cb81-293"><a href="#cb81-293" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:41,791 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.47</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-294"><a href="#cb81-294" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:41,791 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-295"><a href="#cb81-295" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-296"><a href="#cb81-296" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-297"><a href="#cb81-297" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-298"><a href="#cb81-298" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-299"><a href="#cb81-299" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-300"><a href="#cb81-300" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-301"><a href="#cb81-301" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-302"><a href="#cb81-302" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-303"><a href="#cb81-303" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:41,791 <span class="at">-</span> INFO <span class="at">-</span> Round 6 of 20.</span>
<span id="cb81-304"><a href="#cb81-304" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:42,445 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.29</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-305"><a href="#cb81-305" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:42,445 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-306"><a href="#cb81-306" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-307"><a href="#cb81-307" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-308"><a href="#cb81-308" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-309"><a href="#cb81-309" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-310"><a href="#cb81-310" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-311"><a href="#cb81-311" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-312"><a href="#cb81-312" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-313"><a href="#cb81-313" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-314"><a href="#cb81-314" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:42,445 <span class="at">-</span> INFO <span class="at">-</span> Round 7 of 20.</span>
<span id="cb81-315"><a href="#cb81-315" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:43,099 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.09</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-316"><a href="#cb81-316" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:43,100 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-317"><a href="#cb81-317" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-318"><a href="#cb81-318" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-319"><a href="#cb81-319" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-320"><a href="#cb81-320" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-321"><a href="#cb81-321" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-322"><a href="#cb81-322" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-323"><a href="#cb81-323" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-324"><a href="#cb81-324" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-325"><a href="#cb81-325" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:43,100 <span class="at">-</span> INFO <span class="at">-</span> Round 8 of 20.</span>
<span id="cb81-326"><a href="#cb81-326" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:43,755 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">138.85</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-327"><a href="#cb81-327" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:43,756 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-328"><a href="#cb81-328" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-329"><a href="#cb81-329" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-330"><a href="#cb81-330" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-331"><a href="#cb81-331" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-332"><a href="#cb81-332" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-333"><a href="#cb81-333" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-334"><a href="#cb81-334" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-335"><a href="#cb81-335" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-336"><a href="#cb81-336" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:43,756 <span class="at">-</span> INFO <span class="at">-</span> Round 9 of 20.</span>
<span id="cb81-337"><a href="#cb81-337" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:44,409 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.29</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-338"><a href="#cb81-338" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:44,410 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-339"><a href="#cb81-339" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-340"><a href="#cb81-340" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-341"><a href="#cb81-341" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-342"><a href="#cb81-342" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-343"><a href="#cb81-343" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-344"><a href="#cb81-344" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-345"><a href="#cb81-345" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-346"><a href="#cb81-346" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-347"><a href="#cb81-347" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:44,410 <span class="at">-</span> INFO <span class="at">-</span> Round 10 of 20.</span>
<span id="cb81-348"><a href="#cb81-348" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:45,063 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.29</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-349"><a href="#cb81-349" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:45,064 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-350"><a href="#cb81-350" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-351"><a href="#cb81-351" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-352"><a href="#cb81-352" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-353"><a href="#cb81-353" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-354"><a href="#cb81-354" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-355"><a href="#cb81-355" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-356"><a href="#cb81-356" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-357"><a href="#cb81-357" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-358"><a href="#cb81-358" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:45,064 <span class="at">-</span> INFO <span class="at">-</span> Round 11 of 20.</span>
<span id="cb81-359"><a href="#cb81-359" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:45,718 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.11</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-360"><a href="#cb81-360" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:45,718 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-361"><a href="#cb81-361" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-362"><a href="#cb81-362" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-363"><a href="#cb81-363" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-364"><a href="#cb81-364" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-365"><a href="#cb81-365" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-366"><a href="#cb81-366" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-367"><a href="#cb81-367" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-368"><a href="#cb81-368" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-369"><a href="#cb81-369" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:45,719 <span class="at">-</span> INFO <span class="at">-</span> Round 12 of 20.</span>
<span id="cb81-370"><a href="#cb81-370" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:46,371 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.47</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-371"><a href="#cb81-371" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:46,372 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-372"><a href="#cb81-372" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-373"><a href="#cb81-373" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-374"><a href="#cb81-374" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-375"><a href="#cb81-375" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-376"><a href="#cb81-376" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-377"><a href="#cb81-377" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-378"><a href="#cb81-378" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-379"><a href="#cb81-379" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-380"><a href="#cb81-380" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:46,372 <span class="at">-</span> INFO <span class="at">-</span> Round 13 of 20.</span>
<span id="cb81-381"><a href="#cb81-381" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:47,046 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.67 seconds <span class="er">(</span><span class="ex">135.03</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-382"><a href="#cb81-382" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:47,046 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-383"><a href="#cb81-383" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-384"><a href="#cb81-384" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-385"><a href="#cb81-385" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-386"><a href="#cb81-386" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-387"><a href="#cb81-387" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-388"><a href="#cb81-388" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-389"><a href="#cb81-389" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-390"><a href="#cb81-390" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-391"><a href="#cb81-391" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:47,046 <span class="at">-</span> INFO <span class="at">-</span> Round 14 of 20.</span>
<span id="cb81-392"><a href="#cb81-392" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:47,692 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.90</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-393"><a href="#cb81-393" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:47,693 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-394"><a href="#cb81-394" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-395"><a href="#cb81-395" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-396"><a href="#cb81-396" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-397"><a href="#cb81-397" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-398"><a href="#cb81-398" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-399"><a href="#cb81-399" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-400"><a href="#cb81-400" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-401"><a href="#cb81-401" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-402"><a href="#cb81-402" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:47,693 <span class="at">-</span> INFO <span class="at">-</span> Round 15 of 20.</span>
<span id="cb81-403"><a href="#cb81-403" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:48,339 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.84</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-404"><a href="#cb81-404" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:48,339 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-405"><a href="#cb81-405" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-406"><a href="#cb81-406" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-407"><a href="#cb81-407" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-408"><a href="#cb81-408" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-409"><a href="#cb81-409" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-410"><a href="#cb81-410" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-411"><a href="#cb81-411" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-412"><a href="#cb81-412" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-413"><a href="#cb81-413" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:48,340 <span class="at">-</span> INFO <span class="at">-</span> Round 16 of 20.</span>
<span id="cb81-414"><a href="#cb81-414" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:48,986 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.90</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-415"><a href="#cb81-415" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:48,986 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-416"><a href="#cb81-416" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-417"><a href="#cb81-417" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-418"><a href="#cb81-418" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-419"><a href="#cb81-419" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-420"><a href="#cb81-420" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-421"><a href="#cb81-421" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-422"><a href="#cb81-422" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-423"><a href="#cb81-423" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-424"><a href="#cb81-424" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:48,986 <span class="at">-</span> INFO <span class="at">-</span> Round 17 of 20.</span>
<span id="cb81-425"><a href="#cb81-425" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:49,634 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.40</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-426"><a href="#cb81-426" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:49,635 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-427"><a href="#cb81-427" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-428"><a href="#cb81-428" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-429"><a href="#cb81-429" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-430"><a href="#cb81-430" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-431"><a href="#cb81-431" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-432"><a href="#cb81-432" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-433"><a href="#cb81-433" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-434"><a href="#cb81-434" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-435"><a href="#cb81-435" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:49,635 <span class="at">-</span> INFO <span class="at">-</span> Round 18 of 20.</span>
<span id="cb81-436"><a href="#cb81-436" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:50,282 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.63</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-437"><a href="#cb81-437" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:50,283 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-438"><a href="#cb81-438" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-439"><a href="#cb81-439" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-440"><a href="#cb81-440" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-441"><a href="#cb81-441" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-442"><a href="#cb81-442" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-443"><a href="#cb81-443" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-444"><a href="#cb81-444" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-445"><a href="#cb81-445" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-446"><a href="#cb81-446" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:50,283 <span class="at">-</span> INFO <span class="at">-</span> Round 19 of 20.</span>
<span id="cb81-447"><a href="#cb81-447" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:50,929 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.73</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-448"><a href="#cb81-448" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:50,930 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-449"><a href="#cb81-449" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-450"><a href="#cb81-450" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-451"><a href="#cb81-451" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-452"><a href="#cb81-452" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-453"><a href="#cb81-453" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-454"><a href="#cb81-454" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-455"><a href="#cb81-455" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-456"><a href="#cb81-456" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-457"><a href="#cb81-457" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:50,930 <span class="at">-</span> INFO <span class="at">-</span> Round 20 of 20.</span>
<span id="cb81-458"><a href="#cb81-458" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:51,578 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.41</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-459"><a href="#cb81-459" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:51,579 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-460"><a href="#cb81-460" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-461"><a href="#cb81-461" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-462"><a href="#cb81-462" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-463"><a href="#cb81-463" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-464"><a href="#cb81-464" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-465"><a href="#cb81-465" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-466"><a href="#cb81-466" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-467"><a href="#cb81-467" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-468"><a href="#cb81-468" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:51,579 <span class="at">-</span> INFO <span class="at">-</span> Run details saved to gpt2-rates-2025-02-10-20-47-51-579116-torch-compile-py313t.json.</span>
<span id="cb81-469"><a href="#cb81-469" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-470"><a href="#cb81-470" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-471"><a href="#cb81-471" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-472"><a href="#cb81-472" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-473"><a href="#cb81-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-474"><a href="#cb81-474" aria-hidden="true" tabindex="-1"></a><span class="ex">real</span>    0m20.073s</span>
<span id="cb81-475"><a href="#cb81-475" aria-hidden="true" tabindex="-1"></a><span class="ex">user</span>    0m23.400s</span>
<span id="cb81-476"><a href="#cb81-476" aria-hidden="true" tabindex="-1"></a><span class="ex">sys</span> 0m1.313s</span>
<span id="cb81-477"><a href="#cb81-477" aria-hidden="true" tabindex="-1"></a><span class="ex">Exception</span> ignored in: <span class="op">&lt;</span>_io.BufferedWriter name=41<span class="op">&gt;</span></span>
<span id="cb81-478"><a href="#cb81-478" aria-hidden="true" tabindex="-1"></a><span class="ex">BrokenPipeError:</span> [Errno 32] Broken pipe</span>
<span id="cb81-479"><a href="#cb81-479" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:57,975 <span class="at">-</span> INFO <span class="at">-</span> Loaded /mnt/raid1/trent/src/parallelopedia/data/model_19072.pt checkpoint in 0.486 seconds.</span>
<span id="cb81-480"><a href="#cb81-480" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:57,982 <span class="at">-</span> INFO <span class="at">-</span> Initialized GPT model in 0.006 seconds.</span>
<span id="cb81-481"><a href="#cb81-481" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:58,209 <span class="at">-</span> INFO <span class="at">-</span> Loaded model weights in 0.227 seconds.</span>
<span id="cb81-482"><a href="#cb81-482" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>frozen <span class="ex">importlib._bootstrap</span><span class="op">&gt;</span>:488: RuntimeWarning: The global interpreter lock <span class="er">(</span><span class="ex">GIL</span><span class="kw">)</span> <span class="ex">has</span> been enabled to load module <span class="st">'triton._C.libtriton'</span>, which has not declared that it can run safely without the GIL. To override this behavior and keep the GIL disabled <span class="er">(</span><span class="ex">at</span> your own risk<span class="kw">)</span><span class="ex">,</span> run with PYTHON_GIL=0 or <span class="at">-Xgil</span><span class="op">=</span>0.</span>
<span id="cb81-483"><a href="#cb81-483" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:58,575 <span class="at">-</span> INFO <span class="at">-</span> Created GPT model in 0.599 seconds.</span>
<span id="cb81-484"><a href="#cb81-484" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:58,659 <span class="at">-</span> INFO <span class="at">-</span> Moved model to cuda:3 in 0.084 seconds.</span>
<span id="cb81-485"><a href="#cb81-485" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:58,659 <span class="at">-</span> INFO <span class="at">-</span> Loaded model from step 19072, val_loss 3.0519702434539795</span>
<span id="cb81-486"><a href="#cb81-486" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:58,659 <span class="at">-</span> INFO <span class="at">-</span> Loaded gpt2 on cuda:3 in 1.170 seconds.</span>
<span id="cb81-487"><a href="#cb81-487" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:58,660 <span class="at">-</span> INFO <span class="at">-</span> torch.compiled model in 0.001 seconds.</span>
<span id="cb81-488"><a href="#cb81-488" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:58,661 <span class="at">-</span> INFO <span class="at">-</span> Round 1 of 20.</span>
<span id="cb81-489"><a href="#cb81-489" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:59,483 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.82 seconds <span class="er">(</span><span class="ex">110.79</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-490"><a href="#cb81-490" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:59,483 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-491"><a href="#cb81-491" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-492"><a href="#cb81-492" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-493"><a href="#cb81-493" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-494"><a href="#cb81-494" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-495"><a href="#cb81-495" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-496"><a href="#cb81-496" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-497"><a href="#cb81-497" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-498"><a href="#cb81-498" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-499"><a href="#cb81-499" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:47:59,483 <span class="at">-</span> INFO <span class="at">-</span> Round 2 of 20.</span>
<span id="cb81-500"><a href="#cb81-500" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:00,153 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.67 seconds <span class="er">(</span><span class="ex">135.92</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-501"><a href="#cb81-501" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:00,153 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-502"><a href="#cb81-502" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-503"><a href="#cb81-503" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-504"><a href="#cb81-504" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-505"><a href="#cb81-505" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-506"><a href="#cb81-506" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-507"><a href="#cb81-507" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-508"><a href="#cb81-508" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-509"><a href="#cb81-509" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-510"><a href="#cb81-510" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:00,153 <span class="at">-</span> INFO <span class="at">-</span> Round 3 of 20.</span>
<span id="cb81-511"><a href="#cb81-511" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:00,796 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.66</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-512"><a href="#cb81-512" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:00,796 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-513"><a href="#cb81-513" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-514"><a href="#cb81-514" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-515"><a href="#cb81-515" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-516"><a href="#cb81-516" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-517"><a href="#cb81-517" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-518"><a href="#cb81-518" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-519"><a href="#cb81-519" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-520"><a href="#cb81-520" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-521"><a href="#cb81-521" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:00,796 <span class="at">-</span> INFO <span class="at">-</span> Round 4 of 20.</span>
<span id="cb81-522"><a href="#cb81-522" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:01,439 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.69</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-523"><a href="#cb81-523" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:01,439 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-524"><a href="#cb81-524" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-525"><a href="#cb81-525" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-526"><a href="#cb81-526" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-527"><a href="#cb81-527" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-528"><a href="#cb81-528" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-529"><a href="#cb81-529" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-530"><a href="#cb81-530" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-531"><a href="#cb81-531" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-532"><a href="#cb81-532" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:01,439 <span class="at">-</span> INFO <span class="at">-</span> Round 5 of 20.</span>
<span id="cb81-533"><a href="#cb81-533" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:02,086 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.83</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-534"><a href="#cb81-534" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:02,086 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-535"><a href="#cb81-535" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-536"><a href="#cb81-536" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-537"><a href="#cb81-537" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-538"><a href="#cb81-538" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-539"><a href="#cb81-539" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-540"><a href="#cb81-540" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-541"><a href="#cb81-541" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-542"><a href="#cb81-542" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-543"><a href="#cb81-543" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:02,086 <span class="at">-</span> INFO <span class="at">-</span> Round 6 of 20.</span>
<span id="cb81-544"><a href="#cb81-544" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:02,730 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.33</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-545"><a href="#cb81-545" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:02,731 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-546"><a href="#cb81-546" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-547"><a href="#cb81-547" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-548"><a href="#cb81-548" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-549"><a href="#cb81-549" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-550"><a href="#cb81-550" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-551"><a href="#cb81-551" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-552"><a href="#cb81-552" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-553"><a href="#cb81-553" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-554"><a href="#cb81-554" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:02,731 <span class="at">-</span> INFO <span class="at">-</span> Round 7 of 20.</span>
<span id="cb81-555"><a href="#cb81-555" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:03,374 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.45</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-556"><a href="#cb81-556" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:03,375 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-557"><a href="#cb81-557" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-558"><a href="#cb81-558" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-559"><a href="#cb81-559" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-560"><a href="#cb81-560" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-561"><a href="#cb81-561" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-562"><a href="#cb81-562" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-563"><a href="#cb81-563" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-564"><a href="#cb81-564" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-565"><a href="#cb81-565" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:03,375 <span class="at">-</span> INFO <span class="at">-</span> Round 8 of 20.</span>
<span id="cb81-566"><a href="#cb81-566" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:04,017 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.76</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-567"><a href="#cb81-567" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:04,017 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-568"><a href="#cb81-568" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-569"><a href="#cb81-569" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-570"><a href="#cb81-570" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-571"><a href="#cb81-571" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-572"><a href="#cb81-572" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-573"><a href="#cb81-573" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-574"><a href="#cb81-574" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-575"><a href="#cb81-575" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-576"><a href="#cb81-576" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:04,017 <span class="at">-</span> INFO <span class="at">-</span> Round 9 of 20.</span>
<span id="cb81-577"><a href="#cb81-577" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:04,661 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.46</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-578"><a href="#cb81-578" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:04,661 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-579"><a href="#cb81-579" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-580"><a href="#cb81-580" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-581"><a href="#cb81-581" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-582"><a href="#cb81-582" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-583"><a href="#cb81-583" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-584"><a href="#cb81-584" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-585"><a href="#cb81-585" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-586"><a href="#cb81-586" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-587"><a href="#cb81-587" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:04,661 <span class="at">-</span> INFO <span class="at">-</span> Round 10 of 20.</span>
<span id="cb81-588"><a href="#cb81-588" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:05,303 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.82</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-589"><a href="#cb81-589" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:05,303 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-590"><a href="#cb81-590" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-591"><a href="#cb81-591" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-592"><a href="#cb81-592" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-593"><a href="#cb81-593" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-594"><a href="#cb81-594" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-595"><a href="#cb81-595" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-596"><a href="#cb81-596" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-597"><a href="#cb81-597" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-598"><a href="#cb81-598" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:05,303 <span class="at">-</span> INFO <span class="at">-</span> Round 11 of 20.</span>
<span id="cb81-599"><a href="#cb81-599" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:05,945 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.91</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-600"><a href="#cb81-600" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:05,945 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-601"><a href="#cb81-601" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-602"><a href="#cb81-602" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-603"><a href="#cb81-603" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-604"><a href="#cb81-604" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-605"><a href="#cb81-605" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-606"><a href="#cb81-606" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-607"><a href="#cb81-607" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-608"><a href="#cb81-608" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-609"><a href="#cb81-609" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:05,945 <span class="at">-</span> INFO <span class="at">-</span> Round 12 of 20.</span>
<span id="cb81-610"><a href="#cb81-610" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:06,587 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.83</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-611"><a href="#cb81-611" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:06,587 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-612"><a href="#cb81-612" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-613"><a href="#cb81-613" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-614"><a href="#cb81-614" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-615"><a href="#cb81-615" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-616"><a href="#cb81-616" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-617"><a href="#cb81-617" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-618"><a href="#cb81-618" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-619"><a href="#cb81-619" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-620"><a href="#cb81-620" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:06,587 <span class="at">-</span> INFO <span class="at">-</span> Round 13 of 20.</span>
<span id="cb81-621"><a href="#cb81-621" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:07,229 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.93</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-622"><a href="#cb81-622" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:07,229 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-623"><a href="#cb81-623" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-624"><a href="#cb81-624" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-625"><a href="#cb81-625" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-626"><a href="#cb81-626" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-627"><a href="#cb81-627" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-628"><a href="#cb81-628" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-629"><a href="#cb81-629" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-630"><a href="#cb81-630" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-631"><a href="#cb81-631" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:07,229 <span class="at">-</span> INFO <span class="at">-</span> Round 14 of 20.</span>
<span id="cb81-632"><a href="#cb81-632" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:07,871 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.88</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-633"><a href="#cb81-633" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:07,871 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-634"><a href="#cb81-634" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-635"><a href="#cb81-635" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-636"><a href="#cb81-636" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-637"><a href="#cb81-637" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-638"><a href="#cb81-638" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-639"><a href="#cb81-639" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-640"><a href="#cb81-640" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-641"><a href="#cb81-641" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-642"><a href="#cb81-642" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:07,871 <span class="at">-</span> INFO <span class="at">-</span> Round 15 of 20.</span>
<span id="cb81-643"><a href="#cb81-643" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:08,513 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.74</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-644"><a href="#cb81-644" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:08,514 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-645"><a href="#cb81-645" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-646"><a href="#cb81-646" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-647"><a href="#cb81-647" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-648"><a href="#cb81-648" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-649"><a href="#cb81-649" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-650"><a href="#cb81-650" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-651"><a href="#cb81-651" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-652"><a href="#cb81-652" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-653"><a href="#cb81-653" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:08,514 <span class="at">-</span> INFO <span class="at">-</span> Round 16 of 20.</span>
<span id="cb81-654"><a href="#cb81-654" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:09,157 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.58</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-655"><a href="#cb81-655" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:09,157 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-656"><a href="#cb81-656" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-657"><a href="#cb81-657" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-658"><a href="#cb81-658" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-659"><a href="#cb81-659" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-660"><a href="#cb81-660" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-661"><a href="#cb81-661" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-662"><a href="#cb81-662" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-663"><a href="#cb81-663" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-664"><a href="#cb81-664" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:09,157 <span class="at">-</span> INFO <span class="at">-</span> Round 17 of 20.</span>
<span id="cb81-665"><a href="#cb81-665" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:09,799 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.79</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-666"><a href="#cb81-666" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:09,800 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-667"><a href="#cb81-667" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-668"><a href="#cb81-668" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-669"><a href="#cb81-669" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-670"><a href="#cb81-670" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-671"><a href="#cb81-671" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-672"><a href="#cb81-672" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-673"><a href="#cb81-673" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-674"><a href="#cb81-674" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-675"><a href="#cb81-675" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:09,800 <span class="at">-</span> INFO <span class="at">-</span> Round 18 of 20.</span>
<span id="cb81-676"><a href="#cb81-676" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:10,442 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.75</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-677"><a href="#cb81-677" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:10,442 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-678"><a href="#cb81-678" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-679"><a href="#cb81-679" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-680"><a href="#cb81-680" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-681"><a href="#cb81-681" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-682"><a href="#cb81-682" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-683"><a href="#cb81-683" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-684"><a href="#cb81-684" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-685"><a href="#cb81-685" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-686"><a href="#cb81-686" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:10,442 <span class="at">-</span> INFO <span class="at">-</span> Round 19 of 20.</span>
<span id="cb81-687"><a href="#cb81-687" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:11,084 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.77</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-688"><a href="#cb81-688" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:11,085 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-689"><a href="#cb81-689" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-690"><a href="#cb81-690" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-691"><a href="#cb81-691" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-692"><a href="#cb81-692" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-693"><a href="#cb81-693" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-694"><a href="#cb81-694" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-695"><a href="#cb81-695" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-696"><a href="#cb81-696" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-697"><a href="#cb81-697" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:11,085 <span class="at">-</span> INFO <span class="at">-</span> Round 20 of 20.</span>
<span id="cb81-698"><a href="#cb81-698" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:11,727 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.75</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-699"><a href="#cb81-699" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:11,727 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-700"><a href="#cb81-700" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-701"><a href="#cb81-701" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-702"><a href="#cb81-702" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-703"><a href="#cb81-703" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-704"><a href="#cb81-704" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-705"><a href="#cb81-705" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-706"><a href="#cb81-706" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-707"><a href="#cb81-707" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-708"><a href="#cb81-708" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:11,728 <span class="at">-</span> INFO <span class="at">-</span> Run details saved to gpt2-rates-2025-02-10-20-48-11-727901-torch-compile-fullgraph-py313t.json.</span>
<span id="cb81-709"><a href="#cb81-709" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-710"><a href="#cb81-710" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-711"><a href="#cb81-711" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-712"><a href="#cb81-712" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-713"><a href="#cb81-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-714"><a href="#cb81-714" aria-hidden="true" tabindex="-1"></a><span class="ex">real</span>    0m20.125s</span>
<span id="cb81-715"><a href="#cb81-715" aria-hidden="true" tabindex="-1"></a><span class="ex">user</span>    0m23.218s</span>
<span id="cb81-716"><a href="#cb81-716" aria-hidden="true" tabindex="-1"></a><span class="ex">sys</span> 0m1.382s</span>
<span id="cb81-717"><a href="#cb81-717" aria-hidden="true" tabindex="-1"></a><span class="ex">Exception</span> ignored in: <span class="op">&lt;</span>_io.BufferedWriter name=41<span class="op">&gt;</span></span>
<span id="cb81-718"><a href="#cb81-718" aria-hidden="true" tabindex="-1"></a><span class="ex">BrokenPipeError:</span> [Errno 32] Broken pipe</span>
<span id="cb81-719"><a href="#cb81-719" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:17,900 <span class="at">-</span> INFO <span class="at">-</span> Loaded /mnt/raid1/trent/src/parallelopedia/data/model_19072.pt checkpoint in 0.486 seconds.</span>
<span id="cb81-720"><a href="#cb81-720" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:17,907 <span class="at">-</span> INFO <span class="at">-</span> Initialized GPT model in 0.006 seconds.</span>
<span id="cb81-721"><a href="#cb81-721" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:18,132 <span class="at">-</span> INFO <span class="at">-</span> Loaded model weights in 0.225 seconds.</span>
<span id="cb81-722"><a href="#cb81-722" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>frozen <span class="ex">importlib._bootstrap</span><span class="op">&gt;</span>:488: RuntimeWarning: The global interpreter lock <span class="er">(</span><span class="ex">GIL</span><span class="kw">)</span> <span class="ex">has</span> been enabled to load module <span class="st">'triton._C.libtriton'</span>, which has not declared that it can run safely without the GIL. To override this behavior and keep the GIL disabled <span class="er">(</span><span class="ex">at</span> your own risk<span class="kw">)</span><span class="ex">,</span> run with PYTHON_GIL=0 or <span class="at">-Xgil</span><span class="op">=</span>0.</span>
<span id="cb81-723"><a href="#cb81-723" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:18,494 <span class="at">-</span> INFO <span class="at">-</span> Created GPT model in 0.594 seconds.</span>
<span id="cb81-724"><a href="#cb81-724" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:18,577 <span class="at">-</span> INFO <span class="at">-</span> Moved model to cuda:3 in 0.082 seconds.</span>
<span id="cb81-725"><a href="#cb81-725" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:18,577 <span class="at">-</span> INFO <span class="at">-</span> Loaded model from step 19072, val_loss 3.0519702434539795</span>
<span id="cb81-726"><a href="#cb81-726" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:18,577 <span class="at">-</span> INFO <span class="at">-</span> Loaded gpt2 on cuda:3 in 1.162 seconds.</span>
<span id="cb81-727"><a href="#cb81-727" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:18,581 <span class="at">-</span> INFO <span class="at">-</span> torch.compiled model in 0.004 seconds.</span>
<span id="cb81-728"><a href="#cb81-728" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:18,581 <span class="at">-</span> INFO <span class="at">-</span> Round 1 of 20.</span>
<span id="cb81-729"><a href="#cb81-729" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:19,397 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.82 seconds <span class="er">(</span><span class="ex">111.57</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-730"><a href="#cb81-730" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:19,398 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-731"><a href="#cb81-731" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-732"><a href="#cb81-732" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-733"><a href="#cb81-733" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-734"><a href="#cb81-734" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-735"><a href="#cb81-735" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-736"><a href="#cb81-736" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-737"><a href="#cb81-737" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-738"><a href="#cb81-738" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-739"><a href="#cb81-739" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:19,398 <span class="at">-</span> INFO <span class="at">-</span> Round 2 of 20.</span>
<span id="cb81-740"><a href="#cb81-740" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:20,044 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.99</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-741"><a href="#cb81-741" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:20,044 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-742"><a href="#cb81-742" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-743"><a href="#cb81-743" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-744"><a href="#cb81-744" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-745"><a href="#cb81-745" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-746"><a href="#cb81-746" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-747"><a href="#cb81-747" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-748"><a href="#cb81-748" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-749"><a href="#cb81-749" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-750"><a href="#cb81-750" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:20,044 <span class="at">-</span> INFO <span class="at">-</span> Round 3 of 20.</span>
<span id="cb81-751"><a href="#cb81-751" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:20,690 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.95</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-752"><a href="#cb81-752" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:20,690 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-753"><a href="#cb81-753" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-754"><a href="#cb81-754" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-755"><a href="#cb81-755" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-756"><a href="#cb81-756" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-757"><a href="#cb81-757" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-758"><a href="#cb81-758" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-759"><a href="#cb81-759" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-760"><a href="#cb81-760" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-761"><a href="#cb81-761" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:20,690 <span class="at">-</span> INFO <span class="at">-</span> Round 4 of 20.</span>
<span id="cb81-762"><a href="#cb81-762" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:21,335 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.16</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-763"><a href="#cb81-763" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:21,336 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-764"><a href="#cb81-764" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-765"><a href="#cb81-765" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-766"><a href="#cb81-766" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-767"><a href="#cb81-767" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-768"><a href="#cb81-768" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-769"><a href="#cb81-769" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-770"><a href="#cb81-770" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-771"><a href="#cb81-771" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-772"><a href="#cb81-772" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:21,336 <span class="at">-</span> INFO <span class="at">-</span> Round 5 of 20.</span>
<span id="cb81-773"><a href="#cb81-773" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:21,981 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.10</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-774"><a href="#cb81-774" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:21,981 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-775"><a href="#cb81-775" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-776"><a href="#cb81-776" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-777"><a href="#cb81-777" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-778"><a href="#cb81-778" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-779"><a href="#cb81-779" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-780"><a href="#cb81-780" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-781"><a href="#cb81-781" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-782"><a href="#cb81-782" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-783"><a href="#cb81-783" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:21,981 <span class="at">-</span> INFO <span class="at">-</span> Round 6 of 20.</span>
<span id="cb81-784"><a href="#cb81-784" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:22,627 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">141.03</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-785"><a href="#cb81-785" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:22,627 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-786"><a href="#cb81-786" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-787"><a href="#cb81-787" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-788"><a href="#cb81-788" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-789"><a href="#cb81-789" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-790"><a href="#cb81-790" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-791"><a href="#cb81-791" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-792"><a href="#cb81-792" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-793"><a href="#cb81-793" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-794"><a href="#cb81-794" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:22,627 <span class="at">-</span> INFO <span class="at">-</span> Round 7 of 20.</span>
<span id="cb81-795"><a href="#cb81-795" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:23,274 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.67</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-796"><a href="#cb81-796" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:23,275 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-797"><a href="#cb81-797" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-798"><a href="#cb81-798" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-799"><a href="#cb81-799" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-800"><a href="#cb81-800" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-801"><a href="#cb81-801" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-802"><a href="#cb81-802" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-803"><a href="#cb81-803" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-804"><a href="#cb81-804" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-805"><a href="#cb81-805" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:23,275 <span class="at">-</span> INFO <span class="at">-</span> Round 8 of 20.</span>
<span id="cb81-806"><a href="#cb81-806" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:23,950 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.68 seconds <span class="er">(</span><span class="ex">134.77</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-807"><a href="#cb81-807" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:23,950 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-808"><a href="#cb81-808" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-809"><a href="#cb81-809" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-810"><a href="#cb81-810" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-811"><a href="#cb81-811" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-812"><a href="#cb81-812" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-813"><a href="#cb81-813" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-814"><a href="#cb81-814" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-815"><a href="#cb81-815" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-816"><a href="#cb81-816" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:23,951 <span class="at">-</span> INFO <span class="at">-</span> Round 9 of 20.</span>
<span id="cb81-817"><a href="#cb81-817" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:24,637 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.69 seconds <span class="er">(</span><span class="ex">132.66</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-818"><a href="#cb81-818" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:24,637 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-819"><a href="#cb81-819" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-820"><a href="#cb81-820" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-821"><a href="#cb81-821" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-822"><a href="#cb81-822" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-823"><a href="#cb81-823" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-824"><a href="#cb81-824" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-825"><a href="#cb81-825" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-826"><a href="#cb81-826" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-827"><a href="#cb81-827" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:24,637 <span class="at">-</span> INFO <span class="at">-</span> Round 10 of 20.</span>
<span id="cb81-828"><a href="#cb81-828" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:25,293 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">138.78</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-829"><a href="#cb81-829" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:25,294 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-830"><a href="#cb81-830" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-831"><a href="#cb81-831" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-832"><a href="#cb81-832" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-833"><a href="#cb81-833" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-834"><a href="#cb81-834" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-835"><a href="#cb81-835" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-836"><a href="#cb81-836" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-837"><a href="#cb81-837" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-838"><a href="#cb81-838" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:25,294 <span class="at">-</span> INFO <span class="at">-</span> Round 11 of 20.</span>
<span id="cb81-839"><a href="#cb81-839" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:25,952 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">138.35</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-840"><a href="#cb81-840" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:25,952 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-841"><a href="#cb81-841" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-842"><a href="#cb81-842" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-843"><a href="#cb81-843" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-844"><a href="#cb81-844" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-845"><a href="#cb81-845" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-846"><a href="#cb81-846" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-847"><a href="#cb81-847" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-848"><a href="#cb81-848" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-849"><a href="#cb81-849" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:25,952 <span class="at">-</span> INFO <span class="at">-</span> Round 12 of 20.</span>
<span id="cb81-850"><a href="#cb81-850" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:26,609 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">138.65</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-851"><a href="#cb81-851" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:26,609 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-852"><a href="#cb81-852" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-853"><a href="#cb81-853" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-854"><a href="#cb81-854" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-855"><a href="#cb81-855" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-856"><a href="#cb81-856" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-857"><a href="#cb81-857" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-858"><a href="#cb81-858" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-859"><a href="#cb81-859" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-860"><a href="#cb81-860" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:26,609 <span class="at">-</span> INFO <span class="at">-</span> Round 13 of 20.</span>
<span id="cb81-861"><a href="#cb81-861" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:27,265 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">138.73</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-862"><a href="#cb81-862" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:27,265 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-863"><a href="#cb81-863" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-864"><a href="#cb81-864" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-865"><a href="#cb81-865" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-866"><a href="#cb81-866" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-867"><a href="#cb81-867" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-868"><a href="#cb81-868" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-869"><a href="#cb81-869" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-870"><a href="#cb81-870" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-871"><a href="#cb81-871" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:27,265 <span class="at">-</span> INFO <span class="at">-</span> Round 14 of 20.</span>
<span id="cb81-872"><a href="#cb81-872" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:27,922 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">138.71</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-873"><a href="#cb81-873" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:27,922 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-874"><a href="#cb81-874" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-875"><a href="#cb81-875" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-876"><a href="#cb81-876" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-877"><a href="#cb81-877" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-878"><a href="#cb81-878" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-879"><a href="#cb81-879" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-880"><a href="#cb81-880" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-881"><a href="#cb81-881" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-882"><a href="#cb81-882" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:27,922 <span class="at">-</span> INFO <span class="at">-</span> Round 15 of 20.</span>
<span id="cb81-883"><a href="#cb81-883" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:28,579 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">138.54</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-884"><a href="#cb81-884" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:28,580 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-885"><a href="#cb81-885" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-886"><a href="#cb81-886" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-887"><a href="#cb81-887" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-888"><a href="#cb81-888" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-889"><a href="#cb81-889" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-890"><a href="#cb81-890" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-891"><a href="#cb81-891" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-892"><a href="#cb81-892" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-893"><a href="#cb81-893" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:28,580 <span class="at">-</span> INFO <span class="at">-</span> Round 16 of 20.</span>
<span id="cb81-894"><a href="#cb81-894" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:29,236 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">138.70</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-895"><a href="#cb81-895" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:29,236 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-896"><a href="#cb81-896" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-897"><a href="#cb81-897" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-898"><a href="#cb81-898" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-899"><a href="#cb81-899" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-900"><a href="#cb81-900" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-901"><a href="#cb81-901" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-902"><a href="#cb81-902" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-903"><a href="#cb81-903" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-904"><a href="#cb81-904" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:29,236 <span class="at">-</span> INFO <span class="at">-</span> Round 17 of 20.</span>
<span id="cb81-905"><a href="#cb81-905" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:29,894 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">138.52</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-906"><a href="#cb81-906" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:29,894 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-907"><a href="#cb81-907" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-908"><a href="#cb81-908" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-909"><a href="#cb81-909" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-910"><a href="#cb81-910" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-911"><a href="#cb81-911" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-912"><a href="#cb81-912" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-913"><a href="#cb81-913" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-914"><a href="#cb81-914" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-915"><a href="#cb81-915" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:29,894 <span class="at">-</span> INFO <span class="at">-</span> Round 18 of 20.</span>
<span id="cb81-916"><a href="#cb81-916" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:30,550 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">138.78</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-917"><a href="#cb81-917" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:30,550 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-918"><a href="#cb81-918" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-919"><a href="#cb81-919" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-920"><a href="#cb81-920" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-921"><a href="#cb81-921" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-922"><a href="#cb81-922" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-923"><a href="#cb81-923" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-924"><a href="#cb81-924" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-925"><a href="#cb81-925" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-926"><a href="#cb81-926" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:30,550 <span class="at">-</span> INFO <span class="at">-</span> Round 19 of 20.</span>
<span id="cb81-927"><a href="#cb81-927" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:31,208 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">138.36</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-928"><a href="#cb81-928" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:31,209 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-929"><a href="#cb81-929" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-930"><a href="#cb81-930" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-931"><a href="#cb81-931" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-932"><a href="#cb81-932" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-933"><a href="#cb81-933" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-934"><a href="#cb81-934" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-935"><a href="#cb81-935" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-936"><a href="#cb81-936" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-937"><a href="#cb81-937" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:31,209 <span class="at">-</span> INFO <span class="at">-</span> Round 20 of 20.</span>
<span id="cb81-938"><a href="#cb81-938" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:31,869 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">137.96</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-939"><a href="#cb81-939" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:31,869 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-940"><a href="#cb81-940" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-941"><a href="#cb81-941" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-942"><a href="#cb81-942" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-943"><a href="#cb81-943" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-944"><a href="#cb81-944" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-945"><a href="#cb81-945" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-946"><a href="#cb81-946" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-947"><a href="#cb81-947" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-948"><a href="#cb81-948" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:31,869 <span class="at">-</span> INFO <span class="at">-</span> Run details saved to gpt2-rates-2025-02-10-20-48-31-869451-torch-compile-reduce-overhead-py313t.json.</span>
<span id="cb81-949"><a href="#cb81-949" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-950"><a href="#cb81-950" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-951"><a href="#cb81-951" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-952"><a href="#cb81-952" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-953"><a href="#cb81-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-954"><a href="#cb81-954" aria-hidden="true" tabindex="-1"></a><span class="ex">real</span>    0m20.138s</span>
<span id="cb81-955"><a href="#cb81-955" aria-hidden="true" tabindex="-1"></a><span class="ex">user</span>    0m23.350s</span>
<span id="cb81-956"><a href="#cb81-956" aria-hidden="true" tabindex="-1"></a><span class="ex">sys</span> 0m1.425s</span>
<span id="cb81-957"><a href="#cb81-957" aria-hidden="true" tabindex="-1"></a><span class="ex">Exception</span> ignored in: <span class="op">&lt;</span>_io.BufferedWriter name=41<span class="op">&gt;</span></span>
<span id="cb81-958"><a href="#cb81-958" aria-hidden="true" tabindex="-1"></a><span class="ex">BrokenPipeError:</span> [Errno 32] Broken pipe</span>
<span id="cb81-959"><a href="#cb81-959" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:38,069 <span class="at">-</span> INFO <span class="at">-</span> Loaded /mnt/raid1/trent/src/parallelopedia/data/model_19072.pt checkpoint in 0.481 seconds.</span>
<span id="cb81-960"><a href="#cb81-960" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:38,076 <span class="at">-</span> INFO <span class="at">-</span> Initialized GPT model in 0.006 seconds.</span>
<span id="cb81-961"><a href="#cb81-961" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:38,305 <span class="at">-</span> INFO <span class="at">-</span> Loaded model weights in 0.228 seconds.</span>
<span id="cb81-962"><a href="#cb81-962" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>frozen <span class="ex">importlib._bootstrap</span><span class="op">&gt;</span>:488: RuntimeWarning: The global interpreter lock <span class="er">(</span><span class="ex">GIL</span><span class="kw">)</span> <span class="ex">has</span> been enabled to load module <span class="st">'triton._C.libtriton'</span>, which has not declared that it can run safely without the GIL. To override this behavior and keep the GIL disabled <span class="er">(</span><span class="ex">at</span> your own risk<span class="kw">)</span><span class="ex">,</span> run with PYTHON_GIL=0 or <span class="at">-Xgil</span><span class="op">=</span>0.</span>
<span id="cb81-963"><a href="#cb81-963" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:38,672 <span class="at">-</span> INFO <span class="at">-</span> Created GPT model in 0.602 seconds.</span>
<span id="cb81-964"><a href="#cb81-964" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:38,756 <span class="at">-</span> INFO <span class="at">-</span> Moved model to cuda:3 in 0.085 seconds.</span>
<span id="cb81-965"><a href="#cb81-965" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:38,756 <span class="at">-</span> INFO <span class="at">-</span> Loaded model from step 19072, val_loss 3.0519702434539795</span>
<span id="cb81-966"><a href="#cb81-966" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:38,757 <span class="at">-</span> INFO <span class="at">-</span> Loaded gpt2 on cuda:3 in 1.169 seconds.</span>
<span id="cb81-967"><a href="#cb81-967" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:38,759 <span class="at">-</span> INFO <span class="at">-</span> torch.compiled model in 0.002 seconds.</span>
<span id="cb81-968"><a href="#cb81-968" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:38,759 <span class="at">-</span> INFO <span class="at">-</span> Round 1 of 20.</span>
<span id="cb81-969"><a href="#cb81-969" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:39,584 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.82 seconds <span class="er">(</span><span class="ex">110.43</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-970"><a href="#cb81-970" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:39,584 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-971"><a href="#cb81-971" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-972"><a href="#cb81-972" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-973"><a href="#cb81-973" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-974"><a href="#cb81-974" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-975"><a href="#cb81-975" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-976"><a href="#cb81-976" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-977"><a href="#cb81-977" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-978"><a href="#cb81-978" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-979"><a href="#cb81-979" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:39,584 <span class="at">-</span> INFO <span class="at">-</span> Round 2 of 20.</span>
<span id="cb81-980"><a href="#cb81-980" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:40,223 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.66</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-981"><a href="#cb81-981" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:40,223 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-982"><a href="#cb81-982" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-983"><a href="#cb81-983" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-984"><a href="#cb81-984" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-985"><a href="#cb81-985" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-986"><a href="#cb81-986" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-987"><a href="#cb81-987" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-988"><a href="#cb81-988" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-989"><a href="#cb81-989" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-990"><a href="#cb81-990" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:40,223 <span class="at">-</span> INFO <span class="at">-</span> Round 3 of 20.</span>
<span id="cb81-991"><a href="#cb81-991" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:40,863 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.18</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-992"><a href="#cb81-992" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:40,864 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-993"><a href="#cb81-993" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-994"><a href="#cb81-994" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-995"><a href="#cb81-995" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-996"><a href="#cb81-996" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-997"><a href="#cb81-997" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-998"><a href="#cb81-998" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-999"><a href="#cb81-999" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1000"><a href="#cb81-1000" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1001"><a href="#cb81-1001" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:40,864 <span class="at">-</span> INFO <span class="at">-</span> Round 4 of 20.</span>
<span id="cb81-1002"><a href="#cb81-1002" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:41,501 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.76</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1003"><a href="#cb81-1003" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:41,502 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1004"><a href="#cb81-1004" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1005"><a href="#cb81-1005" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1006"><a href="#cb81-1006" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1007"><a href="#cb81-1007" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1008"><a href="#cb81-1008" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1009"><a href="#cb81-1009" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1010"><a href="#cb81-1010" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1011"><a href="#cb81-1011" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1012"><a href="#cb81-1012" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:41,502 <span class="at">-</span> INFO <span class="at">-</span> Round 5 of 20.</span>
<span id="cb81-1013"><a href="#cb81-1013" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:42,140 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.55</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1014"><a href="#cb81-1014" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:42,141 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1015"><a href="#cb81-1015" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1016"><a href="#cb81-1016" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1017"><a href="#cb81-1017" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1018"><a href="#cb81-1018" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1019"><a href="#cb81-1019" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1020"><a href="#cb81-1020" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1021"><a href="#cb81-1021" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1022"><a href="#cb81-1022" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1023"><a href="#cb81-1023" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:42,141 <span class="at">-</span> INFO <span class="at">-</span> Round 6 of 20.</span>
<span id="cb81-1024"><a href="#cb81-1024" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:42,779 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.60</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1025"><a href="#cb81-1025" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:42,779 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1026"><a href="#cb81-1026" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1027"><a href="#cb81-1027" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1028"><a href="#cb81-1028" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1029"><a href="#cb81-1029" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1030"><a href="#cb81-1030" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1031"><a href="#cb81-1031" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1032"><a href="#cb81-1032" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1033"><a href="#cb81-1033" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1034"><a href="#cb81-1034" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:42,779 <span class="at">-</span> INFO <span class="at">-</span> Round 7 of 20.</span>
<span id="cb81-1035"><a href="#cb81-1035" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:43,416 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.91</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1036"><a href="#cb81-1036" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:43,417 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1037"><a href="#cb81-1037" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1038"><a href="#cb81-1038" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1039"><a href="#cb81-1039" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1040"><a href="#cb81-1040" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1041"><a href="#cb81-1041" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1042"><a href="#cb81-1042" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1043"><a href="#cb81-1043" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1044"><a href="#cb81-1044" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1045"><a href="#cb81-1045" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:43,417 <span class="at">-</span> INFO <span class="at">-</span> Round 8 of 20.</span>
<span id="cb81-1046"><a href="#cb81-1046" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:44,058 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.92</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1047"><a href="#cb81-1047" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:44,059 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1048"><a href="#cb81-1048" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1049"><a href="#cb81-1049" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1050"><a href="#cb81-1050" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1051"><a href="#cb81-1051" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1052"><a href="#cb81-1052" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1053"><a href="#cb81-1053" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1054"><a href="#cb81-1054" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1055"><a href="#cb81-1055" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1056"><a href="#cb81-1056" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:44,059 <span class="at">-</span> INFO <span class="at">-</span> Round 9 of 20.</span>
<span id="cb81-1057"><a href="#cb81-1057" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:44,700 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.97</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1058"><a href="#cb81-1058" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:44,700 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1059"><a href="#cb81-1059" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1060"><a href="#cb81-1060" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1061"><a href="#cb81-1061" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1062"><a href="#cb81-1062" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1063"><a href="#cb81-1063" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1064"><a href="#cb81-1064" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1065"><a href="#cb81-1065" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1066"><a href="#cb81-1066" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1067"><a href="#cb81-1067" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:44,700 <span class="at">-</span> INFO <span class="at">-</span> Round 10 of 20.</span>
<span id="cb81-1068"><a href="#cb81-1068" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:45,339 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.54</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1069"><a href="#cb81-1069" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:45,339 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1070"><a href="#cb81-1070" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1071"><a href="#cb81-1071" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1072"><a href="#cb81-1072" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1073"><a href="#cb81-1073" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1074"><a href="#cb81-1074" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1075"><a href="#cb81-1075" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1076"><a href="#cb81-1076" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1077"><a href="#cb81-1077" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1078"><a href="#cb81-1078" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:45,339 <span class="at">-</span> INFO <span class="at">-</span> Round 11 of 20.</span>
<span id="cb81-1079"><a href="#cb81-1079" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:45,977 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.78</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1080"><a href="#cb81-1080" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:45,977 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1081"><a href="#cb81-1081" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1082"><a href="#cb81-1082" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1083"><a href="#cb81-1083" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1084"><a href="#cb81-1084" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1085"><a href="#cb81-1085" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1086"><a href="#cb81-1086" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1087"><a href="#cb81-1087" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1088"><a href="#cb81-1088" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1089"><a href="#cb81-1089" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:45,977 <span class="at">-</span> INFO <span class="at">-</span> Round 12 of 20.</span>
<span id="cb81-1090"><a href="#cb81-1090" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:46,617 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.24</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1091"><a href="#cb81-1091" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:46,618 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1092"><a href="#cb81-1092" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1093"><a href="#cb81-1093" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1094"><a href="#cb81-1094" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1095"><a href="#cb81-1095" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1096"><a href="#cb81-1096" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1097"><a href="#cb81-1097" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1098"><a href="#cb81-1098" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1099"><a href="#cb81-1099" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1100"><a href="#cb81-1100" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:46,618 <span class="at">-</span> INFO <span class="at">-</span> Round 13 of 20.</span>
<span id="cb81-1101"><a href="#cb81-1101" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:47,264 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.87</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1102"><a href="#cb81-1102" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:47,264 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1103"><a href="#cb81-1103" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1104"><a href="#cb81-1104" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1105"><a href="#cb81-1105" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1106"><a href="#cb81-1106" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1107"><a href="#cb81-1107" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1108"><a href="#cb81-1108" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1109"><a href="#cb81-1109" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1110"><a href="#cb81-1110" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1111"><a href="#cb81-1111" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:47,265 <span class="at">-</span> INFO <span class="at">-</span> Round 14 of 20.</span>
<span id="cb81-1112"><a href="#cb81-1112" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:47,912 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.53</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1113"><a href="#cb81-1113" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:47,913 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1114"><a href="#cb81-1114" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1115"><a href="#cb81-1115" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1116"><a href="#cb81-1116" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1117"><a href="#cb81-1117" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1118"><a href="#cb81-1118" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1119"><a href="#cb81-1119" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1120"><a href="#cb81-1120" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1121"><a href="#cb81-1121" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1122"><a href="#cb81-1122" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:47,913 <span class="at">-</span> INFO <span class="at">-</span> Round 15 of 20.</span>
<span id="cb81-1123"><a href="#cb81-1123" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:48,561 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.36</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1124"><a href="#cb81-1124" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:48,562 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1125"><a href="#cb81-1125" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1126"><a href="#cb81-1126" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1127"><a href="#cb81-1127" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1128"><a href="#cb81-1128" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1129"><a href="#cb81-1129" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1130"><a href="#cb81-1130" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1131"><a href="#cb81-1131" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1132"><a href="#cb81-1132" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1133"><a href="#cb81-1133" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:48,562 <span class="at">-</span> INFO <span class="at">-</span> Round 16 of 20.</span>
<span id="cb81-1134"><a href="#cb81-1134" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:49,185 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.20</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1135"><a href="#cb81-1135" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:49,185 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1136"><a href="#cb81-1136" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1137"><a href="#cb81-1137" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1138"><a href="#cb81-1138" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1139"><a href="#cb81-1139" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1140"><a href="#cb81-1140" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1141"><a href="#cb81-1141" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1142"><a href="#cb81-1142" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1143"><a href="#cb81-1143" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1144"><a href="#cb81-1144" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:49,185 <span class="at">-</span> INFO <span class="at">-</span> Round 17 of 20.</span>
<span id="cb81-1145"><a href="#cb81-1145" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:49,805 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.85</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1146"><a href="#cb81-1146" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:49,805 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1147"><a href="#cb81-1147" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1148"><a href="#cb81-1148" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1149"><a href="#cb81-1149" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1150"><a href="#cb81-1150" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1151"><a href="#cb81-1151" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1152"><a href="#cb81-1152" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1153"><a href="#cb81-1153" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1154"><a href="#cb81-1154" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1155"><a href="#cb81-1155" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:49,805 <span class="at">-</span> INFO <span class="at">-</span> Round 18 of 20.</span>
<span id="cb81-1156"><a href="#cb81-1156" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:50,426 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.54</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1157"><a href="#cb81-1157" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:50,427 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1158"><a href="#cb81-1158" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1159"><a href="#cb81-1159" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1160"><a href="#cb81-1160" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1161"><a href="#cb81-1161" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1162"><a href="#cb81-1162" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1163"><a href="#cb81-1163" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1164"><a href="#cb81-1164" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1165"><a href="#cb81-1165" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1166"><a href="#cb81-1166" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:50,427 <span class="at">-</span> INFO <span class="at">-</span> Round 19 of 20.</span>
<span id="cb81-1167"><a href="#cb81-1167" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:51,048 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.67</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1168"><a href="#cb81-1168" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:51,048 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1169"><a href="#cb81-1169" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1170"><a href="#cb81-1170" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1171"><a href="#cb81-1171" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1172"><a href="#cb81-1172" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1173"><a href="#cb81-1173" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1174"><a href="#cb81-1174" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1175"><a href="#cb81-1175" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1176"><a href="#cb81-1176" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1177"><a href="#cb81-1177" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:51,048 <span class="at">-</span> INFO <span class="at">-</span> Round 20 of 20.</span>
<span id="cb81-1178"><a href="#cb81-1178" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:51,667 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.98</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1179"><a href="#cb81-1179" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:51,668 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1180"><a href="#cb81-1180" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1181"><a href="#cb81-1181" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1182"><a href="#cb81-1182" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1183"><a href="#cb81-1183" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1184"><a href="#cb81-1184" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1185"><a href="#cb81-1185" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1186"><a href="#cb81-1186" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1187"><a href="#cb81-1187" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1188"><a href="#cb81-1188" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:51,668 <span class="at">-</span> INFO <span class="at">-</span> Run details saved to gpt2-rates-2025-02-10-20-48-51-668280-torch-compile-reduce-overhead-fullgraph-py313t.json.</span>
<span id="cb81-1189"><a href="#cb81-1189" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1190"><a href="#cb81-1190" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1191"><a href="#cb81-1191" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1192"><a href="#cb81-1192" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1193"><a href="#cb81-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-1194"><a href="#cb81-1194" aria-hidden="true" tabindex="-1"></a><span class="ex">real</span>    0m19.806s</span>
<span id="cb81-1195"><a href="#cb81-1195" aria-hidden="true" tabindex="-1"></a><span class="ex">user</span>    0m23.067s</span>
<span id="cb81-1196"><a href="#cb81-1196" aria-hidden="true" tabindex="-1"></a><span class="ex">sys</span> 0m1.336s</span>
<span id="cb81-1197"><a href="#cb81-1197" aria-hidden="true" tabindex="-1"></a><span class="ex">Exception</span> ignored in: <span class="op">&lt;</span>_io.BufferedWriter name=41<span class="op">&gt;</span></span>
<span id="cb81-1198"><a href="#cb81-1198" aria-hidden="true" tabindex="-1"></a><span class="ex">BrokenPipeError:</span> [Errno 32] Broken pipe</span>
<span id="cb81-1199"><a href="#cb81-1199" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:57,852 <span class="at">-</span> INFO <span class="at">-</span> Loaded /mnt/raid1/trent/src/parallelopedia/data/model_19072.pt checkpoint in 0.472 seconds.</span>
<span id="cb81-1200"><a href="#cb81-1200" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:57,859 <span class="at">-</span> INFO <span class="at">-</span> Initialized GPT model in 0.007 seconds.</span>
<span id="cb81-1201"><a href="#cb81-1201" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:58,087 <span class="at">-</span> INFO <span class="at">-</span> Loaded model weights in 0.228 seconds.</span>
<span id="cb81-1202"><a href="#cb81-1202" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>frozen <span class="ex">importlib._bootstrap</span><span class="op">&gt;</span>:488: RuntimeWarning: The global interpreter lock <span class="er">(</span><span class="ex">GIL</span><span class="kw">)</span> <span class="ex">has</span> been enabled to load module <span class="st">'triton._C.libtriton'</span>, which has not declared that it can run safely without the GIL. To override this behavior and keep the GIL disabled <span class="er">(</span><span class="ex">at</span> your own risk<span class="kw">)</span><span class="ex">,</span> run with PYTHON_GIL=0 or <span class="at">-Xgil</span><span class="op">=</span>0.</span>
<span id="cb81-1203"><a href="#cb81-1203" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:58,455 <span class="at">-</span> INFO <span class="at">-</span> Created GPT model in 0.603 seconds.</span>
<span id="cb81-1204"><a href="#cb81-1204" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:58,540 <span class="at">-</span> INFO <span class="at">-</span> Moved model to cuda:3 in 0.085 seconds.</span>
<span id="cb81-1205"><a href="#cb81-1205" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:58,540 <span class="at">-</span> INFO <span class="at">-</span> Loaded model from step 19072, val_loss 3.0519702434539795</span>
<span id="cb81-1206"><a href="#cb81-1206" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:58,541 <span class="at">-</span> INFO <span class="at">-</span> Loaded gpt2 on cuda:3 in 1.161 seconds.</span>
<span id="cb81-1207"><a href="#cb81-1207" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:58,543 <span class="at">-</span> INFO <span class="at">-</span> torch.compiled model in 0.003 seconds.</span>
<span id="cb81-1208"><a href="#cb81-1208" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:58,543 <span class="at">-</span> INFO <span class="at">-</span> Round 1 of 20.</span>
<span id="cb81-1209"><a href="#cb81-1209" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:59,366 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.82 seconds <span class="er">(</span><span class="ex">110.79</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1210"><a href="#cb81-1210" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:59,366 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1211"><a href="#cb81-1211" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1212"><a href="#cb81-1212" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1213"><a href="#cb81-1213" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1214"><a href="#cb81-1214" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1215"><a href="#cb81-1215" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1216"><a href="#cb81-1216" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1217"><a href="#cb81-1217" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1218"><a href="#cb81-1218" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1219"><a href="#cb81-1219" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:48:59,366 <span class="at">-</span> INFO <span class="at">-</span> Round 2 of 20.</span>
<span id="cb81-1220"><a href="#cb81-1220" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:00,019 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.51</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1221"><a href="#cb81-1221" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:00,019 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1222"><a href="#cb81-1222" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1223"><a href="#cb81-1223" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1224"><a href="#cb81-1224" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1225"><a href="#cb81-1225" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1226"><a href="#cb81-1226" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1227"><a href="#cb81-1227" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1228"><a href="#cb81-1228" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1229"><a href="#cb81-1229" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1230"><a href="#cb81-1230" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:00,019 <span class="at">-</span> INFO <span class="at">-</span> Round 3 of 20.</span>
<span id="cb81-1231"><a href="#cb81-1231" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:00,706 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.69 seconds <span class="er">(</span><span class="ex">132.47</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1232"><a href="#cb81-1232" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:00,707 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1233"><a href="#cb81-1233" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1234"><a href="#cb81-1234" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1235"><a href="#cb81-1235" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1236"><a href="#cb81-1236" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1237"><a href="#cb81-1237" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1238"><a href="#cb81-1238" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1239"><a href="#cb81-1239" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1240"><a href="#cb81-1240" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1241"><a href="#cb81-1241" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:00,707 <span class="at">-</span> INFO <span class="at">-</span> Round 4 of 20.</span>
<span id="cb81-1242"><a href="#cb81-1242" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:01,327 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.66</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1243"><a href="#cb81-1243" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:01,328 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1244"><a href="#cb81-1244" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1245"><a href="#cb81-1245" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1246"><a href="#cb81-1246" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1247"><a href="#cb81-1247" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1248"><a href="#cb81-1248" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1249"><a href="#cb81-1249" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1250"><a href="#cb81-1250" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1251"><a href="#cb81-1251" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1252"><a href="#cb81-1252" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:01,328 <span class="at">-</span> INFO <span class="at">-</span> Round 5 of 20.</span>
<span id="cb81-1253"><a href="#cb81-1253" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:01,950 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.40</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1254"><a href="#cb81-1254" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:01,950 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1255"><a href="#cb81-1255" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1256"><a href="#cb81-1256" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1257"><a href="#cb81-1257" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1258"><a href="#cb81-1258" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1259"><a href="#cb81-1259" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1260"><a href="#cb81-1260" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1261"><a href="#cb81-1261" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1262"><a href="#cb81-1262" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1263"><a href="#cb81-1263" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:01,950 <span class="at">-</span> INFO <span class="at">-</span> Round 6 of 20.</span>
<span id="cb81-1264"><a href="#cb81-1264" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:02,571 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.62</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1265"><a href="#cb81-1265" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:02,571 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1266"><a href="#cb81-1266" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1267"><a href="#cb81-1267" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1268"><a href="#cb81-1268" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1269"><a href="#cb81-1269" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1270"><a href="#cb81-1270" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1271"><a href="#cb81-1271" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1272"><a href="#cb81-1272" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1273"><a href="#cb81-1273" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1274"><a href="#cb81-1274" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:02,571 <span class="at">-</span> INFO <span class="at">-</span> Round 7 of 20.</span>
<span id="cb81-1275"><a href="#cb81-1275" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:03,193 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.54</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1276"><a href="#cb81-1276" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:03,193 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1277"><a href="#cb81-1277" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1278"><a href="#cb81-1278" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1279"><a href="#cb81-1279" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1280"><a href="#cb81-1280" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1281"><a href="#cb81-1281" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1282"><a href="#cb81-1282" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1283"><a href="#cb81-1283" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1284"><a href="#cb81-1284" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1285"><a href="#cb81-1285" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:03,193 <span class="at">-</span> INFO <span class="at">-</span> Round 8 of 20.</span>
<span id="cb81-1286"><a href="#cb81-1286" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:03,816 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.13</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1287"><a href="#cb81-1287" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:03,816 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1288"><a href="#cb81-1288" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1289"><a href="#cb81-1289" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1290"><a href="#cb81-1290" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1291"><a href="#cb81-1291" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1292"><a href="#cb81-1292" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1293"><a href="#cb81-1293" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1294"><a href="#cb81-1294" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1295"><a href="#cb81-1295" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1296"><a href="#cb81-1296" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:03,816 <span class="at">-</span> INFO <span class="at">-</span> Round 9 of 20.</span>
<span id="cb81-1297"><a href="#cb81-1297" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:04,444 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.63 seconds <span class="er">(</span><span class="ex">145.02</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1298"><a href="#cb81-1298" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:04,444 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1299"><a href="#cb81-1299" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1300"><a href="#cb81-1300" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1301"><a href="#cb81-1301" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1302"><a href="#cb81-1302" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1303"><a href="#cb81-1303" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1304"><a href="#cb81-1304" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1305"><a href="#cb81-1305" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1306"><a href="#cb81-1306" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1307"><a href="#cb81-1307" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:04,444 <span class="at">-</span> INFO <span class="at">-</span> Round 10 of 20.</span>
<span id="cb81-1308"><a href="#cb81-1308" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:05,066 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.47</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1309"><a href="#cb81-1309" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:05,066 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1310"><a href="#cb81-1310" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1311"><a href="#cb81-1311" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1312"><a href="#cb81-1312" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1313"><a href="#cb81-1313" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1314"><a href="#cb81-1314" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1315"><a href="#cb81-1315" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1316"><a href="#cb81-1316" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1317"><a href="#cb81-1317" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1318"><a href="#cb81-1318" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:05,066 <span class="at">-</span> INFO <span class="at">-</span> Round 11 of 20.</span>
<span id="cb81-1319"><a href="#cb81-1319" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:05,688 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.45</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1320"><a href="#cb81-1320" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:05,688 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1321"><a href="#cb81-1321" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1322"><a href="#cb81-1322" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1323"><a href="#cb81-1323" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1324"><a href="#cb81-1324" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1325"><a href="#cb81-1325" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1326"><a href="#cb81-1326" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1327"><a href="#cb81-1327" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1328"><a href="#cb81-1328" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1329"><a href="#cb81-1329" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:05,688 <span class="at">-</span> INFO <span class="at">-</span> Round 12 of 20.</span>
<span id="cb81-1330"><a href="#cb81-1330" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:06,310 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.37</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1331"><a href="#cb81-1331" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:06,311 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1332"><a href="#cb81-1332" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1333"><a href="#cb81-1333" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1334"><a href="#cb81-1334" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1335"><a href="#cb81-1335" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1336"><a href="#cb81-1336" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1337"><a href="#cb81-1337" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1338"><a href="#cb81-1338" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1339"><a href="#cb81-1339" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1340"><a href="#cb81-1340" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:06,311 <span class="at">-</span> INFO <span class="at">-</span> Round 13 of 20.</span>
<span id="cb81-1341"><a href="#cb81-1341" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:06,933 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.27</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1342"><a href="#cb81-1342" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:06,933 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1343"><a href="#cb81-1343" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1344"><a href="#cb81-1344" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1345"><a href="#cb81-1345" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1346"><a href="#cb81-1346" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1347"><a href="#cb81-1347" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1348"><a href="#cb81-1348" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1349"><a href="#cb81-1349" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1350"><a href="#cb81-1350" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1351"><a href="#cb81-1351" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:06,933 <span class="at">-</span> INFO <span class="at">-</span> Round 14 of 20.</span>
<span id="cb81-1352"><a href="#cb81-1352" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:07,554 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.56</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1353"><a href="#cb81-1353" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:07,555 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1354"><a href="#cb81-1354" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1355"><a href="#cb81-1355" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1356"><a href="#cb81-1356" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1357"><a href="#cb81-1357" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1358"><a href="#cb81-1358" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1359"><a href="#cb81-1359" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1360"><a href="#cb81-1360" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1361"><a href="#cb81-1361" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1362"><a href="#cb81-1362" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:07,555 <span class="at">-</span> INFO <span class="at">-</span> Round 15 of 20.</span>
<span id="cb81-1363"><a href="#cb81-1363" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:08,176 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.45</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1364"><a href="#cb81-1364" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:08,177 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1365"><a href="#cb81-1365" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1366"><a href="#cb81-1366" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1367"><a href="#cb81-1367" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1368"><a href="#cb81-1368" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1369"><a href="#cb81-1369" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1370"><a href="#cb81-1370" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1371"><a href="#cb81-1371" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1372"><a href="#cb81-1372" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1373"><a href="#cb81-1373" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:08,177 <span class="at">-</span> INFO <span class="at">-</span> Round 16 of 20.</span>
<span id="cb81-1374"><a href="#cb81-1374" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:08,799 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.39</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1375"><a href="#cb81-1375" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:08,799 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1376"><a href="#cb81-1376" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1377"><a href="#cb81-1377" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1378"><a href="#cb81-1378" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1379"><a href="#cb81-1379" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1380"><a href="#cb81-1380" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1381"><a href="#cb81-1381" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1382"><a href="#cb81-1382" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1383"><a href="#cb81-1383" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1384"><a href="#cb81-1384" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:08,799 <span class="at">-</span> INFO <span class="at">-</span> Round 17 of 20.</span>
<span id="cb81-1385"><a href="#cb81-1385" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:09,420 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.49</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1386"><a href="#cb81-1386" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:09,421 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1387"><a href="#cb81-1387" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1388"><a href="#cb81-1388" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1389"><a href="#cb81-1389" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1390"><a href="#cb81-1390" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1391"><a href="#cb81-1391" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1392"><a href="#cb81-1392" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1393"><a href="#cb81-1393" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1394"><a href="#cb81-1394" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1395"><a href="#cb81-1395" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:09,421 <span class="at">-</span> INFO <span class="at">-</span> Round 18 of 20.</span>
<span id="cb81-1396"><a href="#cb81-1396" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:10,043 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.24</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1397"><a href="#cb81-1397" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:10,044 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1398"><a href="#cb81-1398" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1399"><a href="#cb81-1399" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1400"><a href="#cb81-1400" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1401"><a href="#cb81-1401" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1402"><a href="#cb81-1402" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1403"><a href="#cb81-1403" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1404"><a href="#cb81-1404" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1405"><a href="#cb81-1405" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1406"><a href="#cb81-1406" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:10,044 <span class="at">-</span> INFO <span class="at">-</span> Round 19 of 20.</span>
<span id="cb81-1407"><a href="#cb81-1407" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:10,665 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.62</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1408"><a href="#cb81-1408" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:10,665 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1409"><a href="#cb81-1409" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1410"><a href="#cb81-1410" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1411"><a href="#cb81-1411" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1412"><a href="#cb81-1412" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1413"><a href="#cb81-1413" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1414"><a href="#cb81-1414" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1415"><a href="#cb81-1415" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1416"><a href="#cb81-1416" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1417"><a href="#cb81-1417" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:10,665 <span class="at">-</span> INFO <span class="at">-</span> Round 20 of 20.</span>
<span id="cb81-1418"><a href="#cb81-1418" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:11,286 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.62 seconds <span class="er">(</span><span class="ex">146.54</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1419"><a href="#cb81-1419" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:11,286 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1420"><a href="#cb81-1420" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1421"><a href="#cb81-1421" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1422"><a href="#cb81-1422" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1423"><a href="#cb81-1423" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1424"><a href="#cb81-1424" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1425"><a href="#cb81-1425" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1426"><a href="#cb81-1426" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1427"><a href="#cb81-1427" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1428"><a href="#cb81-1428" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:11,287 <span class="at">-</span> INFO <span class="at">-</span> Run details saved to gpt2-rates-2025-02-10-20-49-11-287012-torch-compile-reduce-overhead-fullgraph-py313t.json.</span>
<span id="cb81-1429"><a href="#cb81-1429" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1430"><a href="#cb81-1430" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1431"><a href="#cb81-1431" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1432"><a href="#cb81-1432" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1433"><a href="#cb81-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-1434"><a href="#cb81-1434" aria-hidden="true" tabindex="-1"></a><span class="ex">real</span>    0m19.626s</span>
<span id="cb81-1435"><a href="#cb81-1435" aria-hidden="true" tabindex="-1"></a><span class="ex">user</span>    0m22.831s</span>
<span id="cb81-1436"><a href="#cb81-1436" aria-hidden="true" tabindex="-1"></a><span class="ex">sys</span> 0m1.406s</span>
<span id="cb81-1437"><a href="#cb81-1437" aria-hidden="true" tabindex="-1"></a><span class="ex">Exception</span> ignored in: <span class="op">&lt;</span>_io.BufferedWriter name=41<span class="op">&gt;</span></span>
<span id="cb81-1438"><a href="#cb81-1438" aria-hidden="true" tabindex="-1"></a><span class="ex">BrokenPipeError:</span> [Errno 32] Broken pipe</span>
<span id="cb81-1439"><a href="#cb81-1439" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:17,458 <span class="at">-</span> INFO <span class="at">-</span> Loaded /mnt/raid1/trent/src/parallelopedia/data/model_19072.pt checkpoint in 0.491 seconds.</span>
<span id="cb81-1440"><a href="#cb81-1440" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:17,465 <span class="at">-</span> INFO <span class="at">-</span> Initialized GPT model in 0.006 seconds.</span>
<span id="cb81-1441"><a href="#cb81-1441" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:17,704 <span class="at">-</span> INFO <span class="at">-</span> Loaded model weights in 0.239 seconds.</span>
<span id="cb81-1442"><a href="#cb81-1442" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>frozen <span class="ex">importlib._bootstrap</span><span class="op">&gt;</span>:488: RuntimeWarning: The global interpreter lock <span class="er">(</span><span class="ex">GIL</span><span class="kw">)</span> <span class="ex">has</span> been enabled to load module <span class="st">'triton._C.libtriton'</span>, which has not declared that it can run safely without the GIL. To override this behavior and keep the GIL disabled <span class="er">(</span><span class="ex">at</span> your own risk<span class="kw">)</span><span class="ex">,</span> run with PYTHON_GIL=0 or <span class="at">-Xgil</span><span class="op">=</span>0.</span>
<span id="cb81-1443"><a href="#cb81-1443" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:18,069 <span class="at">-</span> INFO <span class="at">-</span> Created GPT model in 0.611 seconds.</span>
<span id="cb81-1444"><a href="#cb81-1444" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:18,153 <span class="at">-</span> INFO <span class="at">-</span> Moved model to cuda:3 in 0.084 seconds.</span>
<span id="cb81-1445"><a href="#cb81-1445" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:18,153 <span class="at">-</span> INFO <span class="at">-</span> Loaded model from step 19072, val_loss 3.0519702434539795</span>
<span id="cb81-1446"><a href="#cb81-1446" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:18,153 <span class="at">-</span> INFO <span class="at">-</span> Loaded gpt2 on cuda:3 in 1.187 seconds.</span>
<span id="cb81-1447"><a href="#cb81-1447" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:18,157 <span class="at">-</span> INFO <span class="at">-</span> torch.compiled model in 0.003 seconds.</span>
<span id="cb81-1448"><a href="#cb81-1448" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:18,157 <span class="at">-</span> INFO <span class="at">-</span> Round 1 of 20.</span>
<span id="cb81-1449"><a href="#cb81-1449" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:18,973 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.82 seconds <span class="er">(</span><span class="ex">111.60</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1450"><a href="#cb81-1450" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:18,973 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1451"><a href="#cb81-1451" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1452"><a href="#cb81-1452" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1453"><a href="#cb81-1453" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1454"><a href="#cb81-1454" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1455"><a href="#cb81-1455" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1456"><a href="#cb81-1456" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1457"><a href="#cb81-1457" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1458"><a href="#cb81-1458" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1459"><a href="#cb81-1459" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:18,973 <span class="at">-</span> INFO <span class="at">-</span> Round 2 of 20.</span>
<span id="cb81-1460"><a href="#cb81-1460" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:19,621 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.58</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1461"><a href="#cb81-1461" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:19,621 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1462"><a href="#cb81-1462" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1463"><a href="#cb81-1463" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1464"><a href="#cb81-1464" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1465"><a href="#cb81-1465" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1466"><a href="#cb81-1466" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1467"><a href="#cb81-1467" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1468"><a href="#cb81-1468" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1469"><a href="#cb81-1469" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1470"><a href="#cb81-1470" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:19,621 <span class="at">-</span> INFO <span class="at">-</span> Round 3 of 20.</span>
<span id="cb81-1471"><a href="#cb81-1471" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:20,266 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.26</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1472"><a href="#cb81-1472" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:20,266 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1473"><a href="#cb81-1473" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1474"><a href="#cb81-1474" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1475"><a href="#cb81-1475" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1476"><a href="#cb81-1476" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1477"><a href="#cb81-1477" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1478"><a href="#cb81-1478" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1479"><a href="#cb81-1479" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1480"><a href="#cb81-1480" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1481"><a href="#cb81-1481" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:20,266 <span class="at">-</span> INFO <span class="at">-</span> Round 4 of 20.</span>
<span id="cb81-1482"><a href="#cb81-1482" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:20,911 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.24</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1483"><a href="#cb81-1483" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:20,911 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1484"><a href="#cb81-1484" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1485"><a href="#cb81-1485" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1486"><a href="#cb81-1486" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1487"><a href="#cb81-1487" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1488"><a href="#cb81-1488" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1489"><a href="#cb81-1489" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1490"><a href="#cb81-1490" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1491"><a href="#cb81-1491" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1492"><a href="#cb81-1492" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:20,911 <span class="at">-</span> INFO <span class="at">-</span> Round 5 of 20.</span>
<span id="cb81-1493"><a href="#cb81-1493" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:21,555 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.46</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1494"><a href="#cb81-1494" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:21,555 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1495"><a href="#cb81-1495" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1496"><a href="#cb81-1496" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1497"><a href="#cb81-1497" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1498"><a href="#cb81-1498" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1499"><a href="#cb81-1499" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1500"><a href="#cb81-1500" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1501"><a href="#cb81-1501" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1502"><a href="#cb81-1502" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1503"><a href="#cb81-1503" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:21,555 <span class="at">-</span> INFO <span class="at">-</span> Round 6 of 20.</span>
<span id="cb81-1504"><a href="#cb81-1504" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:22,199 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.27</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1505"><a href="#cb81-1505" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:22,200 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1506"><a href="#cb81-1506" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1507"><a href="#cb81-1507" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1508"><a href="#cb81-1508" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1509"><a href="#cb81-1509" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1510"><a href="#cb81-1510" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1511"><a href="#cb81-1511" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1512"><a href="#cb81-1512" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1513"><a href="#cb81-1513" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1514"><a href="#cb81-1514" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:22,200 <span class="at">-</span> INFO <span class="at">-</span> Round 7 of 20.</span>
<span id="cb81-1515"><a href="#cb81-1515" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:22,846 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.98</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1516"><a href="#cb81-1516" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:22,846 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1517"><a href="#cb81-1517" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1518"><a href="#cb81-1518" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1519"><a href="#cb81-1519" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1520"><a href="#cb81-1520" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1521"><a href="#cb81-1521" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1522"><a href="#cb81-1522" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1523"><a href="#cb81-1523" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1524"><a href="#cb81-1524" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1525"><a href="#cb81-1525" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:22,846 <span class="at">-</span> INFO <span class="at">-</span> Round 8 of 20.</span>
<span id="cb81-1526"><a href="#cb81-1526" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:23,486 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.29</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1527"><a href="#cb81-1527" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:23,487 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1528"><a href="#cb81-1528" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1529"><a href="#cb81-1529" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1530"><a href="#cb81-1530" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1531"><a href="#cb81-1531" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1532"><a href="#cb81-1532" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1533"><a href="#cb81-1533" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1534"><a href="#cb81-1534" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1535"><a href="#cb81-1535" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1536"><a href="#cb81-1536" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:23,487 <span class="at">-</span> INFO <span class="at">-</span> Round 9 of 20.</span>
<span id="cb81-1537"><a href="#cb81-1537" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:24,129 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.71</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1538"><a href="#cb81-1538" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:24,130 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1539"><a href="#cb81-1539" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1540"><a href="#cb81-1540" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1541"><a href="#cb81-1541" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1542"><a href="#cb81-1542" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1543"><a href="#cb81-1543" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1544"><a href="#cb81-1544" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1545"><a href="#cb81-1545" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1546"><a href="#cb81-1546" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1547"><a href="#cb81-1547" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:24,130 <span class="at">-</span> INFO <span class="at">-</span> Round 10 of 20.</span>
<span id="cb81-1548"><a href="#cb81-1548" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:24,771 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.83</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1549"><a href="#cb81-1549" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:24,772 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1550"><a href="#cb81-1550" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1551"><a href="#cb81-1551" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1552"><a href="#cb81-1552" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1553"><a href="#cb81-1553" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1554"><a href="#cb81-1554" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1555"><a href="#cb81-1555" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1556"><a href="#cb81-1556" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1557"><a href="#cb81-1557" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1558"><a href="#cb81-1558" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:24,772 <span class="at">-</span> INFO <span class="at">-</span> Round 11 of 20.</span>
<span id="cb81-1559"><a href="#cb81-1559" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:25,413 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.00</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1560"><a href="#cb81-1560" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:25,413 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1561"><a href="#cb81-1561" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1562"><a href="#cb81-1562" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1563"><a href="#cb81-1563" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1564"><a href="#cb81-1564" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1565"><a href="#cb81-1565" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1566"><a href="#cb81-1566" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1567"><a href="#cb81-1567" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1568"><a href="#cb81-1568" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1569"><a href="#cb81-1569" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:25,414 <span class="at">-</span> INFO <span class="at">-</span> Round 12 of 20.</span>
<span id="cb81-1570"><a href="#cb81-1570" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:26,056 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.66</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1571"><a href="#cb81-1571" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:26,056 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1572"><a href="#cb81-1572" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1573"><a href="#cb81-1573" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1574"><a href="#cb81-1574" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1575"><a href="#cb81-1575" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1576"><a href="#cb81-1576" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1577"><a href="#cb81-1577" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1578"><a href="#cb81-1578" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1579"><a href="#cb81-1579" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1580"><a href="#cb81-1580" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:26,057 <span class="at">-</span> INFO <span class="at">-</span> Round 13 of 20.</span>
<span id="cb81-1581"><a href="#cb81-1581" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:26,703 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.87</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1582"><a href="#cb81-1582" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:26,703 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1583"><a href="#cb81-1583" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1584"><a href="#cb81-1584" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1585"><a href="#cb81-1585" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1586"><a href="#cb81-1586" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1587"><a href="#cb81-1587" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1588"><a href="#cb81-1588" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1589"><a href="#cb81-1589" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1590"><a href="#cb81-1590" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1591"><a href="#cb81-1591" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:26,703 <span class="at">-</span> INFO <span class="at">-</span> Round 14 of 20.</span>
<span id="cb81-1592"><a href="#cb81-1592" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:27,344 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.96</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1593"><a href="#cb81-1593" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:27,345 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1594"><a href="#cb81-1594" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1595"><a href="#cb81-1595" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1596"><a href="#cb81-1596" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1597"><a href="#cb81-1597" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1598"><a href="#cb81-1598" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1599"><a href="#cb81-1599" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1600"><a href="#cb81-1600" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1601"><a href="#cb81-1601" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1602"><a href="#cb81-1602" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:27,345 <span class="at">-</span> INFO <span class="at">-</span> Round 15 of 20.</span>
<span id="cb81-1603"><a href="#cb81-1603" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:27,986 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.08</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1604"><a href="#cb81-1604" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:27,986 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1605"><a href="#cb81-1605" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1606"><a href="#cb81-1606" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1607"><a href="#cb81-1607" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1608"><a href="#cb81-1608" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1609"><a href="#cb81-1609" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1610"><a href="#cb81-1610" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1611"><a href="#cb81-1611" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1612"><a href="#cb81-1612" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1613"><a href="#cb81-1613" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:27,986 <span class="at">-</span> INFO <span class="at">-</span> Round 16 of 20.</span>
<span id="cb81-1614"><a href="#cb81-1614" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:28,628 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.93</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1615"><a href="#cb81-1615" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:28,628 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1616"><a href="#cb81-1616" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1617"><a href="#cb81-1617" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1618"><a href="#cb81-1618" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1619"><a href="#cb81-1619" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1620"><a href="#cb81-1620" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1621"><a href="#cb81-1621" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1622"><a href="#cb81-1622" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1623"><a href="#cb81-1623" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1624"><a href="#cb81-1624" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:28,628 <span class="at">-</span> INFO <span class="at">-</span> Round 17 of 20.</span>
<span id="cb81-1625"><a href="#cb81-1625" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:29,269 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">142.10</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1626"><a href="#cb81-1626" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:29,269 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1627"><a href="#cb81-1627" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1628"><a href="#cb81-1628" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1629"><a href="#cb81-1629" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1630"><a href="#cb81-1630" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1631"><a href="#cb81-1631" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1632"><a href="#cb81-1632" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1633"><a href="#cb81-1633" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1634"><a href="#cb81-1634" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1635"><a href="#cb81-1635" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:29,269 <span class="at">-</span> INFO <span class="at">-</span> Round 18 of 20.</span>
<span id="cb81-1636"><a href="#cb81-1636" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:29,913 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.43</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1637"><a href="#cb81-1637" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:29,913 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1638"><a href="#cb81-1638" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1639"><a href="#cb81-1639" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1640"><a href="#cb81-1640" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1641"><a href="#cb81-1641" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1642"><a href="#cb81-1642" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1643"><a href="#cb81-1643" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1644"><a href="#cb81-1644" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1645"><a href="#cb81-1645" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1646"><a href="#cb81-1646" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:29,913 <span class="at">-</span> INFO <span class="at">-</span> Round 19 of 20.</span>
<span id="cb81-1647"><a href="#cb81-1647" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:30,557 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.46</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1648"><a href="#cb81-1648" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:30,557 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1649"><a href="#cb81-1649" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1650"><a href="#cb81-1650" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1651"><a href="#cb81-1651" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1652"><a href="#cb81-1652" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1653"><a href="#cb81-1653" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1654"><a href="#cb81-1654" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1655"><a href="#cb81-1655" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1656"><a href="#cb81-1656" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1657"><a href="#cb81-1657" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:30,557 <span class="at">-</span> INFO <span class="at">-</span> Round 20 of 20.</span>
<span id="cb81-1658"><a href="#cb81-1658" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:31,199 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.84</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1659"><a href="#cb81-1659" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:31,199 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1660"><a href="#cb81-1660" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1661"><a href="#cb81-1661" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1662"><a href="#cb81-1662" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1663"><a href="#cb81-1663" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1664"><a href="#cb81-1664" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1665"><a href="#cb81-1665" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1666"><a href="#cb81-1666" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1667"><a href="#cb81-1667" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1668"><a href="#cb81-1668" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:31,200 <span class="at">-</span> INFO <span class="at">-</span> Run details saved to gpt2-rates-2025-02-10-20-49-31-199651-torch-compile-max-autotune-py313t.json.</span>
<span id="cb81-1669"><a href="#cb81-1669" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1670"><a href="#cb81-1670" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1671"><a href="#cb81-1671" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1672"><a href="#cb81-1672" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1673"><a href="#cb81-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-1674"><a href="#cb81-1674" aria-hidden="true" tabindex="-1"></a><span class="ex">real</span>    0m19.900s</span>
<span id="cb81-1675"><a href="#cb81-1675" aria-hidden="true" tabindex="-1"></a><span class="ex">user</span>    0m23.112s</span>
<span id="cb81-1676"><a href="#cb81-1676" aria-hidden="true" tabindex="-1"></a><span class="ex">sys</span> 0m1.409s</span>
<span id="cb81-1677"><a href="#cb81-1677" aria-hidden="true" tabindex="-1"></a><span class="ex">Exception</span> ignored in: <span class="op">&lt;</span>_io.BufferedWriter name=41<span class="op">&gt;</span></span>
<span id="cb81-1678"><a href="#cb81-1678" aria-hidden="true" tabindex="-1"></a><span class="ex">BrokenPipeError:</span> [Errno 32] Broken pipe</span>
<span id="cb81-1679"><a href="#cb81-1679" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:37,383 <span class="at">-</span> INFO <span class="at">-</span> Loaded /mnt/raid1/trent/src/parallelopedia/data/model_19072.pt checkpoint in 0.482 seconds.</span>
<span id="cb81-1680"><a href="#cb81-1680" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:37,390 <span class="at">-</span> INFO <span class="at">-</span> Initialized GPT model in 0.006 seconds.</span>
<span id="cb81-1681"><a href="#cb81-1681" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:37,613 <span class="at">-</span> INFO <span class="at">-</span> Loaded model weights in 0.223 seconds.</span>
<span id="cb81-1682"><a href="#cb81-1682" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>frozen <span class="ex">importlib._bootstrap</span><span class="op">&gt;</span>:488: RuntimeWarning: The global interpreter lock <span class="er">(</span><span class="ex">GIL</span><span class="kw">)</span> <span class="ex">has</span> been enabled to load module <span class="st">'triton._C.libtriton'</span>, which has not declared that it can run safely without the GIL. To override this behavior and keep the GIL disabled <span class="er">(</span><span class="ex">at</span> your own risk<span class="kw">)</span><span class="ex">,</span> run with PYTHON_GIL=0 or <span class="at">-Xgil</span><span class="op">=</span>0.</span>
<span id="cb81-1683"><a href="#cb81-1683" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:37,976 <span class="at">-</span> INFO <span class="at">-</span> Created GPT model in 0.592 seconds.</span>
<span id="cb81-1684"><a href="#cb81-1684" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:38,058 <span class="at">-</span> INFO <span class="at">-</span> Moved model to cuda:3 in 0.082 seconds.</span>
<span id="cb81-1685"><a href="#cb81-1685" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:38,058 <span class="at">-</span> INFO <span class="at">-</span> Loaded model from step 19072, val_loss 3.0519702434539795</span>
<span id="cb81-1686"><a href="#cb81-1686" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:38,058 <span class="at">-</span> INFO <span class="at">-</span> Loaded gpt2 on cuda:3 in 1.157 seconds.</span>
<span id="cb81-1687"><a href="#cb81-1687" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:38,061 <span class="at">-</span> INFO <span class="at">-</span> torch.compiled model in 0.002 seconds.</span>
<span id="cb81-1688"><a href="#cb81-1688" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:38,061 <span class="at">-</span> INFO <span class="at">-</span> Round 1 of 20.</span>
<span id="cb81-1689"><a href="#cb81-1689" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:38,896 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.83 seconds <span class="er">(</span><span class="ex">109.09</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1690"><a href="#cb81-1690" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:38,896 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1691"><a href="#cb81-1691" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1692"><a href="#cb81-1692" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1693"><a href="#cb81-1693" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1694"><a href="#cb81-1694" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1695"><a href="#cb81-1695" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1696"><a href="#cb81-1696" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1697"><a href="#cb81-1697" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1698"><a href="#cb81-1698" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1699"><a href="#cb81-1699" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:38,896 <span class="at">-</span> INFO <span class="at">-</span> Round 2 of 20.</span>
<span id="cb81-1700"><a href="#cb81-1700" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:39,552 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">138.68</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1701"><a href="#cb81-1701" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:39,553 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1702"><a href="#cb81-1702" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1703"><a href="#cb81-1703" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1704"><a href="#cb81-1704" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1705"><a href="#cb81-1705" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1706"><a href="#cb81-1706" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1707"><a href="#cb81-1707" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1708"><a href="#cb81-1708" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1709"><a href="#cb81-1709" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1710"><a href="#cb81-1710" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:39,553 <span class="at">-</span> INFO <span class="at">-</span> Round 3 of 20.</span>
<span id="cb81-1711"><a href="#cb81-1711" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:40,199 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.90</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1712"><a href="#cb81-1712" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:40,199 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1713"><a href="#cb81-1713" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1714"><a href="#cb81-1714" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1715"><a href="#cb81-1715" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1716"><a href="#cb81-1716" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1717"><a href="#cb81-1717" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1718"><a href="#cb81-1718" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1719"><a href="#cb81-1719" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1720"><a href="#cb81-1720" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1721"><a href="#cb81-1721" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:40,199 <span class="at">-</span> INFO <span class="at">-</span> Round 4 of 20.</span>
<span id="cb81-1722"><a href="#cb81-1722" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:40,851 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.61</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1723"><a href="#cb81-1723" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:40,852 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1724"><a href="#cb81-1724" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1725"><a href="#cb81-1725" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1726"><a href="#cb81-1726" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1727"><a href="#cb81-1727" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1728"><a href="#cb81-1728" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1729"><a href="#cb81-1729" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1730"><a href="#cb81-1730" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1731"><a href="#cb81-1731" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1732"><a href="#cb81-1732" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:40,852 <span class="at">-</span> INFO <span class="at">-</span> Round 5 of 20.</span>
<span id="cb81-1733"><a href="#cb81-1733" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:41,496 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.24</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1734"><a href="#cb81-1734" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:41,497 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1735"><a href="#cb81-1735" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1736"><a href="#cb81-1736" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1737"><a href="#cb81-1737" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1738"><a href="#cb81-1738" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1739"><a href="#cb81-1739" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1740"><a href="#cb81-1740" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1741"><a href="#cb81-1741" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1742"><a href="#cb81-1742" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1743"><a href="#cb81-1743" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:41,497 <span class="at">-</span> INFO <span class="at">-</span> Round 6 of 20.</span>
<span id="cb81-1744"><a href="#cb81-1744" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:42,143 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.79</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1745"><a href="#cb81-1745" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:42,144 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1746"><a href="#cb81-1746" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1747"><a href="#cb81-1747" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1748"><a href="#cb81-1748" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1749"><a href="#cb81-1749" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1750"><a href="#cb81-1750" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1751"><a href="#cb81-1751" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1752"><a href="#cb81-1752" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1753"><a href="#cb81-1753" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1754"><a href="#cb81-1754" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:42,144 <span class="at">-</span> INFO <span class="at">-</span> Round 7 of 20.</span>
<span id="cb81-1755"><a href="#cb81-1755" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:42,794 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">139.98</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1756"><a href="#cb81-1756" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:42,794 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1757"><a href="#cb81-1757" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1758"><a href="#cb81-1758" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1759"><a href="#cb81-1759" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1760"><a href="#cb81-1760" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1761"><a href="#cb81-1761" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1762"><a href="#cb81-1762" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1763"><a href="#cb81-1763" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1764"><a href="#cb81-1764" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1765"><a href="#cb81-1765" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:42,795 <span class="at">-</span> INFO <span class="at">-</span> Round 8 of 20.</span>
<span id="cb81-1766"><a href="#cb81-1766" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:43,442 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.59</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1767"><a href="#cb81-1767" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:43,442 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1768"><a href="#cb81-1768" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1769"><a href="#cb81-1769" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1770"><a href="#cb81-1770" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1771"><a href="#cb81-1771" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1772"><a href="#cb81-1772" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1773"><a href="#cb81-1773" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1774"><a href="#cb81-1774" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1775"><a href="#cb81-1775" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1776"><a href="#cb81-1776" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:43,442 <span class="at">-</span> INFO <span class="at">-</span> Round 9 of 20.</span>
<span id="cb81-1777"><a href="#cb81-1777" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:44,088 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">141.07</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1778"><a href="#cb81-1778" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:44,088 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1779"><a href="#cb81-1779" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1780"><a href="#cb81-1780" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1781"><a href="#cb81-1781" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1782"><a href="#cb81-1782" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1783"><a href="#cb81-1783" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1784"><a href="#cb81-1784" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1785"><a href="#cb81-1785" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1786"><a href="#cb81-1786" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1787"><a href="#cb81-1787" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:44,088 <span class="at">-</span> INFO <span class="at">-</span> Round 10 of 20.</span>
<span id="cb81-1788"><a href="#cb81-1788" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:44,738 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.10</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1789"><a href="#cb81-1789" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:44,738 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1790"><a href="#cb81-1790" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1791"><a href="#cb81-1791" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1792"><a href="#cb81-1792" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1793"><a href="#cb81-1793" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1794"><a href="#cb81-1794" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1795"><a href="#cb81-1795" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1796"><a href="#cb81-1796" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1797"><a href="#cb81-1797" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1798"><a href="#cb81-1798" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:44,738 <span class="at">-</span> INFO <span class="at">-</span> Round 11 of 20.</span>
<span id="cb81-1799"><a href="#cb81-1799" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:45,382 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.34</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1800"><a href="#cb81-1800" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:45,383 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1801"><a href="#cb81-1801" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1802"><a href="#cb81-1802" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1803"><a href="#cb81-1803" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1804"><a href="#cb81-1804" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1805"><a href="#cb81-1805" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1806"><a href="#cb81-1806" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1807"><a href="#cb81-1807" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1808"><a href="#cb81-1808" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1809"><a href="#cb81-1809" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:45,383 <span class="at">-</span> INFO <span class="at">-</span> Round 12 of 20.</span>
<span id="cb81-1810"><a href="#cb81-1810" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:46,026 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.47</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1811"><a href="#cb81-1811" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:46,027 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1812"><a href="#cb81-1812" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1813"><a href="#cb81-1813" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1814"><a href="#cb81-1814" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1815"><a href="#cb81-1815" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1816"><a href="#cb81-1816" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1817"><a href="#cb81-1817" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1818"><a href="#cb81-1818" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1819"><a href="#cb81-1819" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1820"><a href="#cb81-1820" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:46,027 <span class="at">-</span> INFO <span class="at">-</span> Round 13 of 20.</span>
<span id="cb81-1821"><a href="#cb81-1821" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:46,695 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.67 seconds <span class="er">(</span><span class="ex">136.23</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1822"><a href="#cb81-1822" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:46,695 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1823"><a href="#cb81-1823" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1824"><a href="#cb81-1824" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1825"><a href="#cb81-1825" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1826"><a href="#cb81-1826" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1827"><a href="#cb81-1827" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1828"><a href="#cb81-1828" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1829"><a href="#cb81-1829" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1830"><a href="#cb81-1830" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1831"><a href="#cb81-1831" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:46,695 <span class="at">-</span> INFO <span class="at">-</span> Round 14 of 20.</span>
<span id="cb81-1832"><a href="#cb81-1832" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:47,339 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.40</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1833"><a href="#cb81-1833" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:47,340 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1834"><a href="#cb81-1834" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1835"><a href="#cb81-1835" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1836"><a href="#cb81-1836" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1837"><a href="#cb81-1837" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1838"><a href="#cb81-1838" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1839"><a href="#cb81-1839" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1840"><a href="#cb81-1840" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1841"><a href="#cb81-1841" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1842"><a href="#cb81-1842" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:47,340 <span class="at">-</span> INFO <span class="at">-</span> Round 15 of 20.</span>
<span id="cb81-1843"><a href="#cb81-1843" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:47,988 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.35</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1844"><a href="#cb81-1844" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:47,989 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1845"><a href="#cb81-1845" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1846"><a href="#cb81-1846" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1847"><a href="#cb81-1847" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1848"><a href="#cb81-1848" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1849"><a href="#cb81-1849" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1850"><a href="#cb81-1850" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1851"><a href="#cb81-1851" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1852"><a href="#cb81-1852" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1853"><a href="#cb81-1853" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:47,989 <span class="at">-</span> INFO <span class="at">-</span> Round 16 of 20.</span>
<span id="cb81-1854"><a href="#cb81-1854" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:48,649 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.66 seconds <span class="er">(</span><span class="ex">137.84</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1855"><a href="#cb81-1855" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:48,649 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1856"><a href="#cb81-1856" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1857"><a href="#cb81-1857" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1858"><a href="#cb81-1858" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1859"><a href="#cb81-1859" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1860"><a href="#cb81-1860" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1861"><a href="#cb81-1861" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1862"><a href="#cb81-1862" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1863"><a href="#cb81-1863" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1864"><a href="#cb81-1864" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:48,649 <span class="at">-</span> INFO <span class="at">-</span> Round 17 of 20.</span>
<span id="cb81-1865"><a href="#cb81-1865" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:49,295 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.12</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1866"><a href="#cb81-1866" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:49,295 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1867"><a href="#cb81-1867" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1868"><a href="#cb81-1868" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1869"><a href="#cb81-1869" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1870"><a href="#cb81-1870" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1871"><a href="#cb81-1871" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1872"><a href="#cb81-1872" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1873"><a href="#cb81-1873" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1874"><a href="#cb81-1874" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1875"><a href="#cb81-1875" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:49,295 <span class="at">-</span> INFO <span class="at">-</span> Round 18 of 20.</span>
<span id="cb81-1876"><a href="#cb81-1876" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:49,939 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.44</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1877"><a href="#cb81-1877" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:49,939 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1878"><a href="#cb81-1878" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1879"><a href="#cb81-1879" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1880"><a href="#cb81-1880" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1881"><a href="#cb81-1881" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1882"><a href="#cb81-1882" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1883"><a href="#cb81-1883" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1884"><a href="#cb81-1884" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1885"><a href="#cb81-1885" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1886"><a href="#cb81-1886" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:49,939 <span class="at">-</span> INFO <span class="at">-</span> Round 19 of 20.</span>
<span id="cb81-1887"><a href="#cb81-1887" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:50,582 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.64 seconds <span class="er">(</span><span class="ex">141.49</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1888"><a href="#cb81-1888" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:50,583 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1889"><a href="#cb81-1889" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1890"><a href="#cb81-1890" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1891"><a href="#cb81-1891" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1892"><a href="#cb81-1892" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1893"><a href="#cb81-1893" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1894"><a href="#cb81-1894" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1895"><a href="#cb81-1895" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1896"><a href="#cb81-1896" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1897"><a href="#cb81-1897" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:50,583 <span class="at">-</span> INFO <span class="at">-</span> Round 20 of 20.</span>
<span id="cb81-1898"><a href="#cb81-1898" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:51,232 <span class="at">-</span> INFO <span class="at">-</span> Generated 91 tokens in 0.65 seconds <span class="er">(</span><span class="ex">140.31</span> tokens/sec<span class="kw">)</span></span>
<span id="cb81-1899"><a href="#cb81-1899" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:51,232 <span class="at">-</span> INFO <span class="at">-</span> Output:</span>
<span id="cb81-1900"><a href="#cb81-1900" aria-hidden="true" tabindex="-1"></a><span class="ex">Einstein</span><span class="st">'s Theory of Relativity states that the speed of</span></span>
<span id="cb81-1901"><a href="#cb81-1901" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is simply the speed of the electrons in</span></span>
<span id="cb81-1902"><a href="#cb81-1902" aria-hidden="true" tabindex="-1"></a><span class="st">that vacuum, since light has a speed. Since the speed of</span></span>
<span id="cb81-1903"><a href="#cb81-1903" aria-hidden="true" tabindex="-1"></a><span class="st">light in a vacuum is equal to the speed of the electrons in</span></span>
<span id="cb81-1904"><a href="#cb81-1904" aria-hidden="true" tabindex="-1"></a><span class="st">a solid, the light from this source has a speed of</span></span>
<span id="cb81-1905"><a href="#cb81-1905" aria-hidden="true" tabindex="-1"></a><span class="st">approximately 1/299,792 m/s. Einstein'</span><span class="ex">s</span> theory of relativity</span>
<span id="cb81-1906"><a href="#cb81-1906" aria-hidden="true" tabindex="-1"></a><span class="ex">explains</span> this speed by a phenomenon known as the speed at</span>
<span id="cb81-1907"><a href="#cb81-1907" aria-hidden="true" tabindex="-1"></a><span class="ex">the</span> end of time. In other words, this speed is</span>
<span id="cb81-1908"><a href="#cb81-1908" aria-hidden="true" tabindex="-1"></a><span class="ex">2025-02-10</span> 20:49:51,232 <span class="at">-</span> INFO <span class="at">-</span> Run details saved to gpt2-rates-2025-02-10-20-49-51-232526-torch-compile-max-autotune-fullgraph-py313t.json.</span>
<span id="cb81-1909"><a href="#cb81-1909" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1910"><a href="#cb81-1910" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1911"><a href="#cb81-1911" aria-hidden="true" tabindex="-1"></a><span class="ex">torch.__init__:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1912"><a href="#cb81-1912" aria-hidden="true" tabindex="-1"></a><span class="ex">torch._dynamo.eval_frame:</span> Ignoring unsupported torch.compile<span class="er">(</span><span class="kw">)</span> <span class="ex">with</span> no GIL unsupported</span>
<span id="cb81-1913"><a href="#cb81-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-1914"><a href="#cb81-1914" aria-hidden="true" tabindex="-1"></a><span class="ex">real</span>    0m20.061s</span>
<span id="cb81-1915"><a href="#cb81-1915" aria-hidden="true" tabindex="-1"></a><span class="ex">user</span>    0m23.272s</span>
<span id="cb81-1916"><a href="#cb81-1916" aria-hidden="true" tabindex="-1"></a><span class="ex">sys</span> 0m1.387s</span>
<span id="cb81-1917"><a href="#cb81-1917" aria-hidden="true" tabindex="-1"></a><span class="ex">Exception</span> ignored in: <span class="op">&lt;</span>_io.BufferedWriter name=41<span class="op">&gt;</span></span>
<span id="cb81-1918"><a href="#cb81-1918" aria-hidden="true" tabindex="-1"></a><span class="ex">BrokenPipeError:</span> [Errno 32] Broken pipe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>After each run, a JSON file is saved capturing details about the run. These can all be found in this <a href="https://github.com/tpn/website/tree/main/articles/pytorch-and-python-free-threading/json"><code>json</code></a> directory.</p>
<p>Using <a href="https://github.com/tpn/website/blob/main/articles/pytorch-and-python-free-threading/json/gpt2-rates-2025-02-09-18-19-29-116321-py313t.json"><code>gpt2-rates-2025-02-09-18-19-29-116321-py313t.json</code></a> as an example:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"rates"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>        <span class="fl">103.45683188097036</span><span class="ot">,</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>        <span class="fl">133.69021647689885</span><span class="ot">,</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.64711111769682</span><span class="ot">,</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.99572668445947</span><span class="ot">,</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>        <span class="fl">135.07252279473053</span><span class="ot">,</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.93995013027606</span><span class="ot">,</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.8097791019913</span><span class="ot">,</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.97874539755563</span><span class="ot">,</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.96994164914173</span><span class="ot">,</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.2781961646748</span><span class="ot">,</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>        <span class="fl">133.36089184927351</span><span class="ot">,</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.91936892711604</span><span class="ot">,</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.99927221213662</span><span class="ot">,</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.99574871578727</span><span class="ot">,</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.84820822748674</span><span class="ot">,</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.90753647890656</span><span class="ot">,</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.84542991060954</span><span class="ot">,</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.76236728440452</span><span class="ot">,</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.939303436755</span><span class="ot">,</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>        <span class="fl">134.95605543169106</span></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"model_config"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"block_size"</span><span class="fu">:</span> <span class="dv">1024</span><span class="fu">,</span></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"vocab_size"</span><span class="fu">:</span> <span class="dv">50304</span><span class="fu">,</span></span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"n_layer"</span><span class="fu">:</span> <span class="dv">12</span><span class="fu">,</span></span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"n_head"</span><span class="fu">:</span> <span class="dv">12</span><span class="fu">,</span></span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"n_embd"</span><span class="fu">:</span> <span class="dv">768</span></span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">},</span></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"args"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"log_level"</span><span class="fu">:</span> <span class="st">"INFO"</span><span class="fu">,</span></span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"model"</span><span class="fu">:</span> <span class="st">"gpt2"</span><span class="fu">,</span></span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"device"</span><span class="fu">:</span> <span class="st">"cuda:3"</span><span class="fu">,</span></span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"max_length"</span><span class="fu">:</span> <span class="dv">100</span><span class="fu">,</span></span>
<span id="cb82-36"><a href="#cb82-36" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"top_k"</span><span class="fu">:</span> <span class="dv">50</span><span class="fu">,</span></span>
<span id="cb82-37"><a href="#cb82-37" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"seed"</span><span class="fu">:</span> <span class="dv">42</span><span class="fu">,</span></span>
<span id="cb82-38"><a href="#cb82-38" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"prompt"</span><span class="fu">:</span> <span class="st">"Einstein's Theory of Relativity states that"</span><span class="fu">,</span></span>
<span id="cb82-39"><a href="#cb82-39" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"torch_compile"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb82-40"><a href="#cb82-40" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"torch_jit"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb82-41"><a href="#cb82-41" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"torch_compile_fullgraph"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb82-42"><a href="#cb82-42" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"torch_compile_reduce_overhead"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb82-43"><a href="#cb82-43" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"torch_compile_max_autotune"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb82-44"><a href="#cb82-44" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"generate_slim"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb82-45"><a href="#cb82-45" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"rounds"</span><span class="fu">:</span> <span class="dv">20</span><span class="fu">,</span></span>
<span id="cb82-46"><a href="#cb82-46" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"wrap"</span><span class="fu">:</span> <span class="dv">60</span><span class="fu">,</span></span>
<span id="cb82-47"><a href="#cb82-47" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"note"</span><span class="fu">:</span> <span class="st">""</span></span>
<span id="cb82-48"><a href="#cb82-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">},</span></span>
<span id="cb82-49"><a href="#cb82-49" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"start_timestamp"</span><span class="fu">:</span> <span class="st">"2025-02-09T18:19:14.156224"</span><span class="fu">,</span></span>
<span id="cb82-50"><a href="#cb82-50" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"end_timestamp"</span><span class="fu">:</span> <span class="st">"2025-02-09T18:19:29.116383"</span><span class="fu">,</span></span>
<span id="cb82-51"><a href="#cb82-51" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"elapsed"</span><span class="fu">:</span> <span class="st">"14.960"</span><span class="fu">,</span></span>
<span id="cb82-52"><a href="#cb82-52" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"device_name"</span><span class="fu">:</span> <span class="st">"Tesla V100-DGXS-32GB"</span><span class="fu">,</span></span>
<span id="cb82-53"><a href="#cb82-53" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"conda_env_name"</span><span class="fu">:</span> <span class="st">"py313t"</span><span class="fu">,</span></span>
<span id="cb82-54"><a href="#cb82-54" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"is_gil_enabled"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb82-55"><a href="#cb82-55" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"note"</span><span class="fu">:</span> <span class="st">""</span></span>
<span id="cb82-56"><a href="#cb82-56" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>All tests were done for 20 rounds, and the <code>rates</code> key contains an array of floats, representing the tokens/sec generation rate achieved by the call to <code>generate()</code> (or <code>generate_slim()</code>, which we’ll discuss shortly) after optionally compiling the model with the requested parameters.</p>
</section>
<section id="free-threaded-python-py313t" class="level4">
<h4 class="anchored" data-anchor-id="free-threaded-python-py313t">Free-Threaded Python (py313t)</h4>
<p>I ended up doing multiple runs because… well, as you’re about to see from the data visualization below… it was a pretty noisy test. Loads of variance and generally everything was all over the shop. The total run times for each different permutation were all about the same, around 14 seconds or so, but definitely no clear winner regarding whether or not <code>torch.compile()</code> or any particular permutation was having a repeatable speedup. Interesting.</p>
<p>Line plots and box-plots follow. The box plots omitted the first <em>“warmup”</em> run (which was always slower and skewed the data unnecessarily). If you click on the image you should get a nice <em>gallery</em> presentation mode that allows you to flip between images nicely.</p>
<div class="theme-light">
<p><a href="py313t-run1-combined-side-by-side-light.svg" class="lightbox" data-gallery="gal1" title="Generation Performance - Run 1 (py313t)"><img src="py313t-run1-combined-side-by-side-light.svg" class="img-fluid" alt="Generation Performance - Run 1 (py313t)"></a> <a href="py313t-run2-combined-side-by-side-light.svg" class="lightbox" data-gallery="gal1" title="Generation Performance - Run 2 (py313t)"><img src="py313t-run2-combined-side-by-side-light.svg" class="img-fluid" alt="Generation Performance - Run 2 (py313t)"></a> <a href="py313t-run3-combined-side-by-side-light.svg" class="lightbox" data-gallery="gal1" title="Generation Performance - Run 3 (py313t)"><img src="py313t-run3-combined-side-by-side-light.svg" class="img-fluid" alt="Generation Performance - Run 3 (py313t)"></a> <a href="py313t-run4-combined-side-by-side-light.svg" class="lightbox" data-gallery="gal1" title="Generation Performance - Run 4 (py313t)"><img src="py313t-run4-combined-side-by-side-light.svg" class="img-fluid" alt="Generation Performance - Run 4 (py313t)"></a></p>
</div>
<div class="theme-dark">
<p><a href="py313t-run1-combined-side-by-side-dark.svg" class="lightbox" data-gallery="gal2" title="Generation Performance - Run 1 (py313t)"><img src="py313t-run1-combined-side-by-side-dark.svg" class="img-fluid" alt="Generation Performance - Run 1 (py313t)"></a> <a href="py313t-run2-combined-side-by-side-dark.svg" class="lightbox" data-gallery="gal2" title="Generation Performance - Run 2 (py313t)"><img src="py313t-run2-combined-side-by-side-dark.svg" class="img-fluid" alt="Generation Performance - Run 2 (py313t)"></a> <a href="py313t-run3-combined-side-by-side-dark.svg" class="lightbox" data-gallery="gal2" title="Generation Performance - Run 3 (py313t)"><img src="py313t-run3-combined-side-by-side-dark.svg" class="img-fluid" alt="Generation Performance - Run 3 (py313t)"></a> <a href="py313t-run4-combined-side-by-side-dark.svg" class="lightbox" data-gallery="gal2" title="Generation Performance - Run 4 (py313t)"><img src="py313t-run4-combined-side-by-side-dark.svg" class="img-fluid" alt="Generation Performance - Run 4 (py313t)"></a></p>
</div>
</section>
<section id="normal-python-py313" class="level4">
<h4 class="anchored" data-anchor-id="normal-python-py313">Normal Python (py313)</h4>
<p>Normal Python (not just free-threaded Python with the GIL enabled, but full-blown old-school normal Python with no knowledge of GIL removal—i.e. our <code>py313</code> environment) was pretty similar:</p>
<div class="theme-light">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="py313-run1-combined-side-by-side-light.svg" class="lightbox" data-gallery="gal3" title="Generation Performance (py313)"><img src="py313-run1-combined-side-by-side-light.svg" class="img-fluid figure-img" alt="Generation Performance (py313)"></a></p>
<figcaption>Generation Performance (py313)</figcaption>
</figure>
</div>
</div>
<div class="theme-dark">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="py313-run1-combined-side-by-side-dark.svg" class="lightbox" data-gallery="gal4" title="Generation Performance (py313)"><img src="py313-run1-combined-side-by-side-dark.svg" class="img-fluid figure-img" alt="Generation Performance (py313)"></a></p>
<figcaption>Generation Performance (py313)</figcaption>
</figure>
</div>
</div>
</section>
<section id="explicit-torch.compile-decorator" class="level4">
<h4 class="anchored" data-anchor-id="explicit-torch.compile-decorator">Explicit <span class="citation" data-cites="torch.compile">@torch.compile</span> Decorator</h4>
<p>Here’s where it gets interesting. In a final, last-ditch effort to see if I could see <em>any</em> sort of speedup from <code>torch.compile()</code>, I introduced a slimmer <code>generate()</code> routine, aptly named <code>generate_slim()</code>, which was stripped of any superfluous code that would have otherwise impeded Torch Dynamo’s ability to optimize the graph. That function looked like this:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GPT:</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># @torch.compile</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_slim(</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>, text_tokens: torch.Tensor, max_length: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1024</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>        top_k: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>, seed: <span class="bu">int</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co">        Generate text from the model.  This version differs from</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co">        `generate()` in that it does not use any Python code that</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co">        causes a torch graph break.</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="co">            text (str): Supplies the prompt.</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="co">            max_length (int): Supplies the maximum total length,</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="co">                including prompt.</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a><span class="co">            top_k (int): Supplies the number of tokens to consider</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a><span class="co">                at each generation step.</span></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a><span class="co">            seed (int): Ignored!</span></span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a><span class="co">            str: The generated text (including the initial prompt).</span></span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Initialize alias.</span></span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a>        device <span class="op">=</span> <span class="va">self</span>.device</span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a>        stop_token <span class="op">=</span> <span class="va">self</span>.stop_token</span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create the tensor for capturing predicted tokens.</span></span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.tensor(</span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a>            text_tokens,</span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a>            dtype<span class="op">=</span>torch.<span class="bu">long</span>,</span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a>            device<span class="op">=</span>device</span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a>        ).unsqueeze(<span class="dv">0</span>)</span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create a random generator for reproducibility.</span></span>
<span id="cb83-42"><a href="#cb83-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample_rng = torch.Generator(device=device)</span></span>
<span id="cb83-43"><a href="#cb83-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if seed is None:</span></span>
<span id="cb83-44"><a href="#cb83-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     seed = self.manual_seed</span></span>
<span id="cb83-45"><a href="#cb83-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample_rng.manual_seed(seed)</span></span>
<span id="cb83-46"><a href="#cb83-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-47"><a href="#cb83-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate tokens up to our max length.</span></span>
<span id="cb83-48"><a href="#cb83-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_length):</span>
<span id="cb83-49"><a href="#cb83-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> torch.no_grad():</span>
<span id="cb83-50"><a href="#cb83-50" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Forward pass, ignoring the returned loss.</span></span>
<span id="cb83-51"><a href="#cb83-51" aria-hidden="true" tabindex="-1"></a>                (logits, _) <span class="op">=</span> <span class="va">self</span>(x)</span>
<span id="cb83-52"><a href="#cb83-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-53"><a href="#cb83-53" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Take the logits at the last time-step (shape:</span></span>
<span id="cb83-54"><a href="#cb83-54" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (1, vocab_size)).</span></span>
<span id="cb83-55"><a href="#cb83-55" aria-hidden="true" tabindex="-1"></a>            logits <span class="op">=</span> logits[:, <span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb83-56"><a href="#cb83-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-57"><a href="#cb83-57" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Convert to probabilities.</span></span>
<span id="cb83-58"><a href="#cb83-58" aria-hidden="true" tabindex="-1"></a>            probs <span class="op">=</span> F.softmax(logits, dim<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb83-59"><a href="#cb83-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-60"><a href="#cb83-60" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Top-k sampling.</span></span>
<span id="cb83-61"><a href="#cb83-61" aria-hidden="true" tabindex="-1"></a>            topk_probs, topk_indices <span class="op">=</span> torch.topk(</span>
<span id="cb83-62"><a href="#cb83-62" aria-hidden="true" tabindex="-1"></a>                probs, k<span class="op">=</span>top_k, dim<span class="op">=-</span><span class="dv">1</span>,</span>
<span id="cb83-63"><a href="#cb83-63" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb83-64"><a href="#cb83-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-65"><a href="#cb83-65" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Sample the next token.</span></span>
<span id="cb83-66"><a href="#cb83-66" aria-hidden="true" tabindex="-1"></a>            next_idx <span class="op">=</span> torch.multinomial(</span>
<span id="cb83-67"><a href="#cb83-67" aria-hidden="true" tabindex="-1"></a>                topk_probs,</span>
<span id="cb83-68"><a href="#cb83-68" aria-hidden="true" tabindex="-1"></a>                num_samples<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb83-69"><a href="#cb83-69" aria-hidden="true" tabindex="-1"></a>                <span class="co"># generator=sample_rng,</span></span>
<span id="cb83-70"><a href="#cb83-70" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb83-71"><a href="#cb83-71" aria-hidden="true" tabindex="-1"></a>            next_token <span class="op">=</span> torch.gather(topk_indices, <span class="op">-</span><span class="dv">1</span>, next_idx)</span>
<span id="cb83-72"><a href="#cb83-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-73"><a href="#cb83-73" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If the next token is the stop token, we're done.</span></span>
<span id="cb83-74"><a href="#cb83-74" aria-hidden="true" tabindex="-1"></a>            <span class="co"># next_token_item = next_token.item()</span></span>
<span id="cb83-75"><a href="#cb83-75" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if next_token_item == stop_token:</span></span>
<span id="cb83-76"><a href="#cb83-76" aria-hidden="true" tabindex="-1"></a>            <span class="co">#    break</span></span>
<span id="cb83-77"><a href="#cb83-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-78"><a href="#cb83-78" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Append token to current sequence.</span></span>
<span id="cb83-79"><a href="#cb83-79" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> torch.cat((x, next_token), dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb83-80"><a href="#cb83-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-81"><a href="#cb83-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that we had to make a number of sizable modifications. No more random number generator—that was causing graph breaks. No more explicitly checking for the stop token, again, that makes the dynamic optimizer’s job much harder at runtime without extra tracing overhead for tracking scalars. So we now generate tokens up to the maximum specified, ignorant of any stop tokens, and return that.</p>
<p>I wanted to do two runs here, one where we call everything as normal with all the different <code>torch.compile()</code> invocations we’d used in prior runs, and then a second one where I explicitly mark the <code>generate_slim()</code> routine with a <code>@torch.compile</code> decorator.</p>
<p>The latter absolutely does not work in free-threaded Python, it segfaults after about ten seconds or so, thus, I couldn’t test it.</p>
<p>However, on the normal Python version… we finally saw some interesting results.</p>
<p>First, let’s look at our baseline: normal <code>generate_slim()</code> with no <code>@torch.compile</code> generator (the bash scripts verify that the decorator is uncommented and commented as necessary):</p>
<div class="theme-light">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="py313-run2-generate_slim-combined-side-by-side-light.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Generation Performance - generate_slim() - No @torch.compile Decorator (py313)"><img src="py313-run2-generate_slim-combined-side-by-side-light.svg" class="img-fluid figure-img" alt="Generation Performance - generate_slim() - No @torch.compile Decorator (py313)"></a></p>
<figcaption>Generation Performance - generate_slim() - No <span class="citation" data-cites="torch.compile">@torch.compile</span> Decorator (py313)</figcaption>
</figure>
</div>
</div>
<div class="theme-dark">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="py313-run2-generate_slim-combined-side-by-side-dark.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="Generation Performance - generate_slim() - No @torch.compile Decorator (py313)"><img src="py313-run2-generate_slim-combined-side-by-side-dark.svg" class="img-fluid figure-img" alt="Generation Performance - generate_slim() - No @torch.compile Decorator (py313)"></a></p>
<figcaption>Generation Performance - generate_slim() - No <span class="citation" data-cites="torch.compile">@torch.compile</span> Decorator (py313)</figcaption>
</figure>
</div>
</div>
<p>Well we finally see one configuration break out from the pack: apparently <code>torch.compile(model, {'fullgraph': True})</code> yielded the best generation rate we’ve seen yet, hovering around 160 tokens/sec. Note that all the total run times are still pretty similar, hovering around that 14-15s mark.</p>
<p>Now, let’s uncomment the <code>@torch.compile</code> decorator above <code>def generate_slim()</code> and do another full run:</p>
<div class="theme-light">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="py313-run3-generate_slim-torch-compiled-combined-side-by-side-light.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-33" title="Generation Performance - generate_slim() - With @torch.compile Decorator (py313)"><img src="py313-run3-generate_slim-torch-compiled-combined-side-by-side-light.svg" class="img-fluid figure-img" alt="Generation Performance - generate_slim() - With @torch.compile Decorator (py313)"></a></p>
<figcaption>Generation Performance - generate_slim() - With <span class="citation" data-cites="torch.compile">@torch.compile</span> Decorator (py313)</figcaption>
</figure>
</div>
</div>
<div class="theme-dark">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="py313-run3-generate_slim-torch-compiled-combined-side-by-side-dark.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Generation Performance - generate_slim() - With @torch.compile Decorator (py313)"><img src="py313-run3-generate_slim-torch-compiled-combined-side-by-side-dark.svg" class="img-fluid figure-img" alt="Generation Performance - generate_slim() - With @torch.compile Decorator (py313)"></a></p>
<figcaption>Generation Performance - generate_slim() - With <span class="citation" data-cites="torch.compile">@torch.compile</span> Decorator (py313)</figcaption>
</figure>
</div>
</div>
<p>Oh man. That first compilation took <em>forever</em>. But once compiled, our tokens/sec generation rate shoots up significantly to the 250+ range instead of the 150+ range! But at a crazy up-front cost—as you can see with all of the run times (the values in parenthesis in the labels and x-axis in first and second plots, respectively) were in excess of four minutes.</p>
<p>As we’re only doing twenty runs of generating ~90-100 characters, that startup cost is brutal, however, if we were doing model training or launching a long-running inference service like our HTTP server, the startup cost would be quickly amortized away as we benefit from about a 75% speedup.</p>
<p>So, interesting stuff, kind of. To be fair… PyTorch clearly indicates free-threaded Python isn’t supported, per our hacks earlier, so, this should be an interesting area of development in future releases, especially now that we can see how much benefit there is to doing multi-threaded run-time inference in a single Python process.</p>
</section>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>In this article, we’ve explored the world of free-threaded Python and PyTorch, and demonstrated that you can now do parallel inference on PyTorch models, and that it all plays very nicely together when wrapped up with an <code>asyncio</code>-based HTTP server.</p>
<p>Hopefully this encourages more folks to experiment with free-threaded Python, or perhaps port their existing Python packages to play nicely when installed in a free-threaded Python environment. I personally can’t wait until free-threaded Python is the default! Although that’s probably at least five or so years out at this point.</p>
<!-- vim:set ts=8 sw=2 sts=2 expandtab textwidth=78 -->


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>I used 0.23.3, as that was the latest version available at the time, however, 0.23.4 has since been released, so you could try that too.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>And I’m sure I used the existing Python stdlib <code>http.server</code> code at the time as the basis; ain’t nobody got time to be writing new web servers from scratch.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Unfortunately, it doesn’t appear to work on Windows as-is; using the exact same code, only one thread can be seen running when the server is loaded. It’s not doing a round-robin between <em>all</em> threads, like you’d expect to see with the GIL enabled, there’s just a single sole thread attempting to service all incoming requests, with all other threads sitting idle. I don’t know if it’s because of something quirky with regards to additional, non-main-thread threads not getting their own event loop (hopefully easy to fix), or something more insidious related to how we’re misuing I/O completion ports behind the scenes in <code>IocpProactor()</code> now that we have free-threading (much harder to fix). I haven’t had time to investigate in more detail.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/trent\.me");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/tpn/website/edit/main/articles/pytorch-and-python-free-threading/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/tpn/website/issues/new/choose" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>